<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Forme des équipes</title>

<link   type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"                      rel="stylesheet">
<link   type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css"                    rel="stylesheet">
<link   type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/tooltipster/3.3.0/css/tooltipster.min.css"                 rel="stylesheet">
<link   type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/tooltipster/3.3.0/css/themes/tooltipster-light.min.css"    rel="stylesheet">
        
<style type="text/css">
body {
    margin: 2rem;
    font-family: monospace; 
    font-size: 18px;
}
section {
    display: flex;
    flex-wrap: wrap;
    max-width: 640px;
}
section > div.row {
    width: 100%;
    height: 100%;
    margin: 0 1rem;
    align-items: center;
}
section > div.row > div.col {
    display: flex;
    justify-content: space-between;
}
section > div.row span:first-child {
    // background-color: #efefef;
    width: 100%;
}
section > div.row span:last-child {
    font-size: 12px;
    white-space:nowrap;
    height: 100%;
}
section > div.row span:last-child i {
    margin: .2rem .3rem;
    padding: .3rem .2rem;
}
section > div.row span i:nth-child(3) {
    border-right: 1px solid gray;
    padding-right: 1rem;
}
.green {
    color:green;
}
.gray {
    color:gray;
}
.red {
    color:red;
}
.white {
    color:white;
}

.dotted-line {
  white-space: nowrap;
  overflow: hidden;
  // direction: rtl;
}
.dotted-line:after {
  content: ".....................................................";
  letter-spacing: 6px;
  font-size: 20px;
  color: gray;
  // display: inline-block;
  // vertical-align: 3px;
  padding-left: 10px;
}
.tooltip_templates { 
    // display: none; 
}
#tooltip_content {
    position: absolute;
    top: 10px;
    right: 10px;
    padding: 12px 20px 14px;
    text-align: left;
    white-space: nowrap;
    z-index: 2;
    background: #fff;
    box-shadow: 0px 0px 10px 0px rgba(0,0,0,0.4);
}
#tooltip_content .intro {
    display: block;
    line-height: 17px;
    font-size: 14px;
    font-weight: bold;
    color: #7c8699;
}
#tooltip_content .winner {
    font-weight: bold;
}
#tooltip_content .content {
    overflow: hidden;
    display: block;
    margin: 2px 0 0;
    padding: 9px 0 0;
    border-top: solid 1px #d4dae6;
}
#tooltip_content .score-block {
    display: inline-block;
    margin: 0 4px;
    vertical-align: top;
}
#tooltip_content .score {
    display: inline-block;
    min-width: 26px;
    padding: 4px 0 3px;
    line-height: 19px;
    font-size: 16px;
    font-weight: bold;
    text-align: center;
    vertical-align: top;
    color: #7c8699;
    background: #e9eef5;
    border-radius: 2px;
}
#tooltip_content .team-logo {
    width: 20px;
    height: auto;
}
img.img-fluid {
    max-width: 28px;
    max-height:28px;
    margin-right: .5rem;
}
</style>
</head>
<body class="container-fluid">

<section>
<div class="row"><div class="col" id="SantAgataFutsal2004"><span class="dotted-line">Sant Agata Futsal 2004</span><span></span></div></div>
<div class="row"><div class="col" id="OsteriaGrandeC5"><span class="dotted-line">Osteria Grande C5</span><span></span></div></div>
<div class="row"><div class="col" id="RealCasalgrandese"><span class="dotted-line">Real Casalgrandese</span><span></span></div></div>
<div class="row"><div class="col" id="Cavezzo"><span class="dotted-line">Cavezzo</span><span></span></div></div>
<div class="row"><div class="col" id="AssClubC5"><span class="dotted-line">Ass. Club C5</span><span></span></div></div>
<div class="row"><div class="col" id="RiminiC5"><span class="dotted-line">Rimini C5</span><span></span></div></div>
<div class="row"><div class="col" id="FutsalReggioEmilia"><span class="dotted-line">Futsal Reggio Emilia</span><span></span></div></div>
<div class="row"><div class="col" id="GianLucaMontanari"><span class="dotted-line">Gian Luca Montanari</span><span></span></div></div>
<div class="row"><div class="col" id="FutsalPonteRodoni"><span class="dotted-line">Futsal Ponte Rodoni</span><span></span></div></div>
<div class="row"><div class="col" id="Fossolo76Calcio"><span class="dotted-line">Fossolo 76 Calcio</span><span></span></div></div>
<div class="row"><div class="col" id="ProPatriaSFelice"><span class="dotted-line">Pro Patria S. Felice</span><span></span></div></div>
<div class="row"><div class="col" id="Aposa"><span class="dotted-line">Aposa</span><span></span></div></div>
</section>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.4/lodash.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js"></script>
<script type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/tooltipster/3.3.0/js/jquery.tooltipster.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.6/handlebars.min.js"></script>

<script id="entry-template" type="text/x-handlebars-template">
  <span id="tooltip_content">
    <span class="intro">{{title}}</span>
    {{#with match}}
    <span class="content">
      {{#with home}}
      <span class="team-name {{clazz}}">{{team}}</span>
      <img class="team-logo" src="images/{{logo}}.png" alt="{{team}}">
      <span class="score-block">
        <span class="score ">{{goals}}</span>
      {{/with}}
      {{#with visiting}}
        <span class="score winner">{{goals}}</span>
      </span>
      <img class="team-logo" src="images/{{logo}}.png" alt="{{team}}">
      <span class="team-name {{clazz}}">{{team}}</span>
      {{/with}}
    </span>
    {{/with}}
  </span>
</script>

<script type="text/javascript">

var days = [{
  title: "9° giornata (26 novembre 2016)", 
  matches: [
    {homeTeam: { id:"AssClubC5", goals:6}, visitingTeam: { id:"ProPatriaSFelice", goals:4},},
    {homeTeam: { id:"Cavezzo", goals:1}, visitingTeam: { id:"RiminiC5", goals:0},},
    {homeTeam: { id:"FutsalPonteRodoni", goals:6}, visitingTeam: { id:"OsteriaGrandeC5", goals:3},},
    {homeTeam: { id:"FutsalReggioEmilia", goals:7}, visitingTeam: { id:"Fossolo76Calcio", goals:3},},
    {homeTeam: { id:"GianLucaMontanari", goals:3}, visitingTeam: { id:"RealCasalgrandese", goals:3},},
    {homeTeam: { id:"SantAgataFutsal2004", goals:8}, visitingTeam: { id:"Aposa", goals:4},},
  ],
}, {
  title: "10° giornata (03 dicembre 2016)",
  matches: [
    {homeTeam: { id:"Fossolo76Calcio", goals:5}, visitingTeam: { id:"Aposa", goals:1},},
    {homeTeam: { id:"FutsalPonteRodoni", goals:2}, visitingTeam: { id:"Cavezzo", goals:1},},
    {homeTeam: { id:"OsteriaGrandeC5", goals:3}, visitingTeam: { id:"AssClubC5", goals:0},},
    {homeTeam: { id:"ProPatriaSFelice", goals:3}, visitingTeam: { id:"GianLucaMontanari", goals:2},},
    {homeTeam: { id:"RealCasalgrandese", goals:2}, visitingTeam: { id:"FutsalReggioEmilia", goals:1},},
    {homeTeam: { id:"RiminiC5", goals:2}, visitingTeam: { id:"SantAgataFutsal2004", goals:7},},
  ],
}, {
  title: "11° giornata (10 dicembre 2016)",
  matches: [
    {homeTeam: { id:"Aposa", goals:4}, visitingTeam: { id:"ProPatriaSFelice", goals:2},},
    {homeTeam: { id:"AssClubC5", goals:1}, visitingTeam: { id:"RiminiC5", goals:1},},
    {homeTeam: { id:"Cavezzo", goals:6}, visitingTeam: { id:"RealCasalgrandese", goals:4},},
    {homeTeam: { id:"FutsalReggioEmilia", goals:0}, visitingTeam: { id:"OsteriaGrandeC5", goals:0},},
    {homeTeam: { id:"GianLucaMontanari", goals:0}, visitingTeam: { id:"FutsalPonteRodoni", goals:4},},
    {homeTeam: { id:"SantAgataFutsal2004", goals:7}, visitingTeam: { id:"Fossolo76Calcio", goals:4},},
  ],
}, {
  title: "12° giornata (14 gennaio 2017)",
  matches: [
    {homeTeam: { id:"Aposa", goals:1}, visitingTeam: { id:"OsteriaGrandeC5", goals:2},},
    {homeTeam: { id:"AssClubC5", goals:6}, visitingTeam: { id:"FutsalPonteRodoni", goals:1},},
    {homeTeam: { id:"FutsalReggioEmilia", goals:3}, visitingTeam: { id:"Cavezzo", goals:3},},
    {homeTeam: { id:"GianLucaMontanari", goals:1}, visitingTeam: { id:"Fossolo76Calcio", goals:1},},
    {homeTeam: { id:"ProPatriaSFelice", goals:7}, visitingTeam: { id:"RiminiC5", goals:2},},
    {homeTeam: { id:"SantAgataFutsal2004", goals:6}, visitingTeam: { id:"RealCasalgrandese", goals:5},},
  ],
}, {
  title: "13° giornata (21 gennaio 2017)",
  matches: [
    {homeTeam: { id:"Cavezzo", goals:7}, visitingTeam: { id:"GianLucaMontanari", goals:4},},
    {homeTeam: { id:"Fossolo76Calcio", goals:3}, visitingTeam: { id:"ProPatriaSFelice", goals:2},},
    {homeTeam: { id:"FutsalPonteRodoni", goals:0}, visitingTeam: { id:"FutsalReggioEmilia", goals:3},},
    {homeTeam: { id:"OsteriaGrandeC5", goals:4}, visitingTeam: { id:"SantAgataFutsal2004", goals:1},},
    {homeTeam: { id:"RealCasalgrandese", goals:5}, visitingTeam: { id:"AssClubC5", goals:3},},
    {homeTeam: { id:"RiminiC5", goals:7}, visitingTeam: { id:"Aposa", goals:2},},
  ],
}, {
  title: "14° giornata (28 gennaio 2017)",
  matches: [
    {homeTeam: { id:"Aposa", goals:"3"}, visitingTeam: { id:"RealCasalgrandese", goals:"5"},},
    {homeTeam: { id:"AssClubC5", goals:2}, visitingTeam: { id:"Cavezzo", goals:3},},
    {homeTeam: { id:"Fossolo76Calcio", goals:"_"}, visitingTeam: { id:"RiminiC5", goals:"_"},},
    {homeTeam: { id:"FutsalReggioEmilia", goals:3}, visitingTeam: { id:"GianLucaMontanari", goals:3},},
    {homeTeam: { id:"ProPatriaSFelice", goals:5}, visitingTeam: { id:"OsteriaGrandeC5", goals:4},},
    {homeTeam: { id:"SantAgataFutsal2004", goals:6}, visitingTeam: { id:"FutsalPonteRodoni", goals:4},},
  ],
}];
var full_table = {
SantAgataFutsal2004 : [3,3,3,3,0],
OsteriaGrandeC5     : [0,3,1,3,3],
RealCasalgrandese   : [1,3,0,0,3],
Cavezzo             : [3,0,3,1,3],
AssClubC5           : [3,0,1,3,0],
RiminiC5            : [0,0,1,0,3],
FutsalReggioEmilia  : [3,0,1,1,3],
GianLucaMontanari   : [1,0,0,1,0],
FutsalPonteRodoni   : [3,3,3,0,0],
Fossolo76Calcio     : [0,3,0,1,3],
ProPatriaSFelice    : [0,3,0,3,0],
Aposa               : [0,0,3,0,0],
};
var IDs = {
SantAgataFutsal2004 : "1025311",
OsteriaGrandeC5     : "1012511",
RealCasalgrandese   : "1012446",
AssClubC5           : "1012444",
Cavezzo             : "1025227",
RiminiC5            : "1012437",
FutsalReggioEmilia  : "1025223",
GianLucaMontanari   : "1025721",
FutsalPonteRodoni   : "1012441",
Fossolo76Calcio     : "1012512",
ProPatriaSFelice    : "1012455",
Aposa               : "1012435",
};
var NAMEs = {
SantAgataFutsal2004: "Sant Agata Futsal 2004",
OsteriaGrandeC5    : "Osteria Grande C5",
RealCasalgrandese  : "Real Casalgrandese",
AssClubC5          : "Ass. Club C5",
Cavezzo            : "Cavezzo",
RiminiC5           : "Rimini C5",
FutsalReggioEmilia : "Futsal Reggio Emilia",
GianLucaMontanari  : "Gian Luca Montanari",
FutsalPonteRodoni  : "Futsal Ponte Rodoni",
Fossolo76Calcio    : "Fossolo 76 Calcio",
ProPatriaSFelice   : "Pro Patria S. Felice",
Aposa              : "Aposa",
};

jQuery(document).ready(function($) {

    // handlebars template
    var source   = $("#entry-template").html();
    var template = Handlebars.compile(source);

    // insert logos
    _.forOwn(IDs, function(value, key) { 
        var where = $("body > section > div.row > div.col#"+key);
        where.prepend($('<img>').prop('src', "images/"+value+".png").addClass("img-fluid img-thumbnail"));
    });

    // from matches to full_table
    _.forEach(days, function(day, y) {
      _.forEach(day.matches, function(match, x) {
        full_table[match.homeTeam.id][y] = match;
        full_table[match.visitingTeam.id][y] = match;
      });
    });

    // insert green 1 / gray x / red 2
    var x = 0;
    _.forOwn(full_table, function(value, key) { 
        var $where = $("body > section > div.row > div.col#"+key+" > span:last-child");
        $where.data('x', x++);
        var y = 0;
        _.forEach(value, function(val) {
            var color;
            if (typeof val === 'object') {
                var _1x2;
                if (val.homeTeam.goals == "_" || val.visitingTeam.goals == "_") {
                    _1x2 = "_";
                } else {
                    if (val.homeTeam.goals > val.visitingTeam.goals) {
                        _1x2 = "1";
                    } else if (val.homeTeam.goals == val.visitingTeam.goals) {
                        _1x2 = "x";
                    } else {
                        _1x2 = "2";
                    }
                }
                if (val.homeTeam.id == key) {
                    color = (_1x2=="1" ? "green" : (_1x2=="x" ? "gray" : (_1x2=="2" ? "red" : "white")));
                } else {
                    color = (_1x2=="2" ? "green" : (_1x2=="x" ? "gray" : (_1x2=="1" ? "red" : "white")));
                }
            } else {
                color = (val==3 ? "green" : (val==1 ? "gray" : "red"));
            }
            var $i = '<i class="fa fa-circle '+ color +'" aria-hidden="true" data-y="'+(y++)+'"></i>';
            $where.append($i);
        });
    });

    // setup popovers
    $("body > section > div.row > div > span:last-child > i").each(function (index, value) {
        var $value = $(value);
        var y = $value.parent().data('x');
        var team = $value.parent().parent().prop('id');
        var x = $value.data('y');

        var match = full_table[team][x];
        if (typeof match === 'object') {
          var massaged = {
                home : {
                    team: NAMEs[match.homeTeam.id],
                    logo: IDs[match.homeTeam.id],
                    goals: match.homeTeam.goals,
                    clazz : (match.homeTeam.goals > match.visitingTeam.goals ? "winner" : "") 
                },
                visiting : {
                    team: NAMEs[match.visitingTeam.id],
                    logo: IDs[match.visitingTeam.id],
                    goals: match.visitingTeam.goals,
                    clazz : (match.visitingTeam.goals > match.homeTeam.goals ? "winner" : "") 
                },
          };

          $value.tooltipster({
              content: template({
                title: days[x % days.length].title,
                match: massaged,
              }),
              contentAsHTML: true,
              contentCloning: true,
              theme: 'tooltipster-light',
              delay: 0,
          });
        }
    });

  });

</script>
</body>
</html>
