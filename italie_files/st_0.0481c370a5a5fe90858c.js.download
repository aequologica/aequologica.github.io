_seedtagJsonp([0],Array(84).concat([function(e,t){var n=function(){function e(e){return null==e?String(e):Z[Y.call(e)]||"object"}function t(t){return"function"==e(t)}function n(e){return null!=e&&e==e.window}function r(e){return null!=e&&e.nodeType==e.DOCUMENT_NODE}function i(t){return"object"==e(t)}function o(e){return i(e)&&!n(e)&&Object.getPrototypeOf(e)==Object.prototype}function a(e){var t=!!e&&"length"in e&&e.length,r=O.type(e);return"function"!=r&&!n(e)&&("array"==r||0===t||"number"==typeof t&&t>0&&t-1 in e)}function u(e){return S.call(e,function(e){return null!=e})}function s(e){return e.length>0?O.fn.concat.apply([],e):e}function c(e){return e.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function l(e){return e in N?N[e]:N[e]=new RegExp("(^|\\s)"+e+"(\\s|$)")}function f(e,t){return"number"!=typeof t||D[c(e)]?t:t+"px"}function p(e){var t,n;return M[e]||(t=C.createElement(e),C.body.appendChild(t),n=getComputedStyle(t,"").getPropertyValue("display"),t.parentNode.removeChild(t),"none"==n&&(n="block"),M[e]=n),M[e]}function d(e){return"children"in e?R.call(e.children):O.map(e.childNodes,function(e){if(1==e.nodeType)return e})}function h(e,t){var n,r=e?e.length:0;for(n=0;n<r;n++)this[n]=e[n];this.length=r,this.selector=t||""}function y(e,t,n){for(k in t)n&&(o(t[k])||K(t[k]))?(o(t[k])&&!o(e[k])&&(e[k]={}),K(t[k])&&!K(e[k])&&(e[k]=[]),y(e[k],t[k],n)):t[k]!==w&&(e[k]=t[k])}function v(e,t){return null==t?O(e):O(e).filter(t)}function g(e,n,r,i){return t(n)?n.call(e,r,i):n}function b(e,t,n){null==n?e.removeAttribute(t):e.setAttribute(t,n)}function m(e,t){var n=e.className||"",r=n&&n.baseVal!==w;if(t===w)return r?n.baseVal:n;r?n.baseVal=t:e.className=t}function _(e){try{return e?"true"==e||"false"!=e&&("null"==e?null:+e+""==e?+e:/^[\[\{]/.test(e)?O.parseJSON(e):e):e}catch(t){return e}}function A(e,t){t(e);for(var n=0,r=e.childNodes.length;n<r;n++)A(e.childNodes[n],t)}var w,k,O,j,T,x,E=[],P=E.concat,S=E.filter,R=E.slice,C=window.document,M={},N={},D={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},F=/^\s*<(\w+|!)[^>]*>/,U=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,V=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,I=/^(?:body|html)$/i,B=/([A-Z])/g,L=["val","css","html","text","data","width","height","offset"],z=["after","prepend","before","append"],q=C.createElement("table"),G=C.createElement("tr"),W={tr:C.createElement("tbody"),tbody:q,thead:q,tfoot:q,td:G,th:G,"*":C.createElement("div")},X=/complete|loaded|interactive/,H=/^[\w-]*$/,Z={},Y=Z.toString,Q={},$=C.createElement("div"),J={tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},K=Array.isArray||function(e){return e instanceof Array};return Q.matches=function(e,t){if(!t||!e||1!==e.nodeType)return!1;var n=e.matches||e.webkitMatchesSelector||e.mozMatchesSelector||e.oMatchesSelector||e.matchesSelector;if(n)return n.call(e,t);var r,i=e.parentNode,o=!i;return o&&(i=$).appendChild(e),r=~Q.qsa(i,t).indexOf(e),o&&$.removeChild(e),r},T=function(e){return e.replace(/-+(.)?/g,function(e,t){return t?t.toUpperCase():""})},x=function(e){return S.call(e,function(t,n){return e.indexOf(t)==n})},Q.fragment=function(e,t,n){var r,i,a;return U.test(e)&&(r=O(C.createElement(RegExp.$1))),r||(e.replace&&(e=e.replace(V,"<$1></$2>")),t===w&&(t=F.test(e)&&RegExp.$1),t in W||(t="*"),a=W[t],a.innerHTML=""+e,r=O.each(R.call(a.childNodes),function(){a.removeChild(this)})),o(n)&&(i=O(r),O.each(n,function(e,t){L.indexOf(e)>-1?i[e](t):i.attr(e,t)})),r},Q.Z=function(e,t){return new h(e,t)},Q.isZ=function(e){return e instanceof Q.Z},Q.init=function(e,n){var r;if(!e)return Q.Z();if("string"==typeof e)if(e=e.trim(),"<"==e[0]&&F.test(e))r=Q.fragment(e,RegExp.$1,n),e=null;else{if(n!==w)return O(n).find(e);r=Q.qsa(C,e)}else{if(t(e))return O(C).ready(e);if(Q.isZ(e))return e;if(K(e))r=u(e);else if(i(e))r=[e],e=null;else if(F.test(e))r=Q.fragment(e.trim(),RegExp.$1,n),e=null;else{if(n!==w)return O(n).find(e);r=Q.qsa(C,e)}}return Q.Z(r,e)},O=function(e,t){return Q.init(e,t)},O.extend=function(e){var t,n=R.call(arguments,1);return"boolean"==typeof e&&(t=e,e=n.shift()),n.forEach(function(n){y(e,n,t)}),e},Q.qsa=function(e,t){var n,r="#"==t[0],i=!r&&"."==t[0],o=r||i?t.slice(1):t,a=H.test(o);return e.getElementById&&a&&r?(n=e.getElementById(o))?[n]:[]:1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType?[]:R.call(a&&!r&&e.getElementsByClassName?i?e.getElementsByClassName(o):e.getElementsByTagName(t):e.querySelectorAll(t))},O.contains=C.documentElement.contains?function(e,t){return e!==t&&e.contains(t)}:function(e,t){for(;t&&(t=t.parentNode);)if(t===e)return!0;return!1},O.type=e,O.isFunction=t,O.isWindow=n,O.isArray=K,O.isPlainObject=o,O.isEmptyObject=function(e){var t;for(t in e)return!1;return!0},O.isNumeric=function(e){var t=Number(e),n=typeof e;return null!=e&&"boolean"!=n&&("string"!=n||e.length)&&!isNaN(t)&&isFinite(t)||!1},O.inArray=function(e,t,n){return E.indexOf.call(t,e,n)},O.camelCase=T,O.trim=function(e){return null==e?"":String.prototype.trim.call(e)},O.uuid=0,O.support={},O.expr={},O.noop=function(){},O.map=function(e,t){var n,r,i,o=[];if(a(e))for(r=0;r<e.length;r++)null!=(n=t(e[r],r))&&o.push(n);else for(i in e)null!=(n=t(e[i],i))&&o.push(n);return s(o)},O.each=function(e,t){var n,r;if(a(e)){for(n=0;n<e.length;n++)if(!1===t.call(e[n],n,e[n]))return e}else for(r in e)if(!1===t.call(e[r],r,e[r]))return e;return e},O.grep=function(e,t){return S.call(e,t)},window.JSON&&(O.parseJSON=JSON.parse),O.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){Z["[object "+t+"]"]=t.toLowerCase()}),O.fn={constructor:Q.Z,length:0,forEach:E.forEach,reduce:E.reduce,push:E.push,sort:E.sort,splice:E.splice,indexOf:E.indexOf,concat:function(){var e,t,n=[];for(e=0;e<arguments.length;e++)t=arguments[e],n[e]=Q.isZ(t)?t.toArray():t;return P.apply(Q.isZ(this)?this.toArray():this,n)},map:function(e){return O(O.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return O(R.apply(this,arguments))},ready:function(e){return X.test(C.readyState)&&C.body?e(O):C.addEventListener("DOMContentLoaded",function(){e(O)},!1),this},get:function(e){return e===w?R.call(this):this[e>=0?e:e+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(e){return E.every.call(this,function(t,n){return!1!==e.call(t,n,t)}),this},filter:function(e){return t(e)?this.not(this.not(e)):O(S.call(this,function(t){return Q.matches(t,e)}))},add:function(e,t){return O(x(this.concat(O(e,t))))},is:function(e){return this.length>0&&Q.matches(this[0],e)},not:function(e){var n=[];if(t(e)&&e.call!==w)this.each(function(t){e.call(this,t)||n.push(this)});else{var r="string"==typeof e?this.filter(e):a(e)&&t(e.item)?R.call(e):O(e);this.forEach(function(e){r.indexOf(e)<0&&n.push(e)})}return O(n)},has:function(e){return this.filter(function(){return i(e)?O.contains(this,e):O(this).find(e).size()})},eq:function(e){return-1===e?this.slice(e):this.slice(e,+e+1)},first:function(){var e=this[0];return e&&!i(e)?e:O(e)},last:function(){var e=this[this.length-1];return e&&!i(e)?e:O(e)},find:function(e){var t=this;return e?"object"==typeof e?O(e).filter(function(){var e=this;return E.some.call(t,function(t){return O.contains(t,e)})}):1==this.length?O(Q.qsa(this[0],e)):this.map(function(){return Q.qsa(this,e)}):O()},closest:function(e,t){var n=[],i="object"==typeof e&&O(e);return this.each(function(o,a){for(;a&&!(i?i.indexOf(a)>=0:Q.matches(a,e));)a=a!==t&&!r(a)&&a.parentNode;a&&n.indexOf(a)<0&&n.push(a)}),O(n)},parents:function(e){for(var t=[],n=this;n.length>0;)n=O.map(n,function(e){if((e=e.parentNode)&&!r(e)&&t.indexOf(e)<0)return t.push(e),e});return v(t,e)},parent:function(e){return v(x(this.pluck("parentNode")),e)},children:function(e){return v(this.map(function(){return d(this)}),e)},contents:function(){return this.map(function(){return this.contentDocument||R.call(this.childNodes)})},siblings:function(e){return v(this.map(function(e,t){return S.call(d(t.parentNode),function(e){return e!==t})}),e)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(e){return O.map(this,function(t){return t[e]})},show:function(){return this.each(function(){"none"==this.style.display&&(this.style.display=""),"none"==getComputedStyle(this,"").getPropertyValue("display")&&(this.style.display=p(this.nodeName))})},replaceWith:function(e){return this.before(e).remove()},wrap:function(e){var n=t(e);if(this[0]&&!n)var r=O(e).get(0),i=r.parentNode||this.length>1;return this.each(function(t){O(this).wrapAll(n?e.call(this,t):i?r.cloneNode(!0):r)})},wrapAll:function(e){if(this[0]){O(this[0]).before(e=O(e));for(var t;(t=e.children()).length;)e=t.first();O(e).append(this)}return this},wrapInner:function(e){var n=t(e);return this.each(function(t){var r=O(this),i=r.contents(),o=n?e.call(this,t):e;i.length?i.wrapAll(o):r.append(o)})},unwrap:function(){return this.parent().each(function(){O(this).replaceWith(O(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(e){return this.each(function(){var t=O(this);(e===w?"none"==t.css("display"):e)?t.show():t.hide()})},prev:function(e){return O(this.pluck("previousElementSibling")).filter(e||"*")},next:function(e){return O(this.pluck("nextElementSibling")).filter(e||"*")},html:function(e){return 0 in arguments?this.each(function(t){var n=this.innerHTML;O(this).empty().append(g(this,e,t,n))}):0 in this?this[0].innerHTML:null},text:function(e){return 0 in arguments?this.each(function(t){var n=g(this,e,t,this.textContent);this.textContent=null==n?"":""+n}):0 in this?this.pluck("textContent").join(""):null},attr:function(e,t){var n;return"string"!=typeof e||1 in arguments?this.each(function(n){if(1===this.nodeType)if(i(e))for(k in e)b(this,k,e[k]);else b(this,e,g(this,t,n,this.getAttribute(e)))}):0 in this&&1==this[0].nodeType&&null!=(n=this[0].getAttribute(e))?n:w},removeAttr:function(e){return this.each(function(){1===this.nodeType&&e.split(" ").forEach(function(e){b(this,e)},this)})},prop:function(e,t){return e=J[e]||e,1 in arguments?this.each(function(n){this[e]=g(this,t,n,this[e])}):this[0]&&this[0][e]},removeProp:function(e){return e=J[e]||e,this.each(function(){delete this[e]})},data:function(e,t){var n="data-"+e.replace(B,"-$1").toLowerCase(),r=1 in arguments?this.attr(n,t):this.attr(n);return null!==r?_(r):w},val:function(e){return 0 in arguments?(null==e&&(e=""),this.each(function(t){this.value=g(this,e,t,this.value)})):this[0]&&(this[0].multiple?O(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):this[0].value)},offset:function(e){if(e)return this.each(function(t){var n=O(this),r=g(this,e,t,n.offset()),i=n.offsetParent().offset(),o={top:r.top-i.top,left:r.left-i.left};"static"==n.css("position")&&(o.position="relative"),n.css(o)});if(!this.length)return null;if(C.documentElement!==this[0]&&!O.contains(C.documentElement,this[0]))return{top:0,left:0};var t=this[0].getBoundingClientRect();return{left:t.left+window.pageXOffset,top:t.top+window.pageYOffset,width:Math.round(t.width),height:Math.round(t.height)}},css:function(t,n){if(arguments.length<2){var r=this[0];if("string"==typeof t){if(!r)return;return r.style[T(t)]||getComputedStyle(r,"").getPropertyValue(t)}if(K(t)){if(!r)return;var i={},o=getComputedStyle(r,"");return O.each(t,function(e,t){i[t]=r.style[T(t)]||o.getPropertyValue(t)}),i}}var a="";if("string"==e(t))n||0===n?a=c(t)+":"+f(t,n):this.each(function(){this.style.removeProperty(c(t))});else for(k in t)t[k]||0===t[k]?a+=c(k)+":"+f(k,t[k])+";":this.each(function(){this.style.removeProperty(c(k))});return this.each(function(){this.style.cssText+=";"+a})},index:function(e){return e?this.indexOf(O(e)[0]):this.parent().children().indexOf(this[0])},hasClass:function(e){return!!e&&E.some.call(this,function(e){return this.test(m(e))},l(e))},addClass:function(e){return e?this.each(function(t){if("className"in this){j=[];var n=m(this);g(this,e,t,n).split(/\s+/g).forEach(function(e){O(this).hasClass(e)||j.push(e)},this),j.length&&m(this,n+(n?" ":"")+j.join(" "))}}):this},removeClass:function(e){return this.each(function(t){if("className"in this){if(e===w)return m(this,"");j=m(this),g(this,e,t,j).split(/\s+/g).forEach(function(e){j=j.replace(l(e)," ")}),m(this,j.trim())}})},toggleClass:function(e,t){return e?this.each(function(n){var r=O(this);g(this,e,n,m(this)).split(/\s+/g).forEach(function(e){(t===w?!r.hasClass(e):t)?r.addClass(e):r.removeClass(e)})}):this},scrollTop:function(e){if(this.length){var t="scrollTop"in this[0];return e===w?t?this[0].scrollTop:this[0].pageYOffset:this.each(t?function(){this.scrollTop=e}:function(){this.scrollTo(this.scrollX,e)})}},scrollLeft:function(e){if(this.length){var t="scrollLeft"in this[0];return e===w?t?this[0].scrollLeft:this[0].pageXOffset:this.each(t?function(){this.scrollLeft=e}:function(){this.scrollTo(e,this.scrollY)})}},position:function(){if(this.length){var e=this[0],t=this.offsetParent(),n=this.offset(),r=I.test(t[0].nodeName)?{top:0,left:0}:t.offset();return n.top-=parseFloat(O(e).css("margin-top"))||0,n.left-=parseFloat(O(e).css("margin-left"))||0,r.top+=parseFloat(O(t[0]).css("border-top-width"))||0,r.left+=parseFloat(O(t[0]).css("border-left-width"))||0,{top:n.top-r.top,left:n.left-r.left}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||C.body;e&&!I.test(e.nodeName)&&"static"==O(e).css("position");)e=e.offsetParent;return e})}},O.fn.detach=O.fn.remove,["width","height"].forEach(function(e){var t=e.replace(/./,function(e){return e[0].toUpperCase()});O.fn[e]=function(i){var o,a=this[0];return i===w?n(a)?a["inner"+t]:r(a)?a.documentElement["scroll"+t]:(o=this.offset())&&o[e]:this.each(function(t){a=O(this),a.css(e,g(this,i,t,a[e]()))})}}),z.forEach(function(t,n){var r=n%2;O.fn[t]=function(){var t,i,o=O.map(arguments,function(n){var r=[];return t=e(n),"array"==t?(n.forEach(function(e){return e.nodeType!==w?r.push(e):O.zepto.isZ(e)?r=r.concat(e.get()):void(r=r.concat(Q.fragment(e)))}),r):"object"==t||null==n?n:Q.fragment(n)}),a=this.length>1;return o.length<1?this:this.each(function(e,t){i=r?t:t.parentNode,t=0==n?t.nextSibling:1==n?t.firstChild:2==n?t:null;var u=O.contains(C.documentElement,i);o.forEach(function(e){if(a)e=e.cloneNode(!0);else if(!i)return O(e).remove();i.insertBefore(e,t),u&&A(e,function(e){if(!(null==e.nodeName||"SCRIPT"!==e.nodeName.toUpperCase()||e.type&&"text/javascript"!==e.type||e.src)){var t=e.ownerDocument?e.ownerDocument.defaultView:window;t.eval.call(t,e.innerHTML)}})})})},O.fn[r?t+"To":"insert"+(n?"Before":"After")]=function(e){return O(e)[t](this),this}}),Q.Z.prototype=h.prototype=O.fn,Q.uniq=x,Q.deserializeValue=_,O.zepto=Q,O}();e.exports=n},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){var r=n(84);n(124),n(125),n(126),n(127),e.exports=r},function(e,t,n){var r=n(84);!function(e){function t(e){return e._zid||(e._zid=p++)}function n(e,n,o,a){if(n=r(n),n.ns)var u=i(n.ns);return(v[t(e)]||[]).filter(function(e){return e&&(!n.e||e.e==n.e)&&(!n.ns||u.test(e.ns))&&(!o||t(e.fn)===t(o))&&(!a||e.sel==a)})}function r(e){var t=(""+e).split(".");return{e:t[0],ns:t.slice(1).sort().join(" ")}}function i(e){return new RegExp("(?:^| )"+e.replace(" "," .* ?")+"(?: |$)")}function o(e,t){return e.del&&!b&&e.e in m||!!t}function a(e){return _[e]||b&&m[e]||e}function u(n,i,u,s,l,p,d){var h=t(n),y=v[h]||(v[h]=[]);i.split(/\s/).forEach(function(t){if("ready"==t)return e(document).ready(u);var i=r(t);i.fn=u,i.sel=l,i.e in _&&(u=function(t){var n=t.relatedTarget;if(!n||n!==this&&!e.contains(this,n))return i.fn.apply(this,arguments)}),i.del=p;var h=p||u;i.proxy=function(e){if(e=c(e),!e.isImmediatePropagationStopped()){e.data=s;var t=h.apply(n,e._args==f?[e]:[e].concat(e._args));return!1===t&&(e.preventDefault(),e.stopPropagation()),t}},i.i=y.length,y.push(i),"addEventListener"in n&&n.addEventListener(a(i.e),i.proxy,o(i,d))})}function s(e,r,i,u,s){var c=t(e);(r||"").split(/\s/).forEach(function(t){n(e,t,i,u).forEach(function(t){delete v[c][t.i],"removeEventListener"in e&&e.removeEventListener(a(t.e),t.proxy,o(t,s))})})}function c(t,n){if(n||!t.isDefaultPrevented){n||(n=t),e.each(O,function(e,r){var i=n[e];t[e]=function(){return this[r]=A,i&&i.apply(n,arguments)},t[r]=w});try{t.timeStamp||(t.timeStamp=Date.now())}catch(e){}(n.defaultPrevented!==f?n.defaultPrevented:"returnValue"in n?!1===n.returnValue:n.getPreventDefault&&n.getPreventDefault())&&(t.isDefaultPrevented=A)}return t}function l(e){var t,n={originalEvent:e};for(t in e)k.test(t)||e[t]===f||(n[t]=e[t]);return c(n,e)}var f,p=1,d=Array.prototype.slice,h=e.isFunction,y=function(e){return"string"==typeof e},v={},g={},b="onfocusin"in window,m={focus:"focusin",blur:"focusout"},_={mouseenter:"mouseover",mouseleave:"mouseout"};g.click=g.mousedown=g.mouseup=g.mousemove="MouseEvents",e.event={add:u,remove:s},e.proxy=function(n,r){var i=2 in arguments&&d.call(arguments,2);if(h(n)){var o=function(){return n.apply(r,i?i.concat(d.call(arguments)):arguments)};return o._zid=t(n),o}if(y(r))return i?(i.unshift(n[r],n),e.proxy.apply(null,i)):e.proxy(n[r],n);throw new TypeError("expected function")},e.fn.bind=function(e,t,n){return this.on(e,t,n)},e.fn.unbind=function(e,t){return this.off(e,t)},e.fn.one=function(e,t,n,r){return this.on(e,t,n,r,1)};var A=function(){return!0},w=function(){return!1},k=/^([A-Z]|returnValue$|layer[XY]$|webkitMovement[XY]$)/,O={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};e.fn.delegate=function(e,t,n){return this.on(t,e,n)},e.fn.undelegate=function(e,t,n){return this.off(t,e,n)},e.fn.live=function(t,n){return e(document.body).delegate(this.selector,t,n),this},e.fn.die=function(t,n){return e(document.body).undelegate(this.selector,t,n),this},e.fn.on=function(t,n,r,i,o){var a,c,p=this;return t&&!y(t)?(e.each(t,function(e,t){p.on(e,n,r,t,o)}),p):(y(n)||h(i)||!1===i||(i=r,r=n,n=f),i!==f&&!1!==r||(i=r,r=f),!1===i&&(i=w),p.each(function(f,p){o&&(a=function(e){return s(p,e.type,i),i.apply(this,arguments)}),n&&(c=function(t){var r,o=e(t.target).closest(n,p).get(0);if(o&&o!==p)return r=e.extend(l(t),{currentTarget:o,liveFired:p}),(a||i).apply(o,[r].concat(d.call(arguments,1)))}),u(p,t,i,r,n,c||a)}))},e.fn.off=function(t,n,r){var i=this;return t&&!y(t)?(e.each(t,function(e,t){i.off(e,n,t)}),i):(y(n)||h(r)||!1===r||(r=n,n=f),!1===r&&(r=w),i.each(function(){s(this,t,r,n)}))},e.fn.trigger=function(t,n){return t=y(t)||e.isPlainObject(t)?e.Event(t):c(t),t._args=n,this.each(function(){t.type in m&&"function"==typeof this[t.type]?this[t.type]():"dispatchEvent"in this?this.dispatchEvent(t):e(this).triggerHandler(t,n)})},e.fn.triggerHandler=function(t,r){var i,o;return this.each(function(a,u){i=l(y(t)?e.Event(t):t),i._args=r,i.target=u,e.each(n(u,t.type||t),function(e,t){if(o=t.proxy(i),i.isImmediatePropagationStopped())return!1})}),o},"focusin focusout focus blur load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(t){e.fn[t]=function(e){return 0 in arguments?this.bind(t,e):this.trigger(t)}}),e.Event=function(e,t){y(e)||(t=e,e=t.type);var n=document.createEvent(g[e]||"Events"),r=!0;if(t)for(var i in t)"bubbles"==i?r=!!t[i]:n[i]=t[i];return n.initEvent(e,r,!0),c(n)}}(r)},function(e,t,n){var r=n(84);!function(e){function t(t,n,r){var i=e.Event(n);return e(t).trigger(i,r),!i.isDefaultPrevented()}function n(e,n,r,i){if(e.global)return t(n||m,r,i)}function r(t){t.global&&0==e.active++&&n(t,null,"ajaxStart")}function i(t){t.global&&!--e.active&&n(t,null,"ajaxStop")}function o(e,t){var r=t.context;if(!1===t.beforeSend.call(r,e,t)||!1===n(t,r,"ajaxBeforeSend",[e,t]))return!1;n(t,r,"ajaxSend",[e,t])}function a(e,t,r,i){var o=r.context;r.success.call(o,e,"success",t),i&&i.resolveWith(o,[e,"success",t]),n(r,o,"ajaxSuccess",[t,r,e]),s("success",t,r)}function u(e,t,r,i,o){var a=i.context;i.error.call(a,r,t,e),o&&o.rejectWith(a,[r,t,e]),n(i,a,"ajaxError",[r,i,e||t]),s(t,r,i)}function s(e,t,r){var o=r.context;r.complete.call(o,t,e),n(r,o,"ajaxComplete",[t,r]),i(r)}function c(e,t,n){if(n.dataFilter==l)return e;var r=n.context;return n.dataFilter.call(r,e,t)}function l(){}function f(e){return e&&(e=e.split(";",2)[0]),e&&(e==O?"html":e==k?"json":A.test(e)?"script":w.test(e)&&"xml")||"text"}function p(e,t){return""==t?e:(e+"&"+t).replace(/[&?]{1,2}/,"?")}function d(t){t.processData&&t.data&&"string"!=e.type(t.data)&&(t.data=e.param(t.data,t.traditional)),!t.data||t.type&&"GET"!=t.type.toUpperCase()&&"jsonp"!=t.dataType||(t.url=p(t.url,t.data),t.data=void 0)}function h(t,n,r,i){return e.isFunction(n)&&(i=r,r=n,n=void 0),e.isFunction(r)||(i=r,r=void 0),{url:t,data:n,success:r,dataType:i}}function y(t,n,r,i){var o,a=e.isArray(n),u=e.isPlainObject(n);e.each(n,function(n,s){o=e.type(s),i&&(n=r?i:i+"["+(u||"object"==o||"array"==o?n:"")+"]"),!i&&a?t.add(s.name,s.value):"array"==o||!r&&"object"==o?y(t,s,r,n):t.add(n,s)})}var v,g,b=+new Date,m=window.document,_=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,A=/^(?:text|application)\/javascript/i,w=/^(?:text|application)\/xml/i,k="application/json",O="text/html",j=/^\s*$/,T=m.createElement("a");T.href=window.location.href,e.active=0,e.ajaxJSONP=function(t,n){if(!("type"in t))return e.ajax(t);var r,i,s=t.jsonpCallback,c=(e.isFunction(s)?s():s)||"Zepto"+b++,l=m.createElement("script"),f=window[c],p=function(t){e(l).triggerHandler("error",t||"abort")},d={abort:p};return n&&n.promise(d),e(l).on("load error",function(o,s){clearTimeout(i),e(l).off().remove(),"error"!=o.type&&r?a(r[0],d,t,n):u(null,s||"error",d,t,n),window[c]=f,r&&e.isFunction(f)&&f(r[0]),f=r=void 0}),!1===o(d,t)?(p("abort"),d):(window[c]=function(){r=arguments},l.src=t.url.replace(/\?(.+)=\?/,"?$1="+c),m.head.appendChild(l),t.timeout>0&&(i=setTimeout(function(){p("timeout")},t.timeout)),d)},e.ajaxSettings={type:"GET",beforeSend:l,success:l,error:l,complete:l,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:k,xml:"application/xml, text/xml",html:O,text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0,dataFilter:l},e.ajax=function(t){var n,i,s=e.extend({},t||{}),h=e.Deferred&&e.Deferred();for(v in e.ajaxSettings)void 0===s[v]&&(s[v]=e.ajaxSettings[v]);r(s),s.crossDomain||(n=m.createElement("a"),n.href=s.url,n.href=n.href,s.crossDomain=T.protocol+"//"+T.host!=n.protocol+"//"+n.host),s.url||(s.url=window.location.toString()),(i=s.url.indexOf("#"))>-1&&(s.url=s.url.slice(0,i)),d(s);var y=s.dataType,b=/\?.+=\?/.test(s.url);if(b&&(y="jsonp"),!1!==s.cache&&(t&&!0===t.cache||"script"!=y&&"jsonp"!=y)||(s.url=p(s.url,"_="+Date.now())),"jsonp"==y)return b||(s.url=p(s.url,s.jsonp?s.jsonp+"=?":!1===s.jsonp?"":"callback=?")),e.ajaxJSONP(s,h);var _,A=s.accepts[y],w={},k=function(e,t){w[e.toLowerCase()]=[e,t]},O=/^([\w-]+:)\/\//.test(s.url)?RegExp.$1:window.location.protocol,x=s.xhr(),E=x.setRequestHeader;if(h&&h.promise(x),s.crossDomain||k("X-Requested-With","XMLHttpRequest"),k("Accept",A||"*/*"),(A=s.mimeType||A)&&(A.indexOf(",")>-1&&(A=A.split(",",2)[0]),x.overrideMimeType&&x.overrideMimeType(A)),(s.contentType||!1!==s.contentType&&s.data&&"GET"!=s.type.toUpperCase())&&k("Content-Type",s.contentType||"application/x-www-form-urlencoded"),s.headers)for(g in s.headers)k(g,s.headers[g]);if(x.setRequestHeader=k,x.onreadystatechange=function(){if(4==x.readyState){x.onreadystatechange=l,clearTimeout(_);var t,n=!1;if(x.status>=200&&x.status<300||304==x.status||0==x.status&&"file:"==O){if(y=y||f(s.mimeType||x.getResponseHeader("content-type")),"arraybuffer"==x.responseType||"blob"==x.responseType)t=x.response;else{t=x.responseText;try{t=c(t,y,s),"script"==y?(0,eval)(t):"xml"==y?t=x.responseXML:"json"==y&&(t=j.test(t)?null:e.parseJSON(t))}catch(e){n=e}if(n)return u(n,"parsererror",x,s,h)}a(t,x,s,h)}else u(x.statusText||null,x.status?"error":"abort",x,s,h)}},!1===o(x,s))return x.abort(),u(null,"abort",x,s,h),x;var P=!("async"in s)||s.async;if(x.open(s.type,s.url,P,s.username,s.password),s.xhrFields)for(g in s.xhrFields)x[g]=s.xhrFields[g];for(g in w)E.apply(x,w[g]);return s.timeout>0&&(_=setTimeout(function(){x.onreadystatechange=l,x.abort(),u(null,"timeout",x,s,h)},s.timeout)),x.send(s.data?s.data:null),x},e.get=function(){return e.ajax(h.apply(null,arguments))},e.post=function(){var t=h.apply(null,arguments);return t.type="POST",e.ajax(t)},e.getJSON=function(){var t=h.apply(null,arguments);return t.dataType="json",e.ajax(t)},e.fn.load=function(t,n,r){if(!this.length)return this;var i,o=this,a=t.split(/\s/),u=h(t,n,r),s=u.success;return a.length>1&&(u.url=a[0],i=a[1]),u.success=function(t){o.html(i?e("<div>").html(t.replace(_,"")).find(i):t),s&&s.apply(o,arguments)},e.ajax(u),this};var x=encodeURIComponent;e.param=function(t,n){var r=[];return r.add=function(t,n){e.isFunction(n)&&(n=n()),null==n&&(n=""),this.push(x(t)+"="+x(n))},y(r,t,n),r.join("&").replace(/%20/g,"+")}}(r)},function(e,t,n){var r=n(84);!function(e){e.fn.serializeArray=function(){var t,n,r=[],i=function(e){if(e.forEach)return e.forEach(i);r.push({name:t,value:e})};return this[0]&&e.each(this[0].elements,function(r,o){n=o.type,(t=o.name)&&"fieldset"!=o.nodeName.toLowerCase()&&!o.disabled&&"submit"!=n&&"reset"!=n&&"button"!=n&&"file"!=n&&("radio"!=n&&"checkbox"!=n||o.checked)&&i(e(o).val())}),r},e.fn.serialize=function(){var e=[];return this.serializeArray().forEach(function(t){e.push(encodeURIComponent(t.name)+"="+encodeURIComponent(t.value))}),e.join("&")},e.fn.submit=function(t){if(0 in arguments)this.bind("submit",t);else if(this.length){var n=e.Event("submit");this.eq(0).trigger(n),n.isDefaultPrevented()||this.get(0).submit()}return this}}(r)},function(e,t){!function(){try{getComputedStyle(void 0)}catch(t){var e=getComputedStyle;window.getComputedStyle=function(t,n){try{return e(t,n)}catch(e){return null}}}}()},,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";(function(e){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Engine=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(116),a=n(27),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(a),s=n(355),c=n(363),l=n(366),f=n(367),p=n(368),d=n(369),h=n(370),y=n(371),v=n(372),g=n(374),b=n(375),m=n(379),_=n(381),A=n(384),w=n(226),k=n(385),O=n(387),j=n(388),T=n(389),x=n(390),E=n(391),P=n(392),S=n(393),R=n(129),C=n(394),M=n(395),N=n(396),D=n(397),F=n(443),U=n(444),V=n(563);n(227),t.Engine=function(){function t(n){var i=this;r(this,t),this.context=new o.Context(n),this.pieces=[],this.runAdServer(),this.promise=new e(function(e){i.setup(),e()})}return i(t,[{key:"setup",value:function(){this.addComponents([s.CoverageReport,l.AdReport,f.BidderReport,h.VideoReport,d.ContentReport,c.ViewabilityReport,y.TimesReport,p.InventoryReport,b.EvaluableService,k.ConfigGetter,O.PassbackService,v.QuantcastService,g.PiwikService,U.Admin,A.Sherlock,w.PublisherFeatureService,m.TemplateLocator,_.AdUnitLocator,V.AutoplayService]),"__seedtag__watson__"===navigator.userAgent&&this.addComponents([F.InspectService])}},{key:"getReadyPromise",value:function(){return this.promise}},{key:"run",value:function(){this.context.config.triggerOnLoad(),this.context.publish({channel:"engine",topic:"run",data:{}})}},{key:"runAdServer",value:function(){this.context.config.AdserverAdapters.push(D.ApnAdapter),this.context.config.AdserverAdapters.push(D.NetworksAdapter),this.addComponents([D.AdServer,j.TargetingResolver,T.CreativeBridgeTargeting,x.TemplateTargetingService,E.AdunitTargetingService,P.PublisherTargetingService,S.TaggingTargetingService,R.FormatsTargetingService,C.ContextualizationService,M.BrandSafeService,N.CustomCategoriesService])}},{key:"addComponent",value:function(e){this.pieces.push(new e(this.context))}},{key:"addComponents",value:function(e){u.forEach(e,this.addComponent.bind(this))}}]),t}()}).call(t,n(83))},,,,,,function(e,t){function n(e,t){var n=e[1]||"",i=e[3];if(!i)return n;if(t&&"function"==typeof btoa){var o=r(i);return[n].concat(i.sources.map(function(e){return"/*# sourceURL="+i.sourceRoot+e+" */"})).concat([o]).join("\n")}return[n].join("\n")}function r(e){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(e))))+" */"}e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var r=n(t,e);return t[2]?"@media "+t[2]+"{"+r+"}":r}).join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var r={},i=0;i<this.length;i++){var o=this[i][0];"number"==typeof o&&(r[o]=!0)}for(i=0;i<e.length;i++){var a=e[i];"number"==typeof a[0]&&r[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),t.push(a))}},t}},function(e,t){function n(e,t){for(var n=0;n<e.length;n++){var r=e[n],i=p[r.id];if(i){i.refs++;for(var o=0;o<i.parts.length;o++)i.parts[o](r.parts[o]);for(;o<r.parts.length;o++)i.parts.push(s(r.parts[o],t))}else{for(var a=[],o=0;o<r.parts.length;o++)a.push(s(r.parts[o],t));p[r.id]={id:r.id,refs:1,parts:a}}}}function r(e){for(var t=[],n={},r=0;r<e.length;r++){var i=e[r],o=i[0],a=i[1],u=i[2],s=i[3],c={css:a,media:u,sourceMap:s};n[o]?n[o].parts.push(c):t.push(n[o]={id:o,parts:[c]})}return t}function i(e,t){var n=y(),r=b[b.length-1];if("top"===e.insertAt)r?r.nextSibling?n.insertBefore(t,r.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),b.push(t);else{if("bottom"!==e.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(t)}}function o(e){e.parentNode.removeChild(e);var t=b.indexOf(e);t>=0&&b.splice(t,1)}function a(e){var t=document.createElement("style");return t.type="text/css",i(e,t),t}function u(e){var t=document.createElement("link");return t.rel="stylesheet",i(e,t),t}function s(e,t){var n,r,i;if(t.singleton){var s=g++;n=v||(v=a(t)),r=c.bind(null,n,s,!1),i=c.bind(null,n,s,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=u(t),r=f.bind(null,n),i=function(){o(n),n.href&&URL.revokeObjectURL(n.href)}):(n=a(t),r=l.bind(null,n),i=function(){o(n)});return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else i()}}function c(e,t,n,r){var i=n?"":r.css;if(e.styleSheet)e.styleSheet.cssText=m(t,i);else{var o=document.createTextNode(i),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(o,a[t]):e.appendChild(o)}}function l(e,t){var n=t.css,r=t.media;if(r&&e.setAttribute("media",r),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}function f(e,t){var n=t.css,r=t.sourceMap;r&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var i=new Blob([n],{type:"text/css"}),o=e.href;e.href=URL.createObjectURL(i),o&&URL.revokeObjectURL(o)}var p={},d=function(e){var t;return function(){return void 0===t&&(t=e.apply(this,arguments)),t}},h=d(function(){return/msie [6-9]\b/.test(self.navigator.userAgent.toLowerCase())}),y=d(function(){return document.head||document.getElementsByTagName("head")[0]}),v=null,g=0,b=[];e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");t=t||{},void 0===t.singleton&&(t.singleton=h()),void 0===t.insertAt&&(t.insertAt="bottom");var i=r(e);return n(i,t),function(e){for(var o=[],a=0;a<i.length;a++){var u=i[a],s=p[u.id];s.refs--,o.push(s)}e&&n(r(e),t);for(var a=0;a<o.length;a++){var s=o[a];if(0===s.refs){for(var c=0;c<s.parts.length;c++)s.parts[c]();delete p[s.id]}}}};var m=function(){var e=[];return function(t,n){return e[t]=n,e.filter(Boolean).join("\n")}}()},,,function(e,t,n){"use strict";if(Object.defineProperty(t,"__esModule",{value:!0}),(t.zepto=n(123)).fn.each=function(e){var t=0;for(t;t<this.length&&!1!==e.call(this[t],t,this[t]);t++);return this},window.Prototype&&0!==JSON.stringify({s:[]}).indexOf('"[]"')){Array.prototype.toJSON=void 0;try{delete Array.prototype[Symbol.toStringTag],Array.prototype[Symbol.toStringTag]="Array"}catch(e){}}},,function(e,t,n){var r=n(270)("wks"),i=n(205),o=n(167).Symbol,a="function"==typeof o;(e.exports=function(e){return r[e]||(r[e]=a&&o[e]||(a?o:i)("Symbol."+e))}).store=r},,,function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.TimelineDeltaRef=t.Clock=t.AnalyticsService=t.Analytics=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(117),c=r(s),l=n(116),f=n(356),p=n(27),d=r(p),h=n(203),y=n(112),v=n(110),g=h.Maybe.fromNullable,b=h.Maybe.Just,m=h.Maybe.Nothing,_=function(e){var t={},n=e;for(var r in e){var i=n[r];t[r]=i.fold(function(e){return e})}return t},A=function(e){return function(t){try{return g(t(e))}catch(n){return y.ErrorHandler.trackError(new Error("\n      Analytics: Error happened trying to access config with "+t.toString()+"\n      received config: "+JSON.stringify(e)+"\n    ")),m()}}},w=t.Analytics=function(e){function t(){i(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.entityTrackMap={},e.timelineRefMap={},e}return a(t,e),u(t,[{key:"setUp",value:function(){this.data={url:g(window.location.href.split("#")[0]),device:g(v.DeviceDetector.getDevice()),token:b("-"),brandsafe:b(!0),publisherCountry:b("-"),templateName:b("-"),category:b("-"),subcategory:b("-"),os:g(v.DeviceDetector.getOS())},this.api=new f.AnalyticsApi(this.context.config)}},{key:"onConfigRecived",value:function(e){this.config=A(e.config),this.data.token=g(this.context.config.token),this.data.brandsafe=this.config(function(e){return e.brandsafe}).withDefault(!0),this.data.category=this.config(function(e){return e.category}).withDefault("-"),this.data.subcategory=this.config(function(e){return e.url.contextualization.contextData.subcategories[0]}).withDefault("-"),this.data.publisherCountry=this.config(function(e){return e.publisher.country}).withDefault("-")}},{key:"onTemplateSelected",value:function(e){e.template&&(this.data.templateName=g(e.template.name).withDefault("-"))}},{key:"track",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=d.assign({},_(this.data),t);this.api.trackEvent(e,n),this.context.log("track",e,t)}},{key:"getTimelineRef",value:function(e){return this.timelineRefMap[e]||(this.timelineRefMap[e]=new j),this.timelineRefMap[e]}},{key:"singleTrack",value:function(e,t,n){this.entityTrackMap[e+t]||(this.entityTrackMap[e+t]=!0,this.track(t,n))}},{key:"trackPageview",value:function(){}},{key:"trackTemplateFound",value:function(e){this.track("tagmanager-template-found",{templateName:e})}},{key:"trackTemplateNotFound",value:function(e){this.track("tagmanager-template-not-found")}},{key:"trackAdUnitFound",value:function(e){this.track("tagmanager-adunit-found",{adUnitName:e})}},{key:"trackAdUnitNotFound",value:function(e){this.track("tagmanager-adunit-not-found",{adUnitName:e})}},{key:"trackAdunitRejected",value:function(e,t){this.track("tagmanager-adunit-rejected",{adUnitName:e,reason:t})}},{key:"trackAdUnitView",value:function(e){this.track("tagmanager-adunit-viewed",{adUnitName:e,blacklistedWord:this.config(function(e){return e.blacklistedWord}).withDefault("-").fold(function(e){return e})})}},{key:"trackAdUnitViewCustomCategory",value:function(e,t){this.track("tagmanager-adunit-viewed-custom-category",{adUnitName:e,customCategory:t})}}]),t}(l.GohanComponent);w.ADSERVER_READY="adserver-ready",w.ADSERVER_NOT_READY="adserver-not-ready",c.__decorate([(0,l.Subscribe)("config","received"),c.__metadata("design:type",Function),c.__metadata("design:paramtypes",[Object]),c.__metadata("design:returntype",void 0)],w.prototype,"onConfigRecived",null),c.__decorate([(0,l.Subscribe)("template","selected"),c.__metadata("design:type",Function),c.__metadata("design:paramtypes",[Object]),c.__metadata("design:returntype",void 0)],w.prototype,"onTemplateSelected",null);var k=void 0,O=(t.AnalyticsService={ADSERVER_READY:w.ADSERVER_READY,ADSERVER_NOT_READY:w.ADSERVER_NOT_READY,get:function(e){return k||(k=new w(e)),k}},t.Clock=function(){function e(t){var n=this;i(this,e),this.startTime=Date.now(),this.time=0,this.interval=setInterval(function(){return n.time+=t},t)}return u(e,[{key:"stop",value:function(){clearInterval(this.interval)}},{key:"getTime",value:function(){return this.startTime+this.time}},{key:"getDeltaTime",value:function(){return this.time}}]),e}()),j=t.TimelineDeltaRef=function(){function e(){i(this,e),this._clock=new O(50),this._lastTime=this._clock.getTime(),this._lastReferenceTime=this._lastTime}return u(e,[{key:"getDelta",value:function(){return this._lastReferenceTime=this._clock.getTime(),this._lastReferenceTime-this._lastTime}},{key:"updateRef",value:function(){this._lastTime=this._lastReferenceTime||this._clock.getTime()}}]),e}()},,,,function(e,t,n){"use strict";(function(e){function r(e){return window.getComputedStyle(e)}function i(e){return parseFloat(e.replace("px",""))||0}function o(e,t){return i(e.getPropertyValue(t))}function a(e){return e.offset().top}function u(){return window.innerHeight}function s(){return window.innerWidth}function c(){return window.pageYOffset?window.pageYOffset:Math.max(document.documentElement.scrollTop,document.body.scrollTop)}function l(e,t){var n=e[0].getBoundingClientRect().top+e.height()/2,r=u(),i=r*(1-(t||100)/100)/2,o=i,a=r-i;return n>o&&n<a}function f(e,t){var n=Math.max(.4*u(),300);void 0!==t&&(n=t);var r=c()-n,i=c()+u()+n,o=a(e),s=o+e.height();return i>o&&r<o||i>s&&r<s}function p(e){var t=e.offsetParent(),n=e[0].getBoundingClientRect(),r=t[0].getBoundingClientRect(),a=getComputedStyle(e[0]);if(!a)throw new Error("cannot calculate element dimensions:\n      "+(e[0]?e[0].tagName:"no element")+" parent: "+e.parent()+" "+e.length);if(t.is("body")){var u=document.body.parentNode.getBoundingClientRect();r={top:u.top,left:r.left}}var s=function(u){return n[u]-r[u]+o(a,"padding-"+u)-i(t.css("border-"+u+"-width"))+i(e.css("border-"+u+"-width"))};return{top:s("top"),left:s("left")}}function d(e){return{x:e[0].width,y:e[0].height}}function h(){clearTimeout(T),T=setTimeout(function(){k.forEach(j,function(e,t){var n=e.$el,r=e.size,i={x:n.width(),y:n.height()};i.x===r.x&&i.y===r.y||(j[t].size=i,e.callback())}),h()},1e3)}function y(e,t){j.push({$el:e,size:{x:e.width(),y:e.height()},callback:t}),h()}function v(e){var t=e[0],n=-1;k.forEach(j,function(e,r){e.$el[0]===t&&(n=r)}),-1!==n&&j.slice(n,1),0===j.length&&clearTimeout(T)}function g(){clearTimeout(E),E=setTimeout(function(){k.forEach(x,function(e,t){var n=p(e.$el),r=e.position;r.top===n.top&&r.left===n.left||(x[t].position=n,e.callback())}),g()},1e3)}function b(e,t){x.push({$el:e,el:e[0],position:p(e),callback:t}),g()}function m(e){var t=e[0],n=-1;k.forEach(x,function(e,r){e.$el[0]===t&&(n=r)}),-1!==n&&x.slice(n,1),0===x.length&&clearTimeout(E)}function _(t){return new e(function(e,n){var r=!1;Object.keys(t).forEach(function(n){var i=function(){r||(r=!0,e(n))};t[n].then(i).catch(i)})})}function A(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new e(function(e,r){setTimeout(n?r:e,t)})}Object.defineProperty(t,"__esModule",{value:!0}),t.Util=void 0;var w=n(27),k=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(w),O=n(220),j=[],T=null,x=[],E=null;t.Util={race:_,wait:A,getComputed:r,getNumericComputed:o,isVisible:l,scrollY:c,viewPortHeight:u,viewportWidth:s,pxToInt:i,offset:p,size:d,isNearViewport:f,onSizeChange:y,offSizeChange:v,onPositionChange:b,offPositionChange:m,isMouseOver:function(){var e=new O.MousePosition;return e.elementIsHover.bind(e)}()}}).call(t,n(83))},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){var t=y.SEEDTAG_DISPLAY;return p.forEach(b,function(n,r){if(n(e))return t=r||"",!1}),t}function u(e,t){return e.x===t.x&&e.y===t.y}Object.defineProperty(t,"__esModule",{value:!0}),t.AdModel=t.AdSources=t.AdFormats=void 0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0},l=n(224),f=n(27),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(f),d=n(119),h=n(111),y=t.AdFormats=void 0;!function(e){e.SEEDTAG_DISPLAY="seedtag_display",e.SEEDTAG_TAG="seedtag_tag",e.SEEEDTAG_PREMIUM_DISPLAY="seedtag_premium_display",e.OPEN_VIDEO="open_video"}(y||(t.AdFormats=y={}));var v=t.AdSources=void 0;!function(e){e.UNKNOWN="unknown",e.APN="apn",e.ST_NETWORKS_DISPLAY="st_networks_display",e.ST_NETWORKS_VIDEO="st_networks_video"}(v||(t.AdSources=v={}));var g=[y.OPEN_VIDEO],b={seedtag_display:function(e){return-1!==[10,11,13,20,105,600].indexOf(e.size.x)},seedtag_tag:function(e){return 12===e.size.x},open_video:function(e){return-1!==[1].indexOf(e.size.x)}};t.AdModel=function(e){function t(){r(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.source=v.UNKNOWN,e.network="",e.size={x:0,y:0},e.content="",e.trackers={impression:[]},e.csm=null,e}return o(t,e),s(t,[{key:"getFormat",value:function(){return a(this)}},{key:"getSourceName",value:function(){return this.source}},{key:"isCsmVideo",value:function(){return this.csm&&this.csm.networkTargeting.networkAd instanceof d.VideoAd}},{key:"getVideoKind",value:function(){return this.csm&&this.isCsmVideo()?d.VideoAd.getVideoKind(this.csm.networkTargeting.networkAd):d.VideoAd.getVideoKind()}},{key:"getVast",value:function(){return this.csm&&this.isCsmVideo()?this.csm.networkTargeting.networkAd.asVideo().vast:h.Maybe.Nothing()}},{key:"isCsm",value:function(){return null!==this.csm}},{key:"isDisplay",value:function(){return this.format!==y.SEEDTAG_TAG}},{key:"isOpen",value:function(){return-1!==g.indexOf(this.format)}},{key:"isSize",value:function(e){return u(this.size,e)}},{key:"hydrate",value:function(e){c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"hydrate",this).call(this,p.clone(e))}},{key:"format",get:function(){return this.getFormat()}}]),t}(l.Model)},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(219);Object.defineProperty(t,"AdUnit",{enumerable:!0,get:function(){return r.AdUnit}})},function(e,t,n){"use strict";(function(e){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.EventProcess=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(117),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(o),u=n(112);t.EventProcess=function(){function t(e,n){r(this,t),this._blocked=!1,this._terminated=!1,this._fsm=e.call(n),this._status=this._fsm.next().value}return i(t,[{key:"run",value:function(t){return a.__awaiter(this,void 0,void 0,e.mark(function n(){var r,i,o,a,s,c,l,f,p,d=this;return e.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!this._blocked&&!this._terminated){e.next=3;break}return e.abrupt("return");case 3:if("SUSPENDED"!==this._status[0]){e.next=10;break}if(r=this._fsm.next(),!this.isTerminated(r.done)){e.next=7;break}return e.abrupt("return");case 7:this._status=r.value,e.next=3;break;case 10:if("WAITING"!==this._status[0]){e.next=14;break}return this._blocked=!0,setTimeout(function(){try{var e=d._fsm.next();if(d.isTerminated(e.done))return;d._status=e.value,d._blocked=!1}catch(e){u.ErrorHandler.trackError(e)}},this._status[1]),e.abrupt("return");case 14:if("RACING"!==this._status[0]){e.next=22;break}if(i=this._status,!(o=i[1][t.message])){e.next=22;break}if(a=this._fsm.next(o(t.data)),!this.isTerminated(a.done)){e.next=21;break}return e.abrupt("return");case 21:this._status=a.value;case 22:if("RECEIVING"!==this._status[0]){e.next=29;break}if(s=this._status,!(s[1].indexOf(t.message)>-1)){e.next=29;break}if(c=this._fsm.next(t),!this.isTerminated(c.done)){e.next=28;break}return e.abrupt("return");case 28:this._status=c.value;case 29:if("RESOLVING"!==this._status[0]){e.next=50;break}return this._blocked=!0,l=this._status,e.prev=32,e.t0=this._fsm,e.next=36,l[1];case 36:if(e.t1=e.sent,f=e.t0.next.call(e.t0,e.t1),!this.isTerminated(f.done)){e.next=40;break}return e.abrupt("return");case 40:this._status=f.value,e.next=49;break;case 43:if(e.prev=43,e.t2=e.catch(32),p=this._fsm.throw(e.t2),!this.isTerminated(p.done)){e.next=48;break}return e.abrupt("return");case 48:this._status=p.value;case 49:this._blocked=!1;case 50:e.next=54;break;case 52:e.prev=52,e.t3=e.catch(0);case 54:case"end":return e.stop()}},n,this,[[0,52],[32,43]])}))}},{key:"isTerminated",value:function(e){return!!e&&(this._terminated=!0,e)}}],[{key:"receive",value:function(e){return["RECEIVING",e]}},{key:"race",value:function(e){return["RACING",e]}},{key:"wait",value:function(e){return["WAITING",e]}},{key:"resolve",value:function(e){return["RESOLVING",e]}}]),t}()}).call(t,n(118))},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){e.exports=!n(206)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},,,function(e,t,n){var r=n(167),i=n(181),o=n(177),a=n(205)("src"),u=Function.toString,s=(""+u).split("toString");n(207).inspectSource=function(e){return u.call(e)},(e.exports=function(e,t,n,u){var c="function"==typeof n;c&&(o(n,"name")||i(n,"name",t)),e[t]!==n&&(c&&(o(n,a)||i(n,a,e[t]?""+e[t]:s.join(String(t)))),e===r?e[t]=n:u?e[t]?e[t]=n:i(e,t,n):(delete e[t],i(e,t,n)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[a]||u.call(this)})},function(e,t,n){var r=n(182),i=n(230);e.exports=n(176)?function(e,t,n){return r.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var r=n(183),i=n(271),o=n(273),a=Object.defineProperty;t.f=n(176)?Object.defineProperty:function(e,t,n){if(r(e),t=o(t,!0),r(n),i)try{return a(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){var r=n(175);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},,,,,,,,,function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.Ajax=void 0;var r=n(27);t.Ajax=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{withCredentials:!1},i=t.method||"GET",o=t.headers={};return new e(function(e,a){var u=new XMLHttpRequest,s=function(){var t=u.responseText;t=/application\/json/.test((u.getResponseHeader("Content-Type")||"").toLowerCase())?JSON.parse(t):t,e(t)},c=function(e){return a(new TypeError("Network request failed ("+e+")"))};u.onreadystatechange=function(){4===u.readyState&&(u.status>=200&&u.status<300?s():c(u.status))},u.open(i,t.url,!0),u.withCredentials=n.withCredentials||!1,(0,r.keys)(t.headers||{}).forEach(function(e){u.setRequestHeader(e,t&&o[e]||"")}),u.send("GET"!==t.method?t.body:void 0)})}}).call(t,n(83))},function(e,t){e.exports={}},,,,,,,function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.AdUnitModel=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(27),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(o),u=n(201);t.AdUnitModel=function(){function e(t){r(this,e);var n=t||{};this.id=n.id,this.name=n.name,this.variables=[],this.sherlock={},this.adserverId=t.adserverId,this.evaluable=t.evaluable,this.visibility=t.visibility||{expression:"return true",type:"js"},t.variables&&this.setVariables(t.variables),t.sherlock&&(this.sherlock=t.sherlock)}return i(e,[{key:"setVariables",value:function(e){var t=this;a.forEach(e,function(e){t.variables.push(new u.VariableModel(e))})}},{key:"getVariables",value:function(){return this.variables}}]),e}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.VariableModel=function e(t){r(this,e);var n=t||{};this.name=n.name,this.evaluable=n.evaluable,this.targetingKeyword=n.targetingKeyword}},function(e,t,n){"use strict";(function(e){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(t,n,r,i){var o=c.assign({},f,i||{}),a={url:n,method:t.toUpperCase(),headers:{}};if("GET"===a.method&&r){var u=/\?/.test(a.url)?"&":"?";a.url+=""+u+Object.keys(r).map(function(e){return e+"="+encodeURIComponent(r[e])}).join("&")}else r&&(a.body=c.isObject(r)?JSON.stringify(r):r,c.isString(a.body)&&!0===o.base64&&(a.body=window.btoa(a.body)),o.json&&!o.base64&&(a.headers["Content-Type"]="application/json"));return new e(function(e,t){var n=new XMLHttpRequest,r=function(){var t=n.responseText;if(t=/application\/json/.test((n.getResponseHeader("Content-Type")||"").toLowerCase())?JSON.parse(t):t,o.xhr&&i)try{t.__xhr=n}catch(e){}e(t)},u=function(e){return t(new TypeError("Network request failed ("+e+")"))};n.onreadystatechange=function(){4===n.readyState&&(n.status>=200&&n.status<300?r():u(n.status))},n.open(a.method,a.url,!0),n.withCredentials=o.withCredentials||!1,c.keys(a.headers).forEach(function(e){n.setRequestHeader(e,a.headers[e])}),n.send("GET"!==a.method?a.body:void 0)})}Object.defineProperty(t,"__esModule",{value:!0}),t.BaseApi=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.fetch=a;var s=n(27),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(s);n(357),n(358);var l=n(116),f=(t.BaseApi=function(e){function t(){r(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e._ajax=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return a.apply(null,t)},e}return o(t,e),u(t,[{key:"setUp",value:function(){}}]),t}(l.GohanComponent),{withCredentials:!1,json:!0,base64:!1,xhr:!1})}).call(t,n(83))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Enum=void 0;var r=n(359);Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})});var i=n(263);Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})});var o=n(111);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})});var a=n(264);Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})});var u=n(360);Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return u[e]}})});var s=n(361);Object.keys(s).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}})});var c=n(362);Object.keys(c).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return c[e]}})});var l=n(128),f=function(e){return e&&e.__esModule?e:{default:e}}(l);t.Enum=f.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t){return e-e%t},i=(t.createFloorNormalizer=function(e){return function(t){return r(t,e)}},function(e,t){return r(e,t)+t}),o=(t.createCeilNormalizer=function(e){return function(t){return i(t,e)}},function(e,t){var n=r(e,t);return e-n<t/2?n:n+t}),a=(t.createRoundNormalizer=function(e){return function(t){return o(t,e)}},function e(t,n,r){return r>=n.length?n[n.length-1]:t<=n[r]&&t>n[r-1]?n[r]:e(t,n,r+1)}),u=function(e,t){var n=t.length-1;return e<=t[0]?t[0]:e>=t[n]?t[n]:a(e,t,1)};t.createArrayNormalizer=function(e){return function(t){return u(t,e)}}},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t){var n=e.exports={version:"2.4.0"};"number"==typeof __e&&(__e=n)},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){var r=n(405);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},function(e,t,n){var r=n(410),i=n(208);e.exports=function(e){return r(i(e))}},,,,,,,,,function(e,t,n){"use strict";(function(e,r){function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.AdUnit=void 0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(117),l=i(c),f=n(27),p=i(f),d=n(156),h=n(116),y=n(165),v=n(221),g=n(174),b=y.Util.getComputed,m=y.Util.getNumericComputed;n(222);var _=t.AdUnit=function(t){function i(e,t,n){o(this,i);var r=a(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,n));return r.enableAdRequests=!0,r.adRequester=new v.AdLazyLoad(e),r.model=t,r.$el=(0,d.zepto)("<div>").addClass("seedtag-gohan seedtag-adunit"),r.$container=(0,d.zepto)("<div>").addClass("st-container"),r._$pageEl=(0,d.zepto)(e),r._components=[],r.adRequested=!1,r._imageId={},r.state={visible:!1,lazyLoading:!1,readyToRequestAd:!0},r.$el.append(r.$container),r.$el.insertAfter(r._$pageEl),r}return u(i,t),s(i,[{key:"subToAdResolved",value:function(t){return l.__awaiter(this,void 0,void 0,e.mark(function o(){var a,u,s,c,l;return e.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(t.adunit!==this){o.next=15;break}return a=this,u=n.e(4).then(n.bind(null,262)),s=new r(function(t){var n=setInterval(function(){return r.run({message:"check-position",data:{}})},100),r=new g.EventProcess(e.mark(function r(){return e.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,g.EventProcess.receive("check-position");case 3:if(!this.adRequester.isNotMovingFastAndIsNear()){e.next=5;break}return e.abrupt("break",7);case 5:e.next=0;break;case 7:clearInterval(n),t();case 9:case"end":return e.stop()}},r,this)}),a)}),o.next=6,u;case 6:if(c=o.sent,l=c.AdViewFactory,i.AdViewFactory=l,t.admodel.isCsmVideo()){o.next=14;break}return o.next=12,s;case 12:o.next=14;break;case 14:this.resolveAd(t.admodel);case 15:case"end":return o.stop()}},o,this)}))}},{key:"resolveAd",value:function(t){return l.__awaiter(this,void 0,void 0,e.mark(function n(){return e.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.makeAd(t);case 2:this.ad=e.sent,this.checkPosition(t),this.addAdView();case 5:case"end":return e.stop()}},n,this)}))}},{key:"subToNoAd",value:function(e){e.adunit===this&&(this.adRequested=!1,this.requestAd())}},{key:"subToImageResolved",value:function(e){e.adunit===this&&(this._imageId=e.id,this.model.sherlock=e.data,this.state.readyToRequestAd=!0,this.state.lazyLoading?this.checkPosition():this.requestAd())}},{key:"notifyAdUnitView",value:function(){return{adunit:this}}},{key:"_requestAd",value:function(){return{adunit:this}}},{key:"requestAd",value:function(){!this.adRequested&&this.enableAdRequests&&(this.adRequested=!0,this._requestAd())}},{key:"destroy",value:function(){this.$el.remove()}},{key:"getTagged",value:function(){return this._$pageEl}},{key:"onInsert",value:function(){this.bindEvents(),this.checkPosition()}},{key:"getTaggedElement",value:function(){return this._$pageEl[0]}},{key:"render",value:function(){this.$el.css(this.getPosition()),this.$el.css({zIndex:this.getZindex(this._$pageEl)+1}),p.forEach(this._components,function(e){e.render()}),this.$container.css({width:this.getImageSize().x})}},{key:"getZindex",value:function(e){var t=e.css("z-index");return isNaN(t)?0:parseInt(t,void 0)}},{key:"addComponent",value:function(e){e.setAdunit(this),this._components.push(e),this.$container.append(e.$el),this.render(),e.onInsert()}},{key:"removeComponent",value:function(e){p.remove(this._components,function(t){return t===e}),e.onDestroy(),e.$el.remove()}},{key:"getTagId",value:function(){var e=null,t=this.model.name&&this.model.name.split("-"),n=parseInt(t[t.length-1],10);return isNaN(n)||(e=n),this.model.adserverId?this.model.adserverId:e}},{key:"getModel",value:function(){return this.model}},{key:"getPosition",value:function(){return y.Util.offset(this._$pageEl)}},{key:"getImageSize",value:function(){var e=b(this._$pageEl[0]),t={x:m(e,"width")-m(e,"border-left-width")-m(e,"border-right-width"),y:m(e,"height")-m(e,"border-top-width")-m(e,"border-bottom-width")};return"content-box"!==e.boxSizing&&(t.x-=m(e,"padding-right"),t.x-=m(e,"padding-left"),t.y-=m(e,"padding-bottom"),t.y-=m(e,"padding-top")),0===t.y&&(t.y=m(e,"padding-top"),t.y+=m(e,"padding-bottom")),t}},{key:"setUp",value:function(){}},{key:"bindEvents",value:function(){var e=this,t=d.zepto,n=void 0;t(document).on("scroll",p.throttle(function(){clearTimeout(n),n=setTimeout(function(){e.checkPosition()},500),e.checkPosition()},100)),(0,d.zepto)(window).on("resize",function(){e.render()}),this.$el.resize(function(){return e.render()}),y.Util.onSizeChange(this._$pageEl,function(){e.render()}),y.Util.onPositionChange(this._$pageEl,function(){e.checkPosition(),e.render()}),this._startVisibilityThread()}},{key:"_startVisibilityThread",value:function(){var e=this,t=this.context.get("factory.evaluable");if(t){var n=function(){var n=t(e.model.visibility),r=n.evaluate({element:e._$pageEl[0]});e.$el,r?(e.$el.removeClass("st-hidden"),setTimeout(function(){return e.$el.removeClass("st-fade-out")})):(e.$el.addClass("st-fade-out"),setTimeout(function(){e.$el.addClass("st-hidden")},100))};setInterval(n.bind(this),500)}}},{key:"setEnableAdRequests",value:function(e){this.enableAdRequests=e}},{key:"checkPosition",value:function(e){var t=e&&e.isCsmVideo(),n=!!t||y.Util.isVisible(this._$pageEl,80);(n&&!this.state.visible||t)&&this.notifyAdUnitView(),this.adRequested||this.adRequester.isNotMovingFastAndIsNear()&&this.state.readyToRequestAd&&!this.adRequested&&this.requestAd(),this.state.visible=n}},{key:"makeAd",value:function(t){return l.__awaiter(this,void 0,void 0,e.mark(function n(){var r;return e.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=new i.AdViewFactory(this.context),e.abrupt("return",r.get(t,this));case 2:case"end":return e.stop()}},n,this)}))}},{key:"addAdView",value:function(){this.ad&&(this.addComponent(this.ad),this.ad=null)}}]),i}(h.GohanComponent);l.__decorate([(0,h.Subscribe)("adserver","ad.resolved"),l.__metadata("design:type",Function),l.__metadata("design:paramtypes",[Object]),l.__metadata("design:returntype",r)],_.prototype,"subToAdResolved",null),l.__decorate([(0,h.Subscribe)("ad","noad"),l.__metadata("design:type",Function),l.__metadata("design:paramtypes",[Object]),l.__metadata("design:returntype",void 0)],_.prototype,"subToNoAd",null),l.__decorate([(0,h.Subscribe)("adunit","image.resolved"),l.__metadata("design:type",Function),l.__metadata("design:paramtypes",[Object]),l.__metadata("design:returntype",void 0)],_.prototype,"subToImageResolved",null),l.__decorate([(0,h.Publish)("adunit","view"),l.__metadata("design:type",Function),l.__metadata("design:paramtypes",[]),l.__metadata("design:returntype",void 0)],_.prototype,"notifyAdUnitView",null),l.__decorate([(0,h.Publish)("adunit","ad.request"),l.__metadata("design:type",Function),l.__metadata("design:paramtypes",[]),l.__metadata("design:returntype",void 0)],_.prototype,"_requestAd",null)}).call(t,n(118),n(83))},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){return e.getBoundingClientRect()}function o(e,t){return e>=t.start&&e<=t.end}function a(e,t){var n=i(t),r=o(e.x,{start:n.left,end:n.right}),a=o(e.y,{start:n.top,end:n.bottom});return r&&a}Object.defineProperty(t,"__esModule",{value:!0}),t.MousePosition=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(27);t.MousePosition=function(){function e(){var t=this;r(this,e),this.position={x:0,y:0},window.addEventListener("mousemove",(0,s.throttle)(function(e){t.position.x=e.clientX,t.position.y=e.clientY},200))}return u(e,[{key:"elementIsHover",value:function(e){return a(this.position,e)}}]),e}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.AdLazyLoad=void 0;var i,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(165),u=n(110);!function(e){e.stopped="stopped",e.forward="forward",e.backward="backward"}(i||(i={}));var s=function(e){return 0===e?i.stopped:e<0?i.forward:i.backward},c=function(e){var t=e.getBoundingClientRect(),n=t.top,r=e.offsetHeight;return{top:t.top,bottom:n+r,size:r,center:n+r/2}},l=function(){var e=a.Util.viewPortHeight();return{top:0,center:e/2,bottom:e,size:e}},f=(t.AdLazyLoad=function(){function e(t){r(this,e),this.deviceType=u.DeviceDetector.isHandheldDevice()?"handheld":"desktop",this.speedLimits={desktop:{inViewPort:.5,outViewPort:1},handheld:{inViewPort:.25,outViewPort:.5}},this.speedMeter=new f,this.speedLimiter=new p(this.speedLimits[this.deviceType]),this.el=t}return o(e,[{key:"isNotMovingFastAndIsNear",value:function(){var e=c(this.el),t=l(),n=this.speedMeter.getSpeed(e,t);return!this.speedLimiter.isMovingFast(e,t,n)&&this.isNear(e,t,n)}},{key:"getRequestRanges",value:function(e,t){return{stopped:{top:.25*e.size,bottom:.75*e.size},forward:{top:.75*e.size,bottom:e.size*Math.min(1+Math.abs(t),1.3)},backward:{top:.25*e.size,bottom:.5*e.size}}}},{key:"isNear",value:function(e,t,n){var r=this.getRequestRanges(t,n),i=r[s(n)]||r.stopped;return e.center>i.top&&e.center<i.bottom}}]),e}(),function(){function e(){r(this,e)}return o(e,[{key:"getSpeed",value:function(e,t){var n=new Date,r=(n.getTime()-this.getTime().getTime())/1e3,i=e.top-this.getPreviousPosition();return this.time=n,this.position=e,r?Math.floor(i/t.size/r*100)/100:0}},{key:"getTime",value:function(){return this.time?this.time:new Date}},{key:"getPreviousPosition",value:function(){return this.position?this.position.top:0}}]),e}()),p=function(){function e(t){r(this,e),this.speedLimits=t}return o(e,[{key:"isMovingFast",value:function(e,t,n){var r=this.isOnView(e,t)?this.speedLimits.inViewPort:this.speedLimits.outViewPort;return Math.abs(n)>r}},{key:"isOnView",value:function(e,t){return e.center>0&&e.center<t.bottom}}]),e}()},function(e,t,n){var r=n(223);"string"==typeof r&&(r=[[e.i,r,""]]),n(153)(r,{}),r.locals&&(e.exports=r.locals)},function(e,t,n){t=e.exports=n(152)(void 0),t.push([e.i,".seedtag-gohan .hide{display:none!important;opacity:0!important;visibility:hidden!important}.seedtag-gohan .show{display:block!important;opacity:1!important;visibility:visible!important;max-width:none!important}.seedtag-gohan.seedtag-adunit{position:absolute!important;margin:0!important}.seedtag-gohan.seedtag-adunit>*{display:none!important;opacity:0!important;visibility:hidden!important}.seedtag-gohan.seedtag-adunit .st-container{display:block!important;opacity:1!important;visibility:visible!important;max-width:none!important;z-index:2;position:relative}.seedtag-gohan.seedtag-adunit .st-container .st-adunit-component{position:absolute;top:0;left:0}.seedtag-gohan.seedtag-adunit .st-container .st-adunit-component>*{display:none!important;opacity:0!important;visibility:hidden!important}.seedtag-gohan.seedtag-adunit .st-container .st-adunit-component .st-container{width:100%;display:block!important;opacity:1!important;visibility:visible!important;max-width:none!important}.seedtag-gohan.seedtag-adunit.st-fade-out .st-container>*{transition:opacity .2s linear;opacity:1}.seedtag-gohan.seedtag-adunit.st-hidden .st-container>*{opacity:.5}",""])},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Model=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(27);t.Model=function(){function e(){r(this,e)}return i(e,[{key:"hydrate",value:function(e){var t=this,n={};(0,o.reduce)((0,o.filter)((0,o.keys)(e),function(e){return(0,o.has)(t,e)}),function(t,n){return t[n]=e[n],t},n),(0,o.merge)(this,n)}},{key:"dehydrate",value:function(){var e=this,t={};return(0,o.reduce)((0,o.filter)((0,o.keys)(this),function(t){return(0,o.has)(e,t)&&!(0,o.isFunction)(e[t])}),function(t,n){return t[n]=e[n],t},t),(0,o.merge)({},t)}}]),e}()},,function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.PublisherFeatureService=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(116),s=n(27),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(s);t.PublisherFeatureService=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),a(t,[{key:"setUp",value:function(){var e=this,t=this.context;this.features=t.config.publisherFeatures,t.subscribe({channel:"config",topic:"received",callback:function(t){e.features=c.assign(e.features,c.get(t,"config.publisher.features",{})),e.response()}}),t.subscribe({channel:"features",topic:"request",callback:this.response.bind(this)})}},{key:"response",value:function(){this.context.publish({channel:"features",topic:"response",data:{features:this.features}})}}]),t}(u.GohanComponent)},function(e,t,n){var r=n(228);"string"==typeof r&&(r=[[e.i,r,""]]),n(153)(r,{}),r.locals&&(e.exports=r.locals)},function(e,t,n){t=e.exports=n(152)(void 0),t.push([e.i,".seedtag-gohan,.seedtag-gohan.seedtag-adunit{margin:0;padding:0!important;border:0;width:0;height:0;font-size:14px;vertical-align:baseline;box-sizing:content-box;max-width:none;visibility:visible;color:#000;text-align:left}.seedtag-gohan *,.seedtag-gohan.seedtag-adunit *{font-family:Open Sans,Helvetica,Arial,sans-serif;background:none repeat scroll 0 0 transparent;border:medium none;border-spacing:0;font-weight:400;list-style:none outside none;margin:0;padding:0;text-align:left;text-decoration:none;text-indent:0;float:none}.seedtag-gohan.seedtag-adunit div,.seedtag-gohan.seedtag-adunit form,.seedtag-gohan.seedtag-adunit h1,.seedtag-gohan.seedtag-adunit h2,.seedtag-gohan.seedtag-adunit h3,.seedtag-gohan.seedtag-adunit iframe,.seedtag-gohan.seedtag-adunit input,.seedtag-gohan.seedtag-adunit label,.seedtag-gohan.seedtag-adunit li,.seedtag-gohan.seedtag-adunit ol,.seedtag-gohan.seedtag-adunit span,.seedtag-gohan.seedtag-adunit ul,.seedtag-gohan div,.seedtag-gohan form,.seedtag-gohan h1,.seedtag-gohan h2,.seedtag-gohan h3,.seedtag-gohan iframe,.seedtag-gohan input,.seedtag-gohan label,.seedtag-gohan li,.seedtag-gohan ol,.seedtag-gohan span,.seedtag-gohan ul{margin:0;padding:0;border:0;font-size:14px;vertical-align:baseline;box-sizing:content-box;max-width:none;visibility:visible;line-height:normal;height:auto;width:auto}.seedtag-gohan.seedtag-adunit small,.seedtag-gohan small{font-size:12px}.seedtag-gohan.seedtag-adunit input,.seedtag-gohan input{outline:0;height:auto;width:auto}.seedtag-gohan.seedtag-adunit img,.seedtag-gohan img{border:0!important}.seedtag-gohan.seedtag-adunit a,.seedtag-gohan a{color:#fff}.seedtag-gohan.seedtag-adunit a i,.seedtag-gohan.seedtag-adunit a i:active,.seedtag-gohan.seedtag-adunit a i:hover,.seedtag-gohan.seedtag-adunit a i:visited,.seedtag-gohan a i,.seedtag-gohan a i:active,.seedtag-gohan a i:hover,.seedtag-gohan a i:visited{display:block;color:#fff;font-size:14px;font-style:normal!important}.seedtag-gohan.seedtag-adunit select,.seedtag-gohan select{display:block;height:auto}",""])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hasProperSize=void 0;var r=n(110);t.hasProperSize=function(e,t){var n=!0,i=r.detector.isHandheldDevice()?"handheld":"desktop",o=t[i]||{},a=o.min,u=o.max,s=e.offsetWidth,c=e.offsetHeight;return a&&(n=s>=a.w&&c>=a.h),u&&(n=n&&s<=u.w&&c<=u.h),n}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},function(e,t,n){"use strict";var r=n(404),i=n(274),o=n(180),a=n(181),u=n(177),s=n(193),c=n(406),l=n(234),f=n(414),p=n(158)("iterator"),d=!([].keys&&"next"in[].keys()),h=function(){return this};e.exports=function(e,t,n,y,v,g,b){c(n,t,y);var m,_,A,w=function(e){if(!d&&e in T)return T[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},k=t+" Iterator",O="values"==v,j=!1,T=e.prototype,x=T[p]||T["@@iterator"]||v&&T[v],E=x||w(v),P=v?O?w("entries"):E:void 0,S="Array"==t?T.entries||x:x;if(S&&(A=f(S.call(new e)))!==Object.prototype&&(l(A,k,!0),r||u(A,p)||a(A,p,h)),O&&x&&"values"!==x.name&&(j=!0,E=function(){return x.call(this)}),r&&!b||!d&&!j&&T[p]||a(T,p,E),s[t]=E,s[k]=h,v)if(m={values:O?E:w("values"),keys:g?E:w("keys"),entries:P},b)for(_ in m)_ in T||o(T,_,m[_]);else i(i.P+i.F*(d||j),t,m);return m}},function(e,t,n){var r=n(270)("keys"),i=n(205);e.exports=function(e){return r[e]||(r[e]=i(e))}},function(e,t,n){var r=n(182).f,i=n(177),o=n(158)("toStringTag");e.exports=function(e,t,n){e&&!i(e=n?e:e.prototype,o)&&r(e,o,{configurable:!0,value:t})}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Adapter=void 0;var a=n(121);t.Adapter=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),t}(a.GohanComponent)},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.XmlParser={xml2dom:function(){var t=void 0;if(void 0!==e.DOMParser)t=function(t){return(new e.DOMParser).parseFromString(t,"text/xml")};else{if(void 0===e.ActiveXObject||!new e.ActiveXObject("Microsoft.XMLDOM"))throw new Error("No XML parser found");t=function(t){var n=new e.ActiveXObject("Microsoft.XMLDOM");return n.async="false",n.loadXML(t),n}}return t}(),dom2xml:function(e){return"undefined"!=typeof XMLSerializer?(new XMLSerializer).serializeToString(e):e.xml?e.xml:void 0},findByTagName:function(e,t){return e.documentElement.getElementsByTagName(t)}}}).call(t,n(45))},,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=arguments,i=function(){return this},o=function e(t){return{get isError(){return!1},get isOk(){return!0},ap:function(e){return this.chain(function(t){return e.map(t)})},map:function(n){return e(n(t))},do:function(e){return e(t),this},chain:function(e){return e(t)},fold:function(e,n){return n(t)},concat:function(n){return n.fold(function(e){return n},function(n){return e(t.concat(n))})},withDefault:i,toString:function(){return"Ok("+t+")"}}},a=function(e){return{get isError(){return!0},get isOk(){return!1},ap:i,map:i,do:i,chain:i,fold:function(t,n){return t(e)},concat:i,withDefault:function(e){return this.isError?o(e):this},toString:function(){return"Error("+e+")"}}},u=function(e){return e?o(e):a(void 0)},s=function(e){try{return o(e.apply(null,r))}catch(e){return a(e)}},c=function(e){var t=e.filter(function(e){return e.isError});if(t.length>0){var n=t.map(function(e){return e.fold(function(e){return e},i)});return a(n)}var r=e.map(function(e){return e.fold(i,function(e){return e})});return o(r)};t.Result={Ok:o,Err:a,fromNullable:u,tryCatch:s,traverse:c}},function(e,t,n){"use strict";function r(e,t){var n=Object.create(h);return n.fork=e,n.cleanup=t||function(){},n}function i(e){return r(function(t,n){return n(e)})}function o(e){return r(function(t){return t(e)})}function a(e){var t=this.fork,n=this.cleanup;return r(function(n,r){return t(function(e){return n(e)},function(t){return r(e(t))})},n)}function u(e){var t=this.fork,n=this.cleanup;return r(function(n,r){return t(function(e){return n(e)},function(t){return e(t).fork(n,r)})},n)}function s(e){function t(e){o(e[0]),a(e[1])}var n=this.fork,i=e.fork,o=this.cleanup,a=e.cleanup;return r(function(e,r){function o(e){return function(n){if(!f)return e(n),s&&l?(setTimeout(function(){t(p)}),r(u(c))):n}}function a(t){if(!f)return f=!0,e(t)}var u=null,s=!1,c=null,l=!1,f=!1,p=void 0,d=n(a,o(function(e){s=!0,u=e})),h=i(a,o(function(e){l=!0,c=e}));return p=[d,h]},t)}function c(e){function t(e){o(e[0]),a(e[1])}var n=this.fork,i=e.fork,o=this.cleanup,a=e.cleanup;return r(function(e,r){function o(e){return function(n){if(!a)return a=!0,setTimeout(function(){t(u)}),e(n)}}var a=!1,u=void 0,s=n(o(e),o(r)),c=i(o(e),o(r));return u=[s,c]},t)}function l(){return r(function(){})}function f(){return"Task"}function p(e){var t=this.fork,n=this.cleanup;return r(function(n,r){return t(function(t){return e(t).fork(n,r)},function(e){return r(e)})},n)}function d(e,t){var n=this.fork,i=this.cleanup;return r(function(r,i){return n(function(t){return i(e(t))},function(e){return i(t(e))})},i)}Object.defineProperty(t,"__esModule",{value:!0}),t.TaskConstructor=r,t.of=i,t.rejected=o,t.empty=l;var h={of:i,rejected:o,map:a,chain:u,ap:s,concat:c,empty:l,toString:f,withDefault:p,fold:d},y=r;r.of=h.of,r.rejected=h.rejected,t.Task=y},function(e,t,n){"use strict";function r(e){return e}function i(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}Object.defineProperty(t,"__esModule",{value:!0}),t.noop=r,t.guid=i},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.BaseStrategy=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(116),s=n(173);t.BaseStrategy=function(e){function t(e,n){r(this,t);var o=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return o.options=n,o}return o(t,e),a(t,[{key:"setUp",value:function(){}},{key:"createAdUnit",value:function(e,t){var n=new s.AdUnit(e,t,this.context);return this.options.enableAdRequests||n.setEnableAdRequests(!1),n}},{key:"findAdUnits",value:function(e){this.callback=e,this._find()}},{key:"retry",value:function(e){}}]),t}(u.GohanComponent)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.AllImagesStrategy=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(266),s=n(200),c=n(229),l=n(27),f=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(l),p={name:"admin-manual-",evaluable:{expression:"",type:"js"},targetId:Math.random(),variables:[]};t.AllImagesStrategy=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),a(t,[{key:"setUp",value:function(){this.elements=[],this.discarded=[],this.checkTimes=0}},{key:"_find",value:function(){var e=1e3,t=document.querySelectorAll('img, div[style*="background-image"]');t=f.filter(t,this.notLocated.bind(this)),t=f.filter(t,this.notDiscarded.bind(this)),t=f.filter(t,this.sizeFilter.bind(this)),f.forEach(t,this._notify.bind(this)),0===t.length&&(e=3e3),this.checkTimes%10==0&&(this.discarded=[]),this.checkTimes++,setTimeout(this._find.bind(this),e)}},{key:"_notify",value:function(e){var t=f.clone(p);this.elements.push(e),t.name+=this.elements.length,this.callback&&this.callback({element:e,model:new s.AdUnitModel(t)})}},{key:"sizeFilter",value:function(e){return(0,c.hasProperSize)(e,this.options.sizeLimits||{})}},{key:"notDiscarded",value:function(e){return-1===this.discarded.indexOf(e)}},{key:"notLocated",value:function(e){return-1===this.elements.indexOf(e)}}]),t}(u.BaseStrategy)},function(e,t,n){var r=n(269),i=n(158)("toStringTag"),o="Arguments"==r(function(){return arguments}()),a=function(e,t){try{return e[t]}catch(e){}};e.exports=function(e){var t,n,u;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=a(t=Object(e),i))?n:o?r(t):"Object"==(u=r(t))&&"function"==typeof t.callee?"Arguments":u}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,n){var r=n(167),i=r["__core-js_shared__"]||(r["__core-js_shared__"]={});e.exports=function(e){return i[e]||(i[e]={})}},function(e,t,n){e.exports=!n(176)&&!n(206)(function(){return 7!=Object.defineProperty(n(272)("div"),"a",{get:function(){return 7}}).a})},function(e,t,n){var r=n(175),i=n(167).document,o=r(i)&&r(i.createElement);e.exports=function(e){return o?i.createElement(e):{}}},function(e,t,n){var r=n(175);e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t,n){var r=n(167),i=n(207),o=n(181),a=n(180),u=n(209),s=function(e,t,n){var c,l,f,p,d=e&s.F,h=e&s.G,y=e&s.S,v=e&s.P,g=e&s.B,b=h?r:y?r[t]||(r[t]={}):(r[t]||{}).prototype,m=h?i:i[t]||(i[t]={}),_=m.prototype||(m.prototype={});h&&(n=t);for(c in n)l=!d&&b&&void 0!==b[c],f=(l?b:n)[c],p=g&&l?u(f,r):v&&"function"==typeof f?u(Function.call,f):f,b&&a(b,c,f,e&s.U),m[c]!=f&&o(m,c,p),v&&_[c]!=f&&(_[c]=f)};r.core=i,s.F=1,s.G=2,s.S=4,s.P=8,s.B=16,s.W=32,s.U=64,s.R=128,e.exports=s},function(e,t,n){var r=n(183),i=n(407),o=n(277),a=n(233)("IE_PROTO"),u=function(){},s=function(){var e,t=n(272)("iframe"),r=o.length;for(t.style.display="none",n(413).appendChild(t),t.src="javascript:",e=t.contentWindow.document,e.open(),e.write("<script>document.F=Object<\/script>"),e.close(),s=e.F;r--;)delete s.prototype[o[r]];return s()};e.exports=Object.create||function(e,t){var n;return null!==e?(u.prototype=r(e),n=new u,u.prototype=null,n[a]=e):n=s(),void 0===t?n:i(n,t)}},function(e,t,n){var r=n(231),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){var r=n(180);e.exports=function(e,t,n){for(var i in t)r(e,i,t[i],n);return e}},function(e,t){e.exports=function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!");return e}},function(e,t,n){var r=n(209),i=n(421),o=n(422),a=n(183),u=n(276),s=n(423),c={},l={},t=e.exports=function(e,t,n,f,p){var d,h,y,v,g=p?function(){return e}:s(e),b=r(n,f,t?2:1),m=0;if("function"!=typeof g)throw TypeError(e+" is not iterable!");if(o(g)){for(d=u(e.length);d>m;m++)if((v=t?b(a(h=e[m])[0],h[1]):b(e[m]))===c||v===l)return v}else for(y=g.call(e);!(h=y.next()).done;)if((v=i(y,b,h.value,t))===c||v===l)return v};t.BREAK=c,t.RETURN=l},function(e,t,n){var r=n(205)("meta"),i=n(175),o=n(177),a=n(182).f,u=0,s=Object.isExtensible||function(){return!0},c=!n(206)(function(){return s(Object.preventExtensions({}))}),l=function(e){a(e,r,{value:{i:"O"+ ++u,w:{}}})},f=function(e,t){if(!i(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!o(e,r)){if(!s(e))return"F";if(!t)return"E";l(e)}return e[r].i},p=function(e,t){if(!o(e,r)){if(!s(e))return!0;if(!t)return!1;l(e)}return e[r].w},d=function(e){return c&&h.NEED&&s(e)&&!o(e,r)&&l(e),e},h=e.exports={KEY:r,NEED:!1,fastKey:f,getWeak:p,onFreeze:d}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.CoverageReport=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(116),s=n(161);t.CoverageReport=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),a(t,[{key:"setUp",value:function(){this.analytics=s.AnalyticsService.get(this.context),this._yetTracked={},this._adunitsFound=0,this._bindMessages()}},{key:"_trackPageView",value:function(){this.analytics.trackPageview()}},{key:"_trackTemplateSelected",value:function(e){e.template?this._canTrack("template_found","")&&this.analytics.trackTemplateFound(e.template.name):this._canTrack("template_notfound","")&&this.analytics.trackTemplateNotFound()}},{key:"_trackAdunitRejected",value:function(e){var t=e.adunitModel.name;this._canTrack("adunit_rejected",t)&&this.analytics.trackAdunitRejected(t,e.reason)}},{key:"_trackAdUnitFound",value:function(e){var t=e.adunit.getModel().name;this._canTrack("adunit_found",t)&&(this.analytics.trackAdUnitFound(t),this._adunitsFound+=1)}},{key:"_trackAdUnitNotFound",value:function(e){var t=e.adunit_model.name;this._canTrack("adunit_notfound",t)&&this.analytics.trackAdUnitNotFound(t)}},{key:"_trackAdUnitView",value:function(e){var t=e.adunit.getModel().name;this._canTrack("adunit_view",t)&&this.analytics.trackAdUnitView(t)}},{key:"_bindMessages",value:function(){var e=this;this.context.subscribe({channel:"engine",topic:"run",callback:function(){e._trackPageView()}}),this.context.subscribe({channel:"template",topic:"selected",callback:function(t){e._trackTemplateSelected(t)}}),this.context.subscribe({channel:"adunit",topic:"found",callback:function(t){e._trackAdUnitFound(t)}}),this.context.subscribe({channel:"adunit",topic:"notfound",callback:function(t){e._trackAdUnitNotFound(t)}}),this.context.subscribe({channel:"adunit",topic:"view",callback:function(t){e._trackAdUnitView(t)}}),this.context.subscribe({channel:"adunit",topic:"reject",callback:function(t){e._trackAdunitRejected(t)}})}},{key:"_canTrack",value:function(e,t){var n=e+"-"+t,r=!1;return this._yetTracked[n]||(this._yetTracked[n]=r=!0),r}}]),t}(u.GohanComponent)},function(e,t,n){"use strict";(function(e){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.AnalyticsApi=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(27),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(o),u=n(202);t.AnalyticsApi=function(){function t(e){var n=this;r(this,t),this._debug=!1,this._events=[],this._debouncedCall=a.debounce(function(){return n._sendCall()},2e3,{maxWait:5e3}),this.baseUrl=e.analyticsApiUrl}return i(t,[{key:"trackEvent",value:function(t,n){var r=a.assign({name:t},n);return this._debug&&console.log("seedtag_gohan: event "+t,r),this._events.push(r),this._debouncedCall(),new e(function(e){e()})}},{key:"_sendCall",value:function(){var e={};if(this._events.length>1){var t=this._commonDiffProperties(this._events).common,n=a.map(this._events,function(e){return a.keys(t).forEach(function(t){return a.unset(e,t)}),e});e={events:a.clone(n)},a.keys(t).forEach(function(n){return e[n]=t[n]})}else e={events:a.clone(this._events)};this._events=[];var r=e,i=this.baseUrl+"/e";this._ajax("POST",i,r).then(function(){}).catch(function(e){console.warn(e)})}},{key:"_ajax",value:function(e,t,n){return(0,u.fetch)(e,t,n,{base64:!0})}},{key:"_setUpCallbacks",value:function(e,t,n){e.done(function(e,n,r){t(r)}),e.fail(function(e,t,r){console.warn(r),n(e)})}},{key:"_commonDiffProperties",value:function(e){var t=a.reduce(e,function(e,t){var n=e;return a.keys(t).forEach(function(e){n[e]=t[e]}),n},{}),n=a.reduce(e,function(e,n){return a.keys(t).forEach(function(r){t[r]!==n[r]&&(delete t[r],e.push(r))}),e},[]);return{common:t,different:n}}}]),t}()}).call(t,n(83))},function(e,t,n){var r=n(84);!function(e){e.Callbacks=function(t){t=e.extend({},t);var n,r,i,o,a,u,s=[],c=!t.once&&[],l=function(e){for(n=t.memory&&e,r=!0,u=o||0,o=0,a=s.length,i=!0;s&&u<a;++u)if(!1===s[u].apply(e[0],e[1])&&t.stopOnFalse){n=!1;break}i=!1,s&&(c?c.length&&l(c.shift()):n?s.length=0:f.disable())},f={add:function(){if(s){var r=s.length,u=function(n){e.each(n,function(e,n){"function"==typeof n?t.unique&&f.has(n)||s.push(n):n&&n.length&&"string"!=typeof n&&u(n)})};u(arguments),i?a=s.length:n&&(o=r,l(n))}return this},remove:function(){return s&&e.each(arguments,function(t,n){for(var r;(r=e.inArray(n,s,r))>-1;)s.splice(r,1),i&&(r<=a&&--a,r<=u&&--u)}),this},has:function(t){return!(!s||!(t?e.inArray(t,s)>-1:s.length))},empty:function(){return a=s.length=0,this},disable:function(){return s=c=n=void 0,this},disabled:function(){return!s},lock:function(){return c=void 0,n||f.disable(),this},locked:function(){return!c},fireWith:function(e,t){return!s||r&&!c||(t=t||[],t=[e,t.slice?t.slice():t],i?c.push(t):l(t)),this},fire:function(){return f.fireWith(this,arguments)},fired:function(){return!!r}};return f}}(r)},function(e,t,n){var r=n(84);!function(e){function t(n){var r=[["resolve","done",e.Callbacks({once:1,memory:1}),"resolved"],["reject","fail",e.Callbacks({once:1,memory:1}),"rejected"],["notify","progress",e.Callbacks({memory:1})]],i="pending",o={state:function(){return i},always:function(){return a.done(arguments).fail(arguments),this},then:function(){var n=arguments;return t(function(t){e.each(r,function(r,i){var u=e.isFunction(n[r])&&n[r];a[i[1]](function(){var n=u&&u.apply(this,arguments);if(n&&e.isFunction(n.promise))n.promise().done(t.resolve).fail(t.reject).progress(t.notify);else{var r=this===o?t.promise():this,a=u?[n]:arguments;t[i[0]+"With"](r,a)}})}),n=null}).promise()},promise:function(t){return null!=t?e.extend(t,o):o}},a={};return e.each(r,function(e,t){var n=t[2],u=t[3];o[t[1]]=n.add,u&&n.add(function(){i=u},r[1^e][2].disable,r[2][2].lock),a[t[0]]=function(){return a[t[0]+"With"](this===a?o:this,arguments),this},a[t[0]+"With"]=n.fireWith}),o.promise(a),n&&n.call(a,a),a}var n=Array.prototype.slice;e.when=function(r){var i,o,a,u=n.call(arguments),s=u.length,c=0,l=1!==s||r&&e.isFunction(r.promise)?s:0,f=1===l?r:t(),p=function(e,t,r){return function(o){t[e]=this,r[e]=arguments.length>1?n.call(arguments):o,r===i?f.notifyWith(t,r):--l||f.resolveWith(t,r)}};if(s>1)for(i=new Array(s),o=new Array(s),a=new Array(s);c<s;++c)u[c]&&e.isFunction(u[c].promise)?u[c].promise().done(p(c,a,u)).fail(f.reject).progress(p(c,o,i)):--l;return l||f.resolveWith(a,u),f.promise()},e.Deferred=t}(r)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=arguments,i=function(){return this},o=function e(t){return{get isLeft(){return!1},get isRight(){return!0},ap:function(e){return this.chain(function(t){return e.map(t)})},map:function(n){return e(n(t))},do:function(e){return e(t),this},chain:function(e){return e(t)},fold:function(e,n){return n(t)},concat:function(n){return n.fold(function(e){return n},function(n){return e(t.concat(n))})},withDefault:i,toString:function(){return"Right("+t+")"}}},a=function(e){return{get isLeft(){return!0},get isRight(){return!1},ap:i,map:i,do:i,chain:i,fold:function(t,n){return t(e)},concat:i,withDefault:function(e){return this.isLeft?o(e):this},toString:function(){return"Left("+e+")"}}},u=function(e){return e?o(e):a(void 0)},s=function(e){try{return o(e.apply(null,r))}catch(e){return a(e)}};t.Either={Right:o,Left:a,fromNullable:u,tryCatch:s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.taskFromMaybe=t.taskFromResult=t.maybeFromResult=void 0;var r=n(264),i=n(111);t.maybeFromResult=function(e){return e.fold(function(){return i.Maybe.Nothing()},function(e){return i.Maybe.Just(e)})},t.taskFromResult=function(e){return e.fold(function(e){return r.Task.rejected(e)},function(e){return r.Task.of(e)})},t.taskFromMaybe=function(e){return e.fold(function(e){return e?r.Task.of(e):r.Task.rejected(void 0)})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.concat=t.Do=t.fold=t.chain=t.find=t.map=t.equals=t.compose=void 0;var r=n(128),i=function(e){return e&&e.__esModule?e:{default:e}}(r);t.compose=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return i.default.reduce(t.reverse(),function(e,t){return t(e)},e)}},t.equals=function(e){return function(t){return""+e==""+t}},t.map=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return e.map.apply(e,t)}},t.find=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return e.find.apply(e,t)}},t.chain=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return e.chain.apply(e,t)}},t.fold=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return e.fold.apply(e,t)}},t.Do=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return e.do.apply(e,t)}},t.concat=function(e){return function(t){return e.concat(t)}}},function(e,t,n){"use strict";function r(e,t){return t.map(e)}function i(e,t,n){return t.map(e).ap(n)}function o(e,t,n,r){return t.map(e).ap(n).ap(r)}function a(e,t,n,r,i){return t.map(e).ap(n).ap(r).ap(i)}function u(e,t,n,r,i,o){return t.map(e).ap(n).ap(r).ap(i).ap(o)}function s(e,t,n,r,i,o,a){return t.map(e).ap(n).ap(r).ap(i).ap(o).ap(a)}function c(e,t,n,r,i,o,a,u){return t.map(e).ap(n).ap(r).ap(i).ap(o).ap(a).ap(u)}function l(e,t,n,r,i,o,a,u,s){return t.map(e).ap(n).ap(r).ap(i).ap(o).ap(a).ap(u).ap(s)}Object.defineProperty(t,"__esModule",{value:!0}),t.lift=r,t.liftA2=i,t.liftA3=o,t.liftA4=a,t.liftA5=u,t.liftA6=s,t.liftA7=c,t.liftA8=l},function(e,t,n){"use strict";(function(e){function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ViewabilityReport=void 0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(117),l=r(c),f=n(27),p=r(f),d=n(116),h=n(161),y=n(174),v=n(203),g=n(364),b=n(365),m=n(265),_=v.Maybe.Nothing,A=v.Maybe.Just,w=t.ViewabilityReport=function(t){function n(){o(this,n);var e=a(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments));return e.viewabilityProcesses={},e}return u(n,t),s(n,[{key:"setUp",value:function(){this.analytics=h.AnalyticsService.get(this.context)}},{key:"viewabilityTrackProcess",value:e.mark(function t(){var r,o,a,u,s,c,f,p,d,v,w,k=this;return e.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(Math.random()<.95)){t.next=3;break}return n.clock.stop(),t.abrupt("return");case 3:return t.next=5,y.EventProcess.receive("ad-request");case 5:return r=t.sent,o=r.data.adunit.getTagged()[0],a=new h.TimelineDeltaRef,u=function(){return A((0,b.samplerByTimeAndElement)(a)(o))},s=(0,b.makeFolder)("request",n.clock.getDeltaTime()),c={request:_(),insert:_(),ready:_(),enterViewport:_(),exitViewport:_(),IAB:_()},c.request=u(),t.next=14,y.EventProcess.receive("insert");case 14:return f=t.sent,p=f.data,c.insert=u(),p.ad.model.isCsm()||this.track("insert",p,s(c)),t.next=20,y.EventProcess.receive("ready");case 20:p.ad.model.isCsm()&&this.track("insert",p,s(c)),c.ready=u(),this.track("ready",p,s(c)),d=!1;case 24:if(d){t.next=39;break}return t.next=27,y.EventProcess.receive(g.PossibleEvents.ENTER_VIEWPORT);case 27:return c.enterViewport=u(),this.track("enter-viewport",p,s(c)),w="exit",t.next=32,y.EventProcess.race((v={},i(v,g.PossibleEvents.EXIT_VIEWPORT,m.noop),i(v,g.PossibleEvents.ONE_SECOND_ELAPSED,function(){return l.__awaiter(k,void 0,void 0,e.mark(function t(){return e.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:w="iab",c.IAB=u(),this.track("iab",p,s(c)),this.trackViewability("ad-viewability",p),d=!0;case 5:case"end":return e.stop()}},t,this)}))}),v));case 32:if("iab"!==w){t.next=35;break}return t.next=35,y.EventProcess.receive(g.PossibleEvents.EXIT_VIEWPORT);case 35:c.exitViewport=u(),this.track("exit-viewport",p,s(c)),t.next=24;break;case 39:case"end":return t.stop()}},t,this)})},{key:"onAdserverAdRequest",value:function(e){this.runViewabilityProcess("ad-request",e)}},{key:"onAnyAdMessage",value:function(e,t){var n=t.topic.replace(/\./g,"-");this.runViewabilityProcess(n,e)}},{key:"runViewabilityProcess",value:function(e,t){var n=this,r=t.adunit.model.name||"";this.viewabilityProcesses[r]||(this.viewabilityProcesses[r]=new y.EventProcess(this.viewabilityTrackProcess,this)),this.viewabilityProcesses[r].run({message:e,data:t}),e===g.PossibleEvents.ENTER_VIEWPORT&&setTimeout(function(){n.viewabilityProcesses[r].run({message:g.PossibleEvents.ONE_SECOND_ELAPSED,data:{}})},1e3)}},{key:"trackViewability",value:function(e,t){var n={adUnitName:p.get(t.adunit.getModel(),"name","-"),campaignId:p.get(t.ad.apn_data,"CP_ID","-"),source:t.ad.model.getSourceName()};this.analytics.singleTrack(e+n.adUnitName,e,n)}},{key:"track",value:function(e,t,n){var r=/'CP_ID' : '(.*)'/.exec(t.ad.model.content),i=r?r[1]:"-";n.adUnitName=p.get(t.adunit.getModel(),"name","-"),n.source=t.ad.model.getSourceName(),"18089039"===i&&(n.campaignId=i),this.analytics.singleTrack(e+n.adUnitName,"viewability-"+e,n)}}]),n}(d.GohanComponent);w.clock=new h.Clock(500),l.__decorate([(0,d.Subscribe)("adserver","ad.request"),l.__metadata("design:type",Function),l.__metadata("design:paramtypes",[Object]),l.__metadata("design:returntype",void 0)],w.prototype,"onAdserverAdRequest",null),l.__decorate([(0,d.Subscribe)("ad","#"),l.__metadata("design:type",Function),l.__metadata("design:paramtypes",[Object,Object]),l.__metadata("design:returntype",void 0)],w.prototype,"onAnyAdMessage",null)}).call(t,n(118))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=t.PossibleEvents=void 0;!function(e){e.ONE_SECOND_ELAPSED="1s-elapsed",e.ENTER_VIEWPORT="enter-viewport",e.EXIT_VIEWPORT="exit-viewport"}(r||(t.PossibleEvents=r={}))},function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){return function(n){return o(n,e,t)}}function o(e,t,n){function i(e){var r=(0,c.createArrayNormalizer)([1e3,3e3,5e3,1e4]);return e[t+"Time"]=r(n),e}var o=function(e){return function(t){var n;return n={},r(n,e+"Time",p(t.time)),r(n,e+"Position",d(t.viewportPosition).toString()),n}},a=function(e,t){return t.withDefault({time:0,viewportPosition:0}).map(o(e)).fold(function(e){return e})},l=u.keys(e).map(function(t){var n=e[t]||s.Maybe.Nothing();return a(t,n)});return(0,s.compose)(i,f)(l)}Object.defineProperty(t,"__esModule",{value:!0}),t.samplerByTimeAndElement=t.foldObjects=t.objectMonoid=void 0,t.makeFolder=i;var a=n(27),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(a),s=n(203),c=n(204),l=t.objectMonoid={empty:function(){return{}},append:function(e,t){return u.assign(e,t)}},f=t.foldObjects=function(e){return u.reduce(e,l.append,l.empty())},p=(t.samplerByTimeAndElement=function(e){return function(t){var n=window,r=n.innerHeight,i=(n.innerWidth,t.getBoundingClientRect()),o=(i.top+i.height/2)/r;return e.updateRef(),{time:e.getDelta(),viewportPosition:o}}},(0,c.createArrayNormalizer)([500,1e3,2e3,3e3])),d=(0,c.createArrayNormalizer)([-.25,0,.25,.5,.75,1])},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.AdReport=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(117),c=r(s),l=n(27),f=r(l),p=n(116),d=n(161),h=["insert","ready","view","image_hover","hover","xtocloseclick"],y=["ad-insert","ad-ready","ad-view"],v=t.AdReport=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),u(t,[{key:"setUp",value:function(){this.analytics=d.AnalyticsService.get(this.context)}},{key:"onAnyAdMessage",value:function(e,t){var n=t.topic.replace(/\./g,"-"),r="ad-"+n;f.includes(h,n)&&this.track(r,e)}},{key:"enhanceWithDeltaTime",value:function(e){var t=this.analytics.getTimelineRef(e.adUnitName);e.timeDelta=t.getDelta()<2e3?t.getDelta():2e3,t.updateRef()}},{key:"track",value:function(e,t){var n={adUnitName:f.get(t.adunit.getModel(),"name","-"),campaignId:f.get(t.apn_data,"CP_ID","-"),source:t.ad.model.getSourceName()};-1!==y.indexOf(e)&&this.enhanceWithDeltaTime(n),this.analytics.singleTrack(e+n.adUnitName,e,n)}}]),t}(p.GohanComponent);c.__decorate([(0,p.Subscribe)("ad","#"),c.__metadata("design:type",Function),c.__metadata("design:paramtypes",[Object,Object]),c.__metadata("design:returntype",void 0)],v.prototype,"onAnyAdMessage",null)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.BidderReport=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(117),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(u),c=n(116),l=n(161),f=n(122),p=function(e,t,n){var r=e-e%t;return r=r<0?0:r,r>n?n:r},d=t.BidderReport=function(e){function t(){r(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.adResolvedReported=!1,e}return o(t,e),a(t,[{key:"setUp",value:function(){this.analytics=l.AnalyticsService.get(this.context)}},{key:"onBidderRequest",value:function(e){this.analytics.track("bidder-request",{source:e.source,adUnitName:e.adunit.name,network:e.network,waterfallStep:e.step})}},{key:"onBidderResponse",value:function(e){if(this.analytics.track("bidder-response",{source:e.source,videoKind:e.videoKind,adUnitName:e.adunit.name,network:e.network,status:e.status,time:p(e.time,250,3e3),waterfallStep:e.step}),"ad"===e.status){var t={source:e.source,campaignId:e.network,adUnitName:e.adunit.name||""};this.analytics.singleTrack(t.adUnitName,"ad-resolved",t),this.adResolvedReported||(this.publishAdResolved(t),this.adResolvedReported=!0)}}},{key:"onAdServerWinner",value:function(e){this.analytics.track("bidder-winner",e)}},{key:"publishAdResolved",value:function(e){return e}},{key:"onAdserverReady",value:function(){this.analytics.track(l.AnalyticsService.ADSERVER_READY)}},{key:"onAdserveNotrReady",value:function(){this.analytics.track(l.AnalyticsService.ADSERVER_NOT_READY)}},{key:"onAdserverAdRequest",value:function(e){var t={adUnitName:e.adunit.getModel().name};this.analytics.singleTrack(t.adUnitName,"ad-request",t)}}]),t}(c.GohanComponent);s.__decorate([(0,c.Subscribe)("bidder","request"),s.__metadata("design:type",Function),s.__metadata("design:paramtypes",[Object]),s.__metadata("design:returntype",void 0)],d.prototype,"onBidderRequest",null),s.__decorate([(0,c.Subscribe)("bidder","response"),s.__metadata("design:type",Function),s.__metadata("design:paramtypes",[Object]),s.__metadata("design:returntype",void 0)],d.prototype,"onBidderResponse",null),s.__decorate([(0,c.Subscribe)("adapter.networks","winner"),s.__metadata("design:type",Function),s.__metadata("design:paramtypes",[Object]),s.__metadata("design:returntype",void 0)],d.prototype,"onAdServerWinner",null),s.__decorate([(0,f.Publish)("bidder","resolved"),s.__metadata("design:type",Function),s.__metadata("design:paramtypes",[Object]),s.__metadata("design:returntype",void 0)],d.prototype,"publishAdResolved",null),s.__decorate([(0,c.Subscribe)("adserver","ready"),s.__metadata("design:type",Function),s.__metadata("design:paramtypes",[]),s.__metadata("design:returntype",void 0)],d.prototype,"onAdserverReady",null),s.__decorate([(0,c.Subscribe)("adserver","not-ready"),s.__metadata("design:type",Function),s.__metadata("design:paramtypes",[]),s.__metadata("design:returntype",void 0)],d.prototype,"onAdserveNotrReady",null),s.__decorate([(0,c.Subscribe)("adserver","ad.request"),s.__metadata("design:type",Function),s.__metadata("design:paramtypes",[Object]),s.__metadata("design:returntype",void 0)],d.prototype,"onAdserverAdRequest",null)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){var t="";return p.forEach(d,function(n){e<n.length&&(t=n.size)}),t}function u(e,t){return e>t?"L":"P"}Object.defineProperty(t,"__esModule",{value:!0}),t.InventoryReport=void 0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(116),l=n(161),f=n(27),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(f),d=[{size:"S",length:200},{size:"M",length:400},{size:"L",length:99999}];t.InventoryReport=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),s(t,[{key:"setUp",value:function(){this.tracked={},this.analytics=l.AnalyticsService.get(this.context),this.category="-",this._bindMessages()}},{key:"getEventData",value:function(e){var t=e.getImageSize(),n=a(t.x>t.y?t.x:t.y),r=u(t.x,t.y);return{adUnitName:e.getModel().name,category:this.category,subcategory:this.subcategory,size:r+"_"+n}}},{key:"_bindMessages",value:function(){var e=this;this.context.subscribe({channel:"config",topic:"received",callback:function(t){var n=p.get(t,"config.url.contextualization.contextData");e.category=p.get(n,"categories[0]","-"),e.subcategory=p.get(n,"subcategories[0]","-")}}),this.context.subscribe({channel:"adunit",topic:"view",callback:function(t){e.canTrack("inventory",t.adunit.getModel().name)&&e.analytics.track("inventory",e.getEventData(t.adunit))}})}},{key:"canTrack",value:function(e,t){var n=e+"-"+t,r=this.tracked,i=!1;return r[n]||(r[n]=i=!0),i}}]),t}(c.GohanComponent)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ContentReport=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(116),s=n(161),c=n(27),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(c);t.ContentReport=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),a(t,[{key:"setUp",value:function(){this.analytics=s.AnalyticsService.get(this.context),this._yetTracked=!1,this.templateType=null,this._bindMessages()}},{key:"_track",value:function(e){this.analytics.track(e,{templateType:this.templateType,contextualizationStatus:this.contextualizationStatus})}},{key:"_bindMessages",value:function(){var e=this;this.context.subscribe({channel:"config",topic:"received",callback:function(t){e.contextualizationStatus=l.get(t,"config.url.contextualization.status")}}),this.context.subscribe({channel:"template",topic:"selected",callback:function(t){e.templateType=l.get(t,"template.type")}}),this.context.subscribe({channel:"sherlock",topic:"content",callback:function(t){if(!e._yetTracked){e._yetTracked=!0;var n=t.hasContent?"content-found":"content-not-found";e._track(n)}}})}}]),t}(u.GohanComponent)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.VideoReport=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(117),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(u),c=n(27),l=n(116),f=n(161),p=n(204),d=(0,p.createArrayNormalizer)([0,240,360,480,500]),h={240:"S",360:"M",480:"L",500:"XL"},y=function(e){return h[d(e)]},v="video-",g={match:[v+"error",v+"ready",v+"loaded",v+"tryPlay",v+"notReadyToTryPlay",v+"play",v+"end",v+"cpv"],startsWith:[v+"played-time-",v+"played-percentile-",v+"played-decile-",v+"skip-duration-"]},b=function(e){return-1!==g.match.indexOf(e)||0!==(0,c.filter)((0,c.map)(g.startsWith,function(t){return 0===e.indexOf(t)}),Boolean).length},m=t.VideoReport=function(e){function t(){r(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.tracked={},e}return o(t,e),a(t,[{key:"setUp",value:function(){this.analytics=f.AnalyticsService.get(this.context)}},{key:"onCreativeMessage",value:function(e){this.trackEvent(e)}},{key:"trackEvent",value:function(e){var t=e.message.replace(/_/g,"-");0===t.indexOf("video-")&&b(t)&&this.track(t,e)}},{key:"track",value:function(e,t){var n=(t.adunit.getImageSize(),function(e){var t={unknown:-1,"ad tag empty":1100,"error playing creative":1101,"error loading ad tag":1102,"invalid ad tag":1103,"no compatible creatives":1104};return t[e]?t[e]:t.unknown}),r={adUnitName:t.adunit.getModel().name,campaignId:t.apn_data.CP_ID,duration:t.duration||"-",source:t.ad.model.getSourceName(),playerSize:y(t.adunit.getImageSize().x),errorCode:n((0,c.get)(t,"data.errorMessage","-")),player:n((0,c.get)(t,"data.player","-"))};this.analytics.singleTrack(e+r.adUnitName,e,r)}}]),t}(l.GohanComponent);s.__decorate([(0,l.Subscribe)("creative","message"),s.__metadata("design:type",Function),s.__metadata("design:paramtypes",[Object]),s.__metadata("design:returntype",void 0)],m.prototype,"onCreativeMessage",null)},function(e,t,n){"use strict";(function(e){function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.TimesReport=t.Events=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(117),c=r(s),l=n(174),f=n(161),p=n(204),d=n(121),h=n(161),y=n(116),v=n(27),g=r(v),b=n(265),m=n(131),_={seedtagStartTime:0,engineBootTime:0,configReceiveTime:0,adUnitFoundTime:0,adRequestTime:0,adReadyTime:0},A=(0,p.createArrayNormalizer)([5e3,1e4,15e3,2e4]),w=(0,p.createArrayNormalizer)([100,250,500,1e3]),k=(0,p.createArrayNormalizer)([200,500,1e3,2e3,5e3]),O=(0,p.createArrayNormalizer)([100,200,500,1e3,3e3]),j=(0,p.createArrayNormalizer)([100,200,400,800,1500,3e3]),T=(0,p.createArrayNormalizer)([500,1e3,3e3,5e3,8e3,1e4]),x=t.Events=void 0;!function(e){e.SEEDTAG_START="seedtag-start",e.ENGINE_RUN="engine-init",e.CONFIG_RECEIVE="config-receive",e.ADUNIT_FOUND="adunit-found",e.AD_REQUEST="ad-request",e.AD_READY="ad-ready"}(x||(t.Events=x={}));var E=t.TimesReport=function(t){function n(){i(this,n);var e=o(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments));return e.timeProcesses={},e}return a(n,t),u(n,[{key:"getEventData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return g.assign({},_,this.globalEventData,e)}},{key:"setUp",value:function(){this.analytics=h.AnalyticsService.get(this.context),this.shouldTrack=Math.random()>=.99,this.globalEventData={},this.globalTimelineRef=new f.TimelineDeltaRef,this.globalUid=(0,b.guid)(),this.globalEventData.seedtagStartTime=A(m.stBootTime||0),this.track(this.globalUid,x.SEEDTAG_START,this.getEventData()),this.globalTimelineRef.updateRef()}},{key:"onAnyAdMessage",value:function(e,t){var n=t.topic.replace(/\./g,"-");"ready"==n&&this.runTimeProcess(n,e)}},{key:"onAdRequest",value:function(e){this.runTimeProcess("request",e)}},{key:"onEngineRun",value:function(){this.globalEventData.engineBootTime=w(this.globalTimelineRef.getDelta()),this.track(this.globalUid,x.ENGINE_RUN,this.getEventData()),this.globalTimelineRef.updateRef()}},{key:"onConfigReceived",value:function(){this.globalEventData.configReceiveTime=k(this.globalTimelineRef.getDelta()),this.track(this.globalUid,x.CONFIG_RECEIVE,this.getEventData()),this.globalTimelineRef.updateRef()}},{key:"onAdunitFound",value:function(e){this.globalEventData.adUnitFoundTime=O(this.globalTimelineRef.getDelta()),this.track(this.globalUid,x.ADUNIT_FOUND,this.getEventData()),this.globalTimelineRef.updateRef(),this.runTimeProcess("start-time-process",e)}},{key:"runTimeProcess",value:function(e,t){var n=t.adunit.model.name||"";this.timeProcesses[n]||(this.timeProcesses[n]=new l.EventProcess(this.timeProc,this)),this.timeProcesses[n].run({message:e,data:t})}},{key:"timeProc",value:e.mark(function t(){var n,r,i,o,a;return e.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.EventProcess.receive("start-time-process");case 2:return n=(0,b.guid)(),r=new f.TimelineDeltaRef,i=this.getEventData(),e.next=7,l.EventProcess.receive("request");case 7:return o=e.sent,i.adRequestTime=j(r.getDelta()),i.adUnitName=o.data.adunit.model.name,r.updateRef(),this.track(n,x.AD_REQUEST,i),e.next=14,l.EventProcess.receive("ready");case 14:a=e.sent,i.adReadyTime=T(r.getDelta()),i.network=a.data.ad.model.network,this.track(n,x.AD_READY,i);case 18:case"end":return e.stop()}},t,this)})},{key:"track",value:function(e,t,n){this.shouldTrack&&this.analytics.singleTrack(e,"times-"+t,n)}}]),n}(d.GohanComponent);c.__decorate([(0,y.Subscribe)("ad","#"),c.__metadata("design:type",Function),c.__metadata("design:paramtypes",[Object,Object]),c.__metadata("design:returntype",void 0)],E.prototype,"onAnyAdMessage",null),c.__decorate([(0,y.Subscribe)("adserver","ad.request"),c.__metadata("design:type",Function),c.__metadata("design:paramtypes",[Object]),c.__metadata("design:returntype",void 0)],E.prototype,"onAdRequest",null),c.__decorate([(0,y.Subscribe)("engine","run"),c.__metadata("design:type",Function),c.__metadata("design:paramtypes",[]),c.__metadata("design:returntype",void 0)],E.prototype,"onEngineRun",null),c.__decorate([(0,y.Subscribe)("config","received"),c.__metadata("design:type",Function),c.__metadata("design:paramtypes",[]),c.__metadata("design:returntype",void 0)],E.prototype,"onConfigReceived",null),c.__decorate([(0,y.Subscribe)("adunit","found"),c.__metadata("design:type",Function),c.__metadata("design:paramtypes",[Object]),c.__metadata("design:returntype",void 0)],E.prototype,"onAdunitFound",null)}).call(t,n(118))},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.QuantcastService=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(117),c=r(s),l=n(27),f=r(l),p=n(116),d=n(113),h=n(112),y=["GB"],v=t.QuantcastService=function(e){function t(){i(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.logger=new d.Logger("QuantcastService"),e}return a(t,e),u(t,[{key:"setUp",value:function(){}},{key:"onConfigRecieved",value:function(e){if(e.config.publisher&&e.config.publisher.country){var t=e.config.publisher.country;if(y.indexOf(t)>=0)return;this.makeSegment(e.config);try{"FR"===t&&this.setupQuantcastCookie(!0)}catch(e){this.logger.error("Unable to setup quantcast cookie")}}else h.ErrorHandler.trackError(new Error("\n        QuantcastService: Error happened trying to access config.publisher.country\n        received config: "+JSON.stringify(e.config)+"\n      "))}},{key:"subCookieRequest",value:function(){this.resolveCookie()}},{key:"resolveCookie",value:function(){return this.quantCastCookie}},{key:"subToTargeting",value:function(e){this.quantCastCookie&&this.publishQuantcastTargeting(e.adunit)}},{key:"publishQuantcastTargeting",value:function(e){return{page:{user_segment:this.quantCastCookie.split(",")}}}},{key:"makeSegment",value:function(e){var t=f.get(e.url,"contextualization.contextData.categories",["-"]);this.quantCastCookie=e.qcc,this.callCode({categories:t})}},{key:"callCode",value:function(e){window._qevents=window._qevents||[],window._qevents.push({qacct:"p-PFW5FesqXn206",event:"refresh",labels:e.categories.join(",")||"-"});var t=document.createElement("script"),n=document.getElementsByTagName("script")[0],r=n.parentNode,i="https:"===document.location.protocol?"https://secure":"http://edge";i+=".quantserve.com/quant.js",t.src=i,t.async=!0,t.type="text/javascript",r&&r.insertBefore(t,n)}},{key:"setupQuantcastCookie",value:function(e){if(e)this.logger.log("Quantcast cookie is present");else{this.logger.log("Quantcast cookie is not present");var t=document.createElement("iframe");t.src=n(373)+"?cache_buster="+Date.now()+(/__SEEDTAG_LOGGER__=true/.test(window.location.hash)?"#?__SEEDTAG_LOGGER__=true":""),t.frameBorder="0",t.width="0px",t.height="0px",document.body.appendChild(t),this.logger.log("Quantcast iframe url is "+t.src)}}}]),t}(p.GohanComponent);c.__decorate([(0,p.Subscribe)("config","received"),c.__metadata("design:type",Function),c.__metadata("design:paramtypes",[Object]),c.__metadata("design:returntype",void 0)],v.prototype,"onConfigRecieved",null),c.__decorate([(0,p.Subscribe)("quantcast","cookie.request"),c.__metadata("design:type",Function),c.__metadata("design:paramtypes",[]),c.__metadata("design:returntype",void 0)],v.prototype,"subCookieRequest",null),c.__decorate([(0,p.Publish)("quantcast","cookie.resolve"),c.__metadata("design:type",Function),c.__metadata("design:paramtypes",[]),c.__metadata("design:returntype",void 0)],v.prototype,"resolveCookie",null),c.__decorate([(0,p.Subscribe)("targeting","request"),c.__metadata("design:type",Function),c.__metadata("design:paramtypes",[Object]),c.__metadata("design:returntype",void 0)],v.prototype,"subToTargeting",null),c.__decorate([(0,p.Publish)("targeting","resolve"),c.__metadata("design:type",Function),c.__metadata("design:paramtypes",[Object]),c.__metadata("design:returntype",void 0)],v.prototype,"publishQuantcastTargeting",null)},function(e,t,n){e.exports=n.p+"quantcast_iframe.html"},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.PiwikService=void 0;var i=n(113);t.PiwikService=function e(t){if(r(this,e),this.logger=new i.Logger("PiwikService"),"9597-8308-01"===t.config.token){window._paq||(window._paq=[]);var n=window._paq;n.push(["trackPageView"]),n.push(["enableLinkTracking"]);var o="//seedtag.piwikpro.com/";n.push(["setTrackerUrl",o+"piwik.php"]),n.push(["setSiteId",1]);var a=document.createElement("script"),u=document.getElementsByTagName("script")[0];a.type="text/javascript",a.async=!0,a.defer=!0,a.src=o+"piwik.js",u.parentNode&&(this.logger.info("Enabling Piwik with "+a.outerHTML),u.parentNode.insertBefore(a,u))}}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.EvaluableService=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(116),s=n(376),c=n(377),l=n(27),f=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(l);t.EvaluableService=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),a(t,[{key:"setUp",value:function(){var e=this,t=this.context;this.library=new s.Library,t.subscribe({channel:"features",topic:"response",callback:function(t){e.library.sizeLimits=f.get(t,"features.sizeLimits.value")}}),t.set("factory.evaluable",this.getEvaluable.bind(this))}},{key:"getEvaluable",value:function(e){return new c.EvaluableJs(e,{environment:{lib:this.getLibrary()}})}},{key:"getLibrary",value:function(){return this.library.getMethods()}}]),t}(u.GohanComponent)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){return e.toString().toLowerCase().replace(/[àáâãäå]/g,"a").replace(/[èéêë]/g,"e").replace(/[ìíîï]/g,"i").replace(/[òóôõö]/g,"o").replace(/[ùúûü]/g,"u").replace(/ç/g,"c").replace(/ñ/g,"ny").replace(/['"”]+/g,"").replace(/[^a-z0-9 ]/g," ").replace(/ +/g," ")}Object.defineProperty(t,"__esModule",{value:!0}),t.Library=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(229),u=n(110),s=n(27),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(s);t.Library=function(){function e(){r(this,e),this.sizeLimits={},this.publicMethods=["select","textMatch","getDevice"]}return o(e,[{key:"getMethods",value:function(){var e=this,t=[];return c.forEach(this.publicMethods,function(n){t[n]=e[n].bind(e)}),t}},{key:"select",value:function(e,t){var n=this.sizeLimits;return t&&(n={handheld:{min:{w:t,h:0}},desktop:{min:{w:t,h:0}}}),c.filter(document.querySelectorAll(e),function(e){return(0,a.hasProperSize)(e,n)})}},{key:"textMatch",value:function(e,t,n){var r=[window.location.pathname,this.getText(t)];return!!this.getRegex(c.map(n,i)).test(r.join(" "))&&e}},{key:"getDevice",value:function(){return u.detector.getDevice()}},{key:"getText",value:function(e){var t="";return e&&e.length>0&&c.forEach(document.querySelectorAll(e.join(",")),function(e){t+=" "+e.textContent}),i(t)}},{key:"getRegex",value:function(e){return new RegExp("("+e.join("|")+")")}}]),e}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.EvaluableJs=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(27),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(u),c=n(378);t.EvaluableJs=function(e){function t(e,n){r(this,t);var o=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return o._expression=e.expression,o}return o(t,e),a(t,[{key:"evaluate",value:function(e){return this._performEvaluate(this._buildFunction(),e)}},{key:"_buildFunction",value:function(){return new Function("environment","lib",this._expression)}},{key:"_performEvaluate",value:function(e,t){var n={};this.args.environment&&(n=s.assign(n,this.args.environment)),n=s.assign(n,t);var r=null;try{r=e(n,n.lib)}catch(e){throw new c.EvaluatingError("Evaluable evaluation error: "+e.message)}return r}}]),t}(c.Evaluable)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.EvaluatingError=function(e){function t(e){r(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.name="EvaluatingError",n}return o(t,e),t}(Error),t.Evaluable=function e(t,n){r(this,e),this._expression=t.expression,this._parameters=t.parameters||{},this.args=n||{}}},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.TemplateLocator=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(117),c=r(s),l=n(116),f=n(380),p=n(27),d=r(p),h=t.TemplateLocator=function(e){function t(){i(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.adserverReady=!1,e.isAdmin=!1,e.runned=!1,e}return a(t,e),u(t,[{key:"publishTemplate",value:function(e){return e}},{key:"onAdserverReady",value:function(e){this.adserverReady=!0,this.run()}},{key:"onAdminRun",value:function(){this.isAdmin=!0,this.run()}},{key:"onConfigReceived",value:function(e){e.config.templates&&(this.config=e.config,this.run())}},{key:"canRun",value:function(){return this.config&&(this.adserverReady||this.isAdmin)}},{key:"setUp",value:function(){}},{key:"run",value:function(){if(!this.runned&&this.canRun()){this.runned=!0;var e=this.select({href:document.location.href},this.config.templates);this.publishTemplate({template:e,config:this.config})}}},{key:"select",value:function(e,t){var n=this,r=null,i=t.sort(function(e,t){return(t.priority||0)-(e.priority||0)});return d.forEach(i,function(t){var i=!0,o=n.context.get("factory.evaluable")(t.condition);try{o.evaluate(e)&&(r=new f.TemplateModel(t),i=!1)}catch(e){console.error("seedtag evaluating error",e)}return i}),r}}]),t}(l.GohanComponent);c.__decorate([(0,l.Publish)("template","selected"),c.__metadata("design:type",Function),c.__metadata("design:paramtypes",[Object]),c.__metadata("design:returntype",void 0)],h.prototype,"publishTemplate",null),c.__decorate([(0,l.Subscribe)("adserver","ready"),c.__metadata("design:type",Function),c.__metadata("design:paramtypes",[Object]),c.__metadata("design:returntype",void 0)],h.prototype,"onAdserverReady",null),c.__decorate([(0,l.Subscribe)("admin","run"),c.__metadata("design:type",Function),c.__metadata("design:paramtypes",[]),c.__metadata("design:returntype",void 0)],h.prototype,"onAdminRun",null),c.__decorate([(0,l.Subscribe)("config","received"),c.__metadata("design:type",Function),c.__metadata("design:paramtypes",[Object]),c.__metadata("design:returntype",void 0)],h.prototype,"onConfigReceived",null)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.TemplateModel=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(200),a=n(201),u=n(27),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(u);t.TemplateModel=function(){function e(t){r(this,e);var n=t||{};this.id=n.id,this.category=t.category,this.type=t.type,this.name=n.name,this.condition=n.condition,this.adUnits=[],this.variables=[],t.variables&&this.setVariables(t.variables),t.adUnits&&this.setAdUnits(t.adUnits)}return i(e,[{key:"setAdUnits",value:function(e){var t=this;s.forEach(e,function(e){t.adUnits.push(new o.AdUnitModel(e))})}},{key:"getAdUnits",value:function(){return this.adUnits}},{key:"setVariables",value:function(e){var t=this;s.forEach(e,function(e){t.variables.push(new a.VariableModel(e))})}},{key:"getVariables",value:function(){return this.variables}}]),e}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.AdUnitLocator=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(116),s=n(229),c=n(382),l=n(267),f=n(383),p=n(27),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(p);t.AdUnitLocator=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),a(t,[{key:"setUp",value:function(){this.images=[],this.isAdmin=!1,this.sizeLimits=null,this.mustCreateAdunit=!0,this._bindMessages()}},{key:"_bindMessages",value:function(){var e=this,t=this.context;t.subscribe({channel:"user",topic:"detected",callback:function(t){e.isAdmin=-1!==t.user.permissions.indexOf("admin")}}),t.subscribe({channel:"template",topic:"selected",callback:function(t){var n=t.template;t.config.url&&(e.images=t.config.url.images||[]),n&&e._find(n)}}),t.subscribe({channel:"features",topic:"response",callback:function(t){e.sizeLimits=d.get(t,"features.sizeLimits.value")||{}}}),t.subscribe({channel:"passback",topic:"activated",callback:function(){e.mustCreateAdunit=!1}})}},{key:"_find",value:function(e){this.locateStrategy=this._strategyGet(e),this.locateStrategy.findAdUnits(this.onLocate.bind(this))}},{key:"onLocate",value:function(e){if(this.mustCreateAdunit){var t=e.model;if((0,s.hasProperSize)(e.element,this.sizeLimits)){var n=this.locateStrategy.createAdUnit(e.element,t);this.context.publish({channel:"adunit",topic:"found",data:{adunit:n}}),n.onInsert()}else this.locateStrategy.retry&&this.locateStrategy.retry(t),this.context.publish({channel:"adunit",topic:"reject",data:{adunitModel:t,reason:"size"}})}}},{key:"_strategyGet",value:function(e){var t=e.getAdUnits(),n=this.getTaggingStrategy(e);return new n(this.context,{adUnits:t,images:this.images,sizeLimits:this.sizeLimits,enableAdRequests:n!==l.AllImagesStrategy})}},{key:"getTaggingStrategy",value:function(e){var t=c.TemplateStrategy;return"homepage"===e.type&&(t=this.isAdmin?l.AllImagesStrategy:f.SherlockStrategy),t}}]),t}(u.GohanComponent)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.TemplateStrategy=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(27),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(u),c=n(266);t.TemplateStrategy=function(e){function t(e,n){r(this,t);var o=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return o.loops=0,o.adUnits=o.options.adUnits,o.elements=[],o.evaluableFactory=o.context.get("factory.evaluable"),o.notFoundTimes=0,o}return o(t,e),a(t,[{key:"retry",value:function(e){this.adUnits.push(e)}},{key:"_find",value:function(){var e=this,t=[],n=[];s.forEach(this.adUnits,function(r,i){var o=null;try{o=e.evaluableFactory(r.evaluable).evaluate(document.body)}catch(e){console.log(e,r),t.push(i)}o&&-1===e.elements.indexOf(o)?(e.elements.push(o),t.push(i),e.callback&&e.callback({element:o,model:r})):n.push(r)}),t.reverse(),s.forEach(t,function(t){e.adUnits.splice(t,1)}),this._reportNotFound(n),this.loops++,this.adUnits.length&&this._findLoop()}},{key:"_reportNotFound",value:function(e){var t=this;this.notFoundTimes>5||(s.forEach(e,function(e){t.context.publish({channel:"adunit",topic:"notfound",data:{adunit_model:e}})}),this.notFoundTimes++)}},{key:"_findLoop",value:function(){var e=this;clearTimeout(this._timer),this._timer=setTimeout(function(){e._find()},500)}}]),t}(c.BaseStrategy)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.SherlockStrategy=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(267),s=n(27),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(s);t.SherlockStrategy=function(e){function t(e,n){r(this,t);var o=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return o.sherlock=o.context.get("Sherlock"),o.adunits=[],o.canonicalList=c.map(o.options.images,function(e){return e.canonicalSrc}),c.forEach(o.options.adUnits,function(e){o.adunits.push(e)}),o}return o(t,e),a(t,[{key:"_find",value:function(){var e=500,t=document.querySelectorAll("img");t=c.filter(t,this.notLocated.bind(this)),t=c.filter(t,this.notDiscarded.bind(this)),t=c.filter(t,this.sizeFilter.bind(this)),t=c.filter(t,this.hasSherlockTags.bind(this)),c.forEach(t,this._notify.bind(this)),0===t.length&&(e=1e3),this.checkTimes%5==0&&(this.discarded=[]),this.checkTimes++,this.adunits.length&&this.canonicalList.length&&setTimeout(this._find.bind(this),e)}},{key:"_notify",value:function(e){var t=this.adunits.shift();t&&(this.elements.push(e),t.name="admin-tagged-"+t.name,this.callback&&this.callback({element:e,model:t}))}},{key:"hasSherlockTags",value:function(e){var t=!1,n=this.sherlock.getCanonicalSrc(e);return-1!==this.canonicalList.indexOf(n)?t=!0:this.discarded.push(e),t}}]),t}(u.AllImagesStrategy)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t,n){return e.split(t)[n]}Object.defineProperty(t,"__esModule",{value:!0}),t.Sherlock=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(27),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(s),l=n(116),f=function(e){return a(e,"#",0)};t.Sherlock=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),u(t,[{key:"setUp",value:function(){var e=this,t=this.context;this.model=[],this.anyTaggedContentFound=!1,this.contentTimer=null,this.baseSrcEvaluable=null,t.addFilter("srcFilter",this._srcFilter.bind(this)),t.set("Sherlock",this),t.subscribe({channel:"config",topic:"received",callback:function(n){var r=n.config.url;r&&r.images&&(e.model=n.config.url.images);var i=c.get(n,"config.url.canonicalUrl");i&&(e.canonicalUrl=i,t.set("Sherlock-canonical-url",e.canonicalUrl));var o=c.get(n.config,"publisher.baseSrcEvaluable");o&&(e.baseSrcEvaluable=e.context.get("factory.evaluable")(o))}}),t.subscribe({channel:"adunit",topic:"found",callback:function(t){var n=t.adunit,r=n.getTaggedElement(),i=e.getId(r),o=e.getImageData(i);e.contentCheck(),o&&(e.anyTaggedContentFound=!0),i.image.canonicalSrc&&e.context.publish({channel:"adunit",topic:"image.resolved",data:{adunit:n,id:i,data:o||{}}})}})}},{key:"contentCheck",value:function(){var e=this;clearTimeout(this.contentTimer),this.contentTimer=setTimeout(function(){e.context.publish({channel:"sherlock",topic:"content",data:{hasContent:e.anyTaggedContentFound}})},3e3)}},{key:"getImageData",value:function(e){var t=null;return c.forEach(this.model,function(n){n.canonicalSrc===e.image.canonicalSrc&&(t=n)}),t}},{key:"getId",value:function(e){return{image:{src:this._getBaseSrc(e),canonicalSrc:this.getCanonicalSrc(e)},url:{url:f(window.location.href),canonicalUrl:this.getCanonicalUrl()}}}},{key:"getCanonicalUrl",value:function(){return this.canonicalUrl}},{key:"getCanonicalSrc",value:function(e){var t=this._getBaseSrc(e);return this.context.filter("srcFilter",t)}},{key:"getLocation",value:function(){return window.location.href}},{key:"_srcFilter",value:function(e){return e.replace(/^https?:\/\/.*?\//,"/")}},{key:"_getBaseSrc",value:function(e){var t=e.getAttribute("src")||"";if(!t&&e.getAttribute("srcset")&&(t=e.getAttribute("srcset").split(" ")[0]),!t&&e.getAttribute("href")&&(t=e.getAttribute("href").split(" ")[0]),!t){var n=window.getComputedStyle(e);n.backgroundImage&&(t=n.backgroundImage.replace(/url\("?'?/g,"").replace(/"?'?\)/,""))}var r=this._getPublisherKey(e);return r&&(t=r),t}},{key:"_getPublisherKey",value:function(e){var t="",n=this.baseSrcEvaluable;if(n)try{var r=n.evaluate({element:e});if(!c.isString(r))throw new Error("base src must be an string");t=r}catch(e){console.error("baseSrcEvaluable evaluating error",e)}return t}}]),t}(l.GohanComponent)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigGetter=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(117),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(u),c=n(116),l=n(386),f=function(e,t){return t.test(e)},p=function(e){return f(e,/^(?:(?:2[0-4]\d|25[0-5]|1\d{2}|[1-9]?\d)\.){3}(?:2[0-4]\d|25[0-5]|1\d{2}|[1-9]?\d)/)},d=t.ConfigGetter=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),a(t,[{key:"subscribeToAppRun",value:function(){this.run()}},{key:"setUp",value:function(){}},{key:"run",value:function(){var e=location.host;this.isValidDomain(e)?this.getConfig():console.error("seedtag has stopped by is not valid domain (port .int .local)")}},{key:"getConfig",value:function(){var e=this.context;new l.ConfigApi(e).config(e.config.token).then(function(t){t.user&&t.user.username&&e.publish({channel:"user",topic:"detected",data:{user:t.user}}),e.publish({channel:"config",topic:"received",data:{config:t}})}).catch(function(e){console.error("Error getting config:",e)})}},{key:"isValidDomain",value:function(e){var t=this.context.isDev||this.context.testing,n=[-1===e.indexOf("proxy")];return t||(n.push(-1===e.indexOf("localhost")),n.push(!p(e)),n.push(!f(e,/\.local/)),n.push(!f(e,/dev\./)),n.push(!f(e,/\.pre$/)),n.push(!f(e,/\.int$/))),0===n.filter(function(e){return!1===e}).length}}]),t}(c.GohanComponent);s.__decorate([(0,c.Subscribe)("engine","run"),s.__metadata("design:type",Function),s.__metadata("design:paramtypes",[]),s.__metadata("design:returntype",void 0)],d.prototype,"subscribeToAppRun",null)},function(e,t,n){"use strict";(function(e){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigApi=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(202),s=n(110);t.ConfigApi=function(t){function n(){r(this,n);var e=i(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments));return e.data=null,e}return o(n,t),a(n,[{key:"setUp",value:function(){this.data=null,this.baseUrl=this.context.config.apiUrl}},{key:"config",value:function(t){var n=this,r=(this.context,{token:t,fullUrl:window.location.href,device:s.detector.getDevice(),cache:(new Date).getTime()});return new e(function(e,t){n.data?e(n.data):n._ajax("GET",n.baseUrl+"/public/config",r,{withCredentials:!0,xhr:!0}).then(function(r){if(r.contentBlocked)return t(r.contentBlocked),!1;try{var i=r.__xhr;delete r.__xhr,r.qcc=i.getResponseHeader("X-QCC"),r.cnt=atob(i.getResponseHeader("X-CNT"))}catch(e){}return n.data=r,e(r),!0}).catch(t)})}}]),n}(u.BaseApi)}).call(t,n(83))},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.PassbackService=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(156),s=n(27),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(s),l=n(116);t.PassbackService=function(e){function t(){r(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.passback=null,e.called=!1,e.template=null,e.adunitsNotFound=0,e.adunitsFound=0,e.adunitFailed=0,e.timeToActivatePassback=7e3,e}return o(t,e),a(t,[{key:"setUp",value:function(){this._bindMessages()}},{key:"_bindMessages",value:function(){var e=this;this.context.subscribe({channel:"template",topic:"selected",callback:function(t){var n=c.get(t,"config.publisher.passback",!1);n&&(e.passback=n);var r=t.template;r?(e.template=r,0===e.template.adUnits.length&&e.callPassback()):e.callPassback()}}),this.context.subscribe({channel:"adunit",topic:"notfound",callback:function(){e._registerAdunitNotFound()}}),this.context.subscribe({channel:"adunit",topic:"found",callback:function(t){e._checkAdunitFound()}}),this.context.subscribe({channel:"adserver",topic:"ad.not-resolved",callback:function(){e.adunitFailed+=1,e.adunitFailed>=e.adunitsFound&&e.callPassback()}})}},{key:"_registerAdunitNotFound",value:function(){this.adunitsNotFound+=1,1===this.adunitsNotFound&&this._startTimerToActivatePassback()}},{key:"_checkAdunitFound",value:function(){this.adunitsFound+=1}},{key:"_startTimerToActivatePassback",value:function(){var e=this;return setTimeout(function(){0===e.adunitsFound&&e.callPassback()},this.timeToActivatePassback)}},{key:"callPassback",value:function(){var e=this;if(this.passback&&!this.called){this.called=!0,this.context.publish({channel:"passback",topic:"activated"});try{setTimeout(function(){(0,u.zepto)("body").append("\x3c!-- seedtag passback --\x3e"+e.passback)},0)}catch(e){}}}}]),t}(l.GohanComponent)},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.TargetingResolver=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(117),c=r(s),l=n(27),f=r(l),p=n(116),d=n(173),h=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return f.filter(f.concat.apply(null,t),Boolean)},y=t.TargetingResolver=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),u(t,[{key:"setUp",value:function(){}},{key:"configSub",value:function(e){var t=e.config;this.config=t}},{key:"subscribeTargeting",value:function(e){var t=e.adunit;this.publishTargeting(t)}},{key:"publishTargeting",value:function(e){return{adunit:e,targeting:this.getTargeting(e)}}},{key:"getTargeting",value:function(e){var t={keywords:{}},n={targetId:"seedtag_"+e.model.name,tagId:e.getTagId(),sizes:[],keywords:{}},r=this.context.subscribe({channel:"targeting",topic:"resolve",callback:function(e){e.page&&(e.page.targeting_keywords&&(e.page.targeting_keywords=h(e.page.targeting_keywords,t.keywords.targeting_keywords)),t.disablePsa=t.disablePsa||e.page.disablePsa,t.member=t.member||e.page.member,t.keywords=f.extend(t.keywords,e.page),delete t.keywords.disablePsa,delete t.keywords.member);var r=e.adunit;if(r){if(r instanceof d.AdUnit)throw Error("Someone called targeting.resolve with type { adunit: AdUnit } and it should be { adunit: KeywordsType }");n.keywords=f.extend(n.keywords,r),n.sizes=f.uniqBy(h(n.sizes,r.sizes||[]),function(e){return e.join("x")})}else n.keywords=f.extend(n.keywords,e),delete n.keywords.sizes}});return this.context.publish({channel:"targeting",topic:"request",data:{adunit:e}}),r.unsubscribe(),{tag:n,page:t,userCountry:this.config.cnt}}}]),t}(p.GohanComponent);c.__decorate([(0,p.Subscribe)("config","received"),c.__metadata("design:type",Function),c.__metadata("design:paramtypes",[Object]),c.__metadata("design:returntype",void 0)],y.prototype,"configSub",null),c.__decorate([(0,p.Subscribe)("adunit","targeting.request"),c.__metadata("design:type",Function),c.__metadata("design:paramtypes",[Object]),c.__metadata("design:returntype",void 0)],y.prototype,"subscribeTargeting",null),c.__decorate([(0,p.Publish)("adunit","targeting.response"),c.__metadata("design:type",Function),c.__metadata("design:paramtypes",[d.AdUnit]),c.__metadata("design:returntype",void 0)],y.prototype,"publishTargeting",null)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.CreativeBridgeTargeting=void 0;var i=n(120),o=(0,i.detectBrowser)(window.navigator.userAgent)||{name:"",version:""},a={chrome:43,firefox:25,ie:10,opera:30},u=function(){var e=parseInt(o.version.split(".")[0],void 0);return!a[o.name]||e>=a[o.name]}();t.CreativeBridgeTargeting=function e(t){r(this,e),t.subscribe({channel:"targeting",topic:"request",callback:function(){t.publish({channel:"targeting",topic:"resolve",data:{page:{bridge_support:u?1:0}}})}})}},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.TemplateTargetingService=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(117),c=r(s),l=n(116),f=n(27),p=r(f),d=t.TemplateTargetingService=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),u(t,[{key:"setUp",value:function(){this.context,this.template=null}},{key:"onTemplateSelected",value:function(e){this.template=e.template}},{key:"onTargetingRequest",value:function(){return{page:this.resolveTargeting()}}},{key:"resolveTargeting",value:function(){var e=this.context.get("factory.evaluable"),t={targeting_keywords:[],template_category:this.template.category};return p.forEach(this.template.getVariables(),function(n){if(n.targetingKeyword)try{var r=e(n.evaluable).evaluate();r&&t.targeting_keywords.push(r)}catch(e){console.error("seedtag evaluating error",e)}}),t}}]),t}(l.GohanComponent);c.__decorate([(0,l.Subscribe)("template","selected"),c.__metadata("design:type",Function),c.__metadata("design:paramtypes",[Object]),c.__metadata("design:returntype",void 0)],d.prototype,"onTemplateSelected",null),c.__decorate([(0,l.Subscribe)("targeting","request"),(0,l.Publish)("targeting","resolve"),c.__metadata("design:type",Function),c.__metadata("design:paramtypes",[]),c.__metadata("design:returntype",void 0)],d.prototype,"onTargetingRequest",null)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.AdunitTargetingService=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(116),s=n(27),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(s),l=n(204),f=function(e,t){var n=e/t;return 0===n?"square":n<0?"portrait":"landscape"},p=(0,l.createFloorNormalizer)(50);t.AdunitTargetingService=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),a(t,[{key:"setUp",value:function(){var e=this,t=this.context;t.subscribe({channel:"targeting",topic:"request",callback:function(n){var r=e.resolveTargeting(n.adunit);t.publish({channel:"targeting",topic:"resolve",data:{adunit:r}})}})}},{key:"resolveTargeting",value:function(e){var t=this.context.get("factory.evaluable"),n=e.getImageSize(),r={image_width:null,image_height:null,image_aspect_ratio:null,targeting_keywords:[]};return c.forEach(e.getModel().variables,function(e){if(e.targetingKeyword)try{var n=t(e.evaluable).evaluate();n&&r.targeting_keywords.push(n)}catch(e){console.error("seedtag evaluating error",e)}}),r.image_width=p(n.x),r.image_height=p(n.y),r.image_aspect_ratio=f(n.x,n.y),r}}]),t}(u.GohanComponent)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.PublisherTargetingService=function e(t){r(this,e);var n=null;t.subscribe({channel:"template",topic:"selected",callback:function(e){var t=e.config.publisher;t&&(n=t)}}),t.subscribe({channel:"targeting",topic:"request",callback:function(){var e={publisher_token:t.config.token,publisher_type:null,publisher_tier:null,publisher_category:null,publisher_country:null};n&&(e.publisher_type=n&&n.type,e.publisher_tier=n&&n.tier,e.publisher_category=n&&n.category,e.publisher_country=n&&n.country),t.publish({channel:"targeting",topic:"resolve",data:{page:e}})}})}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.TaggingTargetingService=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(116),s=n(27),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(s);t.TaggingTargetingService=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),a(t,[{key:"setUp",value:function(){var e=this,t=this.context;this._adunitData=[],t.subscribe({channel:"adunit",topic:"image.resolved",callback:function(t){var n=t.data||{};e._adunitData.push({adunit:t.adunit,data:n.taggingConfiguration||{}})}}),t.subscribe({channel:"targeting",topic:"request",callback:function(n){var r=e.resolveTargeting(n.adunit);t.publish({channel:"targeting",topic:"resolve",data:{adunit:r}})}})}},{key:"resolveTargeting",value:function(e){var t={},n=this.getImageData(e);if(n.hasOwnProperty("campaigns")){var r=n.campaigns;t.image_tags_campaign_included=c.map(r.included,function(e){return e.id}),t.image_tags_campaign_excluded=c.map(r.excluded,function(e){return e.id})}return t}},{key:"getImageData",value:function(e){var t={};return c.forEach(this._adunitData,function(n){n.adunit===e&&(t=n.data||{})}),t}}]),t}(u.GohanComponent)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ContextualizationService=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(116),s=n(27),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(s);t.ContextualizationService=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),a(t,[{key:"setUp",value:function(){var e=this,t=this.context;t.subscribe({channel:"config",topic:"received",callback:function(t){e.categories=c.get(t,"config.url.contextualization.contextData.categories",!1),e.subcategories=c.get(t,"config.url.contextualization.contextData.subcategories",!1)}}),t.subscribe({channel:"targeting",topic:"request",callback:function(n){e.categories&&t.publish({channel:"targeting",topic:"resolve",data:{page:{context_category:e.categories,context_subcategory:e.subcategories}}})}})}}]),t}(u.GohanComponent)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.BrandSafeService=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(116),s=n(27),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(s);t.BrandSafeService=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),a(t,[{key:"setUp",value:function(){var e=this,t=this.context;t.subscribe({channel:"config",topic:"received",callback:function(t){e.brandSafe=c.get(t,"config.brandsafe",!0)}}),t.subscribe({channel:"targeting",topic:"request",callback:function(n){null!=e.brandSafe&&t.publish({channel:"targeting",topic:"resolve",data:{page:{context_safe:e.brandSafe.toString()}}})}})}}]),t}(u.GohanComponent)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.CustomCategoriesService=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(116),s=n(161),c=n(27),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(c);t.CustomCategoriesService=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),a(t,[{key:"setUp",value:function(){this._alreadyTracked={},this._analytics=s.AnalyticsService.get(this.context),this._customCategories=[],this._subscribeToConfig(),this._subscribeToAdview(),this._subscribeAdcall()}},{key:"_subscribeToAdview",value:function(){var e=this;this.context.subscribe({channel:"adunit",topic:"view",callback:function(t){var n=t.adunit.getModel().name;e._alreadyTracked[n]||(e._alreadyTracked[n]=!0,e._sendEvents(n))}})}},{key:"_sendEvents",value:function(e){var t=this;l.forEach(this._customCategories,function(n){t._analytics.trackAdUnitViewCustomCategory(e,n)})}},{key:"_subscribeToConfig",value:function(){var e=this;this.context.subscribe({channel:"config",topic:"received",callback:function(t){e._customCategories=l.get(t,"config.url.contextualization.contextData.customCategories",[])}})}},{key:"_subscribeAdcall",value:function(){var e=this;this.context.subscribe({channel:"targeting",topic:"request",callback:function(t){e.context.publish({channel:"targeting",topic:"resolve",data:{page:{context_custom_categories:e._customCategories}}})}})}}]),t}(u.GohanComponent)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(398);Object.defineProperty(t,"AdServer",{enumerable:!0,get:function(){return r.AdServer}});var i=n(431);Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})})},function(e,t,n){"use strict";(function(e,r){function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.AdServer=void 0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(117),l=i(c),f=n(27),p=i(f),d=n(116),h=n(173),y=n(399),v=n(166);n(400);var g=n(119),b=n(165),m=t.AdServer=function(t){function n(){o(this,n);var e=a(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments));return e.isReady=!1,e}return u(n,t),s(n,[{key:"notifyReady",value:function(){}},{key:"notifyNotReady",value:function(){}},{key:"notifyAdResolved",value:function(e,t){return{admodel:t,adunit:e}}},{key:"notifyNotResolved",value:function(e){return{adunit:e}}},{key:"notifyAdRequest",value:function(e){return{adunit:e}}},{key:"subscribeToAppRun",value:function(){this.setupAdapters()}},{key:"subscribeToAdRequest",value:function(e){e&&e.adunit&&this.scheduleAd(e.adunit)}},{key:"setUp",value:function(){this.adapters=[],this.queue=new y.Queue,this.isReady=!1,this.adInstanceMap=new Map}},{key:"setupAdapters",value:function(){return l.__awaiter(this,void 0,void 0,e.mark(function t(){var n=this;return e.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return p.forEach(this.context.config.AdserverAdapters,function(e){var t=new e(n.context);n.adapters.push(t)}),e.prev=1,e.next=4,r.all(p.map(this.adapters,function(e){return e.start()}));case 4:this.isReady=!0,this.notifyReady(),this.processQueue(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),this.notifyNotReady();case 12:case"end":return e.stop()}},t,this,[[1,9]])}))}},{key:"scheduleAd",value:function(e){this.queue.add(e),this.processQueue()}},{key:"processQueue",value:function(){return l.__awaiter(this,void 0,void 0,e.mark(function t(){var n,r,i;return e.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isReady&&!this.queue.is_blocked()){e.next=2;break}return e.abrupt("return");case 2:if(n=this.queue.next()){e.next=6;break}return this.queue.unblock(),e.abrupt("return");case 6:if(!n){e.next=18;break}return r=void 0,e.prev=8,e.next=11,this.resolveAd(n);case 11:r=e.sent,e.next=17;break;case 14:e.prev=14,e.t0=e.catch(8),this.notifyNotResolved(n);case 17:r?(i=void 0,i=!(r.csm&&r.csm.networkTargeting.networkAd instanceof g.VideoAd)||r.csm.networkTargeting.networkAd.vastAuction,i?this.notifyAdResolved(n,r):this.notifyNotResolved(n)):this.notifyNotResolved(n);case 18:this.queue.unblock(),this.processQueue();case 20:case"end":return e.stop()}},t,this,[[8,14]])}))}},{key:"resolveAd",value:function(t){return l.__awaiter(this,void 0,void 0,e.mark(function n(){var r,i,o;return e.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(o=function t(n){return l.__awaiter(this,void 0,void 0,e.mark(function r(){var i,o,a,u;return e.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i=n.shift())){e.next=18;break}return o=b.Util.wait(3e3),e.next=5,b.Util.race({timeout:o,adModelResolution:i});case 5:if("timeout"!==(a=e.sent)){e.next=10;break}n.push(i),e.next=18;break;case 10:return e.next=12,i;case 12:if(u=e.sent,!u.isJust){e.next=17;break}return e.abrupt("return",u.get());case 17:return e.abrupt("return",t(n));case 18:case"end":return e.stop()}},r,this)}))},!(r=this.adInstanceMap.get(t))){n.next=6;break}return n.abrupt("return",o(r));case 6:return this.notifyAdRequest(t),n.prev=7,i=p.flatten(p.map(this.adapters,function(e){return e.resolve(t)})),this.adInstanceMap.set(t,i),n.abrupt("return",o(i));case 13:return n.prev=13,n.t0=n.catch(7),n.abrupt("return");case 16:case"end":return n.stop()}},n,this,[[7,13]])}))}}]),n}(d.GohanComponent);l.__decorate([(0,d.Publish)("adserver","ready"),l.__metadata("design:type",Function),l.__metadata("design:paramtypes",[]),l.__metadata("design:returntype",void 0)],m.prototype,"notifyReady",null),l.__decorate([(0,d.Publish)("adserver","not-ready"),l.__metadata("design:type",Function),l.__metadata("design:paramtypes",[]),l.__metadata("design:returntype",void 0)],m.prototype,"notifyNotReady",null),l.__decorate([(0,d.Publish)("adserver","ad.resolved"),l.__metadata("design:type",Function),l.__metadata("design:paramtypes",[h.AdUnit,v.AdModel]),l.__metadata("design:returntype",Object)],m.prototype,"notifyAdResolved",null),l.__decorate([(0,d.Publish)("adserver","ad.not-resolved"),l.__metadata("design:type",Function),l.__metadata("design:paramtypes",[h.AdUnit]),l.__metadata("design:returntype",void 0)],m.prototype,"notifyNotResolved",null),l.__decorate([(0,d.Publish)("adserver","ad.request"),l.__metadata("design:type",Function),l.__metadata("design:paramtypes",[h.AdUnit]),l.__metadata("design:returntype",Object)],m.prototype,"notifyAdRequest",null),l.__decorate([(0,d.Subscribe)("engine","run"),l.__metadata("design:type",Function),l.__metadata("design:paramtypes",[]),l.__metadata("design:returntype",void 0)],m.prototype,"subscribeToAppRun",null),l.__decorate([(0,d.Subscribe)("adunit","ad.request"),l.__metadata("design:type",Function),l.__metadata("design:paramtypes",[Object]),l.__metadata("design:returntype",void 0)],m.prototype,"subscribeToAdRequest",null)}).call(t,n(118),n(83))},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.Queue=function(){function e(){r(this,e),this._blocked=!1,this.items=[]}return i(e,[{key:"block",value:function(){this._blocked=!0}},{key:"unblock",value:function(){this._blocked=!1}},{key:"is_blocked",value:function(){return this._blocked}},{key:"empty",value:function(){return 0===this.items.length}},{key:"add",value:function(e){this.items.push(e)}},{key:"next",value:function(){if(this.is_blocked())throw Error("Queue is blocked, cannot next()");return this.block(),this.items.shift()}}]),e}()},function(e,t,n){n(401),n(402),n(416),n(419),e.exports=n(207).Map},function(e,t,n){"use strict";var r=n(268),i={};i[n(158)("toStringTag")]="z",i+""!="[object z]"&&n(180)(Object.prototype,"toString",function(){return"[object "+r(this)+"]"},!0)},function(e,t,n){"use strict";var r=n(403)(!0);n(232)(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=r(t,n),this._i+=e.length,{value:e,done:!1})})},function(e,t,n){var r=n(231),i=n(208);e.exports=function(e){return function(t,n){var o,a,u=String(i(t)),s=r(n),c=u.length;return s<0||s>=c?e?"":void 0:(o=u.charCodeAt(s),o<55296||o>56319||s+1===c||(a=u.charCodeAt(s+1))<56320||a>57343?e?u.charAt(s):o:e?u.slice(s,s+2):a-56320+(o-55296<<10)+65536)}}},function(e,t){e.exports=!1},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){"use strict";var r=n(275),i=n(230),o=n(234),a={};n(181)(a,n(158)("iterator"),function(){return this}),e.exports=function(e,t,n){e.prototype=r(a,{next:i(1,n)}),o(e,t+" Iterator")}},function(e,t,n){var r=n(182),i=n(183),o=n(408);e.exports=n(176)?Object.defineProperties:function(e,t){i(e);for(var n,a=o(t),u=a.length,s=0;u>s;)r.f(e,n=a[s++],t[n]);return e}},function(e,t,n){var r=n(409),i=n(277);e.exports=Object.keys||function(e){return r(e,i)}},function(e,t,n){var r=n(177),i=n(210),o=n(411)(!1),a=n(233)("IE_PROTO");e.exports=function(e,t){var n,u=i(e),s=0,c=[];for(n in u)n!=a&&r(u,n)&&c.push(n);for(;t.length>s;)r(u,n=t[s++])&&(~o(c,n)||c.push(n));return c}},function(e,t,n){var r=n(269);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t,n){var r=n(210),i=n(276),o=n(412);e.exports=function(e){return function(t,n,a){var u,s=r(t),c=i(s.length),l=o(a,c);if(e&&n!=n){for(;c>l;)if((u=s[l++])!=u)return!0}else for(;c>l;l++)if((e||l in s)&&s[l]===n)return e||l||0;return!e&&-1}}},function(e,t,n){var r=n(231),i=Math.max,o=Math.min;e.exports=function(e,t){return e=r(e),e<0?i(e+t,0):o(e,t)}},function(e,t,n){e.exports=n(167).document&&document.documentElement},function(e,t,n){var r=n(177),i=n(415),o=n(233)("IE_PROTO"),a=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=i(e),r(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},function(e,t,n){var r=n(208);e.exports=function(e){return Object(r(e))}},function(e,t,n){for(var r=n(417),i=n(180),o=n(167),a=n(181),u=n(193),s=n(158),c=s("iterator"),l=s("toStringTag"),f=u.Array,p=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],d=0;d<5;d++){var h,y=p[d],v=o[y],g=v&&v.prototype;if(g){g[c]||a(g,c,f),g[l]||a(g,l,y),u[y]=f;for(h in r)g[h]||i(g,h,r[h],!0)}}},function(e,t,n){"use strict";var r=n(418),i=n(278),o=n(193),a=n(210);e.exports=n(232)(Array,"Array",function(e,t){this._t=a(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,i(1)):"keys"==t?i(0,n):"values"==t?i(0,e[n]):i(0,[n,e[n]])},"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},function(e,t,n){var r=n(158)("unscopables"),i=Array.prototype;void 0==i[r]&&n(181)(i,r,{}),e.exports=function(e){i[r][e]=!0}},function(e,t,n){"use strict";var r=n(420);e.exports=n(425)("Map",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{get:function(e){var t=r.getEntry(this,e);return t&&t.v},set:function(e,t){return r.def(this,0===e?0:e,t)}},r,!0)},function(e,t,n){"use strict";var r=n(182).f,i=n(275),o=n(279),a=n(209),u=n(280),s=n(208),c=n(281),l=n(232),f=n(278),p=n(424),d=n(176),h=n(282).fastKey,y=d?"_s":"size",v=function(e,t){var n,r=h(t);if("F"!==r)return e._i[r];for(n=e._f;n;n=n.n)if(n.k==t)return n};e.exports={getConstructor:function(e,t,n,l){var f=e(function(e,r){u(e,f,t,"_i"),e._i=i(null),e._f=void 0,e._l=void 0,e[y]=0,void 0!=r&&c(r,n,e[l],e)});return o(f.prototype,{clear:function(){for(var e=this,t=e._i,n=e._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete t[n.i];e._f=e._l=void 0,e[y]=0},delete:function(e){var t=this,n=v(t,e);if(n){var r=n.n,i=n.p;delete t._i[n.i],n.r=!0,i&&(i.n=r),r&&(r.p=i),t._f==n&&(t._f=r),t._l==n&&(t._l=i),t[y]--}return!!n},forEach:function(e){u(this,f,"forEach");for(var t,n=a(e,arguments.length>1?arguments[1]:void 0,3);t=t?t.n:this._f;)for(n(t.v,t.k,this);t&&t.r;)t=t.p},has:function(e){return!!v(this,e)}}),d&&r(f.prototype,"size",{get:function(){return s(this[y])}}),f},def:function(e,t,n){var r,i,o=v(e,t);return o?o.v=n:(e._l=o={i:i=h(t,!0),k:t,v:n,p:r=e._l,n:void 0,r:!1},e._f||(e._f=o),r&&(r.n=o),e[y]++,"F"!==i&&(e._i[i]=o)),e},getEntry:v,setStrong:function(e,t,n){l(e,t,function(e,t){this._t=e,this._k=t,this._l=void 0},function(){for(var e=this,t=e._k,n=e._l;n&&n.r;)n=n.p;return e._t&&(e._l=n=n?n.n:e._t._f)?"keys"==t?f(0,n.k):"values"==t?f(0,n.v):f(0,[n.k,n.v]):(e._t=void 0,f(1))},n?"entries":"values",!n,!0),p(t)}}},function(e,t,n){var r=n(183);e.exports=function(e,t,n,i){try{return i?t(r(n)[0],n[1]):t(n)}catch(t){var o=e.return;throw void 0!==o&&r(o.call(e)),t}}},function(e,t,n){var r=n(193),i=n(158)("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||o[i]===e)}},function(e,t,n){var r=n(268),i=n(158)("iterator"),o=n(193);e.exports=n(207).getIteratorMethod=function(e){if(void 0!=e)return e[i]||e["@@iterator"]||o[r(e)]}},function(e,t,n){"use strict";var r=n(167),i=n(182),o=n(176),a=n(158)("species");e.exports=function(e){var t=r[e];o&&t&&!t[a]&&i.f(t,a,{configurable:!0,get:function(){return this}})}},function(e,t,n){"use strict";var r=n(167),i=n(274),o=n(180),a=n(279),u=n(282),s=n(281),c=n(280),l=n(175),f=n(206),p=n(426),d=n(234),h=n(427);e.exports=function(e,t,n,y,v,g){var b=r[e],m=b,_=v?"set":"add",A=m&&m.prototype,w={},k=function(e){var t=A[e];o(A,e,"delete"==e?function(e){return!(g&&!l(e))&&t.call(this,0===e?0:e)}:"has"==e?function(e){return!(g&&!l(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return g&&!l(e)?void 0:t.call(this,0===e?0:e)}:"add"==e?function(e){return t.call(this,0===e?0:e),this}:function(e,n){return t.call(this,0===e?0:e,n),this})};if("function"==typeof m&&(g||A.forEach&&!f(function(){(new m).entries().next()}))){var O=new m,j=O[_](g?{}:-0,1)!=O,T=f(function(){O.has(1)}),x=p(function(e){new m(e)}),E=!g&&f(function(){for(var e=new m,t=5;t--;)e[_](t,t);return!e.has(-0)});x||(m=t(function(t,n){c(t,m,e);var r=h(new b,t,m);return void 0!=n&&s(n,v,r[_],r),r}),m.prototype=A,A.constructor=m),(T||E)&&(k("delete"),k("has"),v&&k("get")),(E||j)&&k(_),g&&A.clear&&delete A.clear}else m=y.getConstructor(t,e,v,_),a(m.prototype,n),u.NEED=!0;return d(m,e),w[e]=m,i(i.G+i.W+i.F*(m!=b),w),g||y.setStrong(m,e,v),m}},function(e,t,n){var r=n(158)("iterator"),i=!1;try{var o=[7][r]();o.return=function(){i=!0},Array.from(o,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var n=!1;try{var o=[7],a=o[r]();a.next=function(){return{done:n=!0}},o[r]=function(){return a},e(o)}catch(e){}return n}},function(e,t,n){var r=n(175),i=n(428).set;e.exports=function(e,t,n){var o,a=t.constructor;return a!==n&&"function"==typeof a&&(o=a.prototype)!==n.prototype&&r(o)&&i&&i(e,o),e}},function(e,t,n){var r=n(175),i=n(183),o=function(e,t){if(i(e),!r(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,r){try{r=n(209)(Function.call,n(429).f(Object.prototype,"__proto__").set,2),r(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,n){return o(e,n),t?e.__proto__=n:r(e,n),e}}({},!1):void 0),check:o}},function(e,t,n){var r=n(430),i=n(230),o=n(210),a=n(273),u=n(177),s=n(271),c=Object.getOwnPropertyDescriptor;t.f=n(176)?c:function(e,t){if(e=o(e),t=a(t,!0),s)try{return c(e,t)}catch(e){}if(u(e,t))return i(!r.f.call(e,t),e[t])}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(235);Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})});var i=n(432);Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})});var o=n(439);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(433);Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})})},function(e,t,n){"use strict";(function(e,r){function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ApnAdapter=void 0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(117),l=i(c),f=n(27),p=i(f),d=n(116),h=n(235),y=n(173),v=n(434),g=n(435),b=n(436),m=n(166),_=n(129),A=n(203),w=t.ApnAdapter=function(t){function i(){o(this,i);var e=a(this,(i.__proto__||Object.getPrototypeOf(i)).apply(this,arguments));return e.isAdmin=!1,e}return u(i,t),s(i,[{key:"subscribeTargeting",value:function(e){this.resolveTargeting(e.adunit)}},{key:"resolveTargeting",value:function(e){return{page:{member:4009,disablePsa:!0}}}},{key:"chekIsAdmin",value:function(e){var t=e.user;this.isAdmin=-1!==t.permissions.indexOf("admin")}},{key:"putDebugger",value:function(t){return l.__awaiter(this,void 0,void 0,e.mark(function r(){var i,o;return e.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isAdmin){e.next=6;break}return e.next=3,n.e(5).then(n.bind(null,438));case 3:i=e.sent,o=i.ApnDebugger,t.adunit.addComponent(new o);case 6:case"end":return e.stop()}},r,this)}))}},{key:"publishBidRequest",value:function(e){return{source:m.AdSources.APN,network:m.AdSources.APN,step:0,adunit:e.model}}},{key:"publishBidResponse",value:function(e,t,n){return{source:m.AdSources.APN,network:m.AdSources.APN,videoKind:"-",status:n,time:t,adunit:e.model,step:0}}},{key:"notifyApnNotResolved",value:function(){}},{key:"setUp",value:function(){this.name="AppNexus",this.ast=new v.Ast({member:4009,debug:this.context.debug}),this.apnReadyPromise=this.ast.start()}},{key:"start",value:function(){return r.resolve()}},{key:"resolve",value:function(e){var t=this;if(JSON.parse(localStorage.getItem("_seedtag_apn_disabled_")||"false"))return this.publishBidResponse(e,0,"noad"),this.notifyApnNotResolved(),[r.resolve(A.Maybe.Nothing())];this.publishBidRequest(e);var n=Date.now(),i=this.getTargeting(e);return[this.apnReadyPromise.then(function(){return t.ast.resolve(i)}).then(function(r){return r?t.getAdModel(r).then(function(i){return r.buyer_member_id,i.source=m.AdSources.APN,i.network=m.AdSources.APN,t.publishBidResponse(e,Date.now()-n,"ad"),A.Maybe.Just(i)}):(t.publishBidResponse(e,Date.now()-n,"noad"),t.notifyApnNotResolved(),A.Maybe.Nothing())})]}},{key:"getTargeting",value:function(e){var t={tag:{}},n=this.context.subscribe({channel:"adunit",topic:"targeting.response",callback:function(e){t=e.targeting}});return this.context.publish({channel:"adunit",topic:"targeting.request",data:{adunit:e}}),n.unsubscribe(),this.allowedFormats(t)}},{key:"allowedFormats",value:function(e){var t=p.cloneDeep(e),n=["banner"];return(0,_.formatListHas)(t.tag.sizes,[1,1])&&n.push("video"),t.tag.allowedFormats=n,t}},{key:"isFormat",value:function(e,t){return e[0]===t[0]&&e[1]===t[1]}},{key:"getAdModel",value:function(e){var t=void 0;return"video"===e.ad_type?this.parseVideoAd(e):(t=this.parseAdRtb(e),new r(function(e){e(t)}))}},{key:"parseAdRtb",value:function(e){var t=new m.AdModel,n=e.rtb;return t.hydrate({source:m.AdSources.APN,network:m.AdSources.APN,content:n.banner.content,trackers:{impression:p.map(n.trackers[0].impression_urls,function(e){return{type:"pixel",value:e}})},size:{x:n.banner.width,y:n.banner.height}}),t}},{key:"parseVideoAd",value:function(e){return(/<AdParameters.*>/.test(e.rtb.video.content)?new g.ApnWrapperVast(e):new b.Vast(e)).parse()}}]),i}(h.Adapter);l.__decorate([(0,d.Subscribe)("targeting","request"),l.__metadata("design:type",Function),l.__metadata("design:paramtypes",[Object]),l.__metadata("design:returntype",void 0)],w.prototype,"subscribeTargeting",null),l.__decorate([(0,d.Publish)("targeting","resolve"),l.__metadata("design:type",Function),l.__metadata("design:paramtypes",[y.AdUnit]),l.__metadata("design:returntype",Object)],w.prototype,"resolveTargeting",null),l.__decorate([(0,d.Subscribe)("user","detected"),l.__metadata("design:type",Function),l.__metadata("design:paramtypes",[Object]),l.__metadata("design:returntype",void 0)],w.prototype,"chekIsAdmin",null),l.__decorate([(0,d.Subscribe)("adunit","image.resolved"),l.__metadata("design:type",Function),l.__metadata("design:paramtypes",[Object]),l.__metadata("design:returntype",r)],w.prototype,"putDebugger",null),l.__decorate([(0,d.Publish)("bidder","request"),l.__metadata("design:type",Function),l.__metadata("design:paramtypes",[y.AdUnit]),l.__metadata("design:returntype",Object)],w.prototype,"publishBidRequest",null),l.__decorate([(0,d.Publish)("bidder","response"),l.__metadata("design:type",Function),l.__metadata("design:paramtypes",[y.AdUnit,Number,String]),l.__metadata("design:returntype",Object)],w.prototype,"publishBidResponse",null),l.__decorate([(0,d.Publish)("adapter.apn","apn.not-resolved"),l.__metadata("design:type",Function),l.__metadata("design:paramtypes",[]),l.__metadata("design:returntype",void 0)],w.prototype,"notifyApnNotResolved",null)}).call(t,n(118),n(83))},function(e,t,n){"use strict";(function(e){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Ast=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(27),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(o);t.Ast=function(){function t(e){r(this,t),this.args=e,this.apntag=window.apntag=window.apntag||{},this.apntag.anq=this.apntag.anq||[],this.apntag.loaded=this.apntag.loaded||!1}return i(t,[{key:"start",value:function(){var e=this;return this.loadAst().then(function(){e.setOptions()})}},{key:"resolve",value:function(e){e.page.member=this.args.member,e.page.disablePsa=!0,this.apntag.setPageOpts(e.page);var t=this.setAd(e.tag);return this.apntag.loadTags(),t}},{key:"loadAst",value:function(){var t=this;return new e(function(e,n){if(t.apntag.debug=t.args.debug||!1,t.apntag.loaded)return void e();var r=document.createElement("script");r.type="text/javascript",r.onerror=function(){n(new Error("cannot load ast.js"))},r.src="https://acdn.adnxs.com/ast/ast.js",r.addEventListener("load",e,!1);var i=document.getElementsByTagName("script")[0];i.parentNode&&i.parentNode.insertBefore(r,i)})}},{key:"setOptions",value:function(){try{this.apntag.setPageOpts({member:this.args.member,disablePsa:!0})}catch(e){throw new Error(e)}}},{key:"setAd",value:function(t){var n=this,r=t.targetId;return new e(function(e,i){n.apntag.anq.push(function(){n.apntag.defineTag(t),n.apntag.onEvent("adAvailable",r,function(){var t=a.clone(window.apntag.requests.tags[r].adResponse.ads);e(t.shift())}),n.apntag.onEvent("adNoBid",r,function(t){e()}),n.apntag.onEvent("adRequestFailure",r,function(t){e()}),n.apntag.onEvent("adBadRequest",r,function(t){e()})})})}}]),t}()}).call(t,n(83))},function(e,t,n){"use strict";(function(e){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.ApnWrapperVast=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(27),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(o),u=n(192),s=n(236),c=n(166);t.ApnWrapperVast=function(){function t(e){r(this,t),this.ad=e,this.vastList=[],this.adModel=new c.AdModel,this.adModel.hydrate({source:c.AdSources.APN,network:c.AdSources.APN,content:"",trackers:{impression:[]},size:{x:11,y:1}});var n=e.rtb.video.content;this.vastList.push(n),this.vast=s.XmlParser.xml2dom(n)}return i(t,[{key:"parse",value:function(){var e=this,t=(this.ad,this.vast,this.extractApnVast());return t||console.log("probably not a seedtag video ad"),this.vastList.push(t),this.followVast(s.XmlParser.xml2dom(t)).then(function(t){var n=[],r=null;return a.forEach(t,function(t){var i=s.XmlParser.xml2dom(t);if(e.isSeedtagVast(i))return r=i,!1;n.push(i)}),r&&(e.adModel.content=e.getVideoContent(r),e.adModel.trackers.impression=e.getVideoTrackers(r)),e.adModel})}},{key:"isSeedtagVast",value:function(e){var t=e.documentElement.getElementsByTagName("Companion")[0];return!!t&&"11"===t.getAttribute("width")&&"1"===t.getAttribute("height")}},{key:"followVast",value:function(t){var n=this,r=this.getVastAdUrl(t);return r?(0,u.Ajax)({url:r}).then(function(e){return n.vastList.push(e),n.followVast(s.XmlParser.xml2dom(e))}):new e(function(e){e(n.vastList)})}},{key:"getVastAdUrl",value:function(e){var t=e.documentElement.getElementsByTagName("VASTAdTagURI")[0];return!!t&&t.textContent}},{key:"extractApnVast",value:function(){var e="",t=this.findTagName(this.vast,"AdParameters");if(t[0])try{var n=JSON.parse(t[0].textContent);e=this.base64ecode(n.ads[0].rtb.content_b64)}catch(e){}return e}},{key:"getVideoTrackers",value:function(e){var t=[],n=this.findTagName(this.vast,"Impression");return a.forEach(n,function(e){t.push(e.childNodes[0].wholeText.replace(/[ \n]/g,""))}),a.map(t,function(e){return{type:"pixel",value:e}})}},{key:"getVideoContent",value:function(e){var t=s.XmlParser.xml2dom(this.vastList[1]),n="%content%\n<script>\nwindow._seedtag = window._seedtag || {}\nwindow._seedtag.vastXml = '%vast%'\n<\/script>\n";t.documentElement.getElementsByTagName("VASTAdTagURI")[0].textContent=""+this.getVastAdUrl(e);var r=this.findTagName(e,"Companion")[0];if(r)try{n=n.replace("%content%",r.getElementsByTagName("HTMLResource")[0].childNodes[0].wholeText),n=n.replace("'%vast%'",JSON.stringify(s.XmlParser.dom2xml(t)))}catch(e){return null}return n}},{key:"findTagName",value:function(e,t){return e.documentElement.getElementsByTagName(t)}},{key:"base64ecode",value:function(e){return atob(e.replace(/-/g,"+").replace(/_/g,"/").replace(/[^A-Za-z0-9\+\/]/g,""))}}]),t}()}).call(t,n(83))},function(e,t,n){"use strict";(function(e){function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Vast=void 0;var a=function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(117),c=r(s),l=n(27),f=r(l),p=n(128),d=function(e){return e&&e.__esModule?e:{default:e}}(p),h=n(263),y=n(192),v=n(236),g=n(166),b=n(437),m=(h.Result.fromNullable,h.Result.Ok);h.Result.Err,t.Vast=function(){function t(e){o(this,t),this.ad=e,this.vastList=[],this.adModel=new g.AdModel,this.adModel.hydrate({source:g.AdSources.APN,network:g.AdSources.APN,content:"",trackers:{impression:[]},size:{x:11,y:1}});var n=e.rtb.video.content;this.vastList.push(n),this.vast=v.XmlParser.xml2dom(n)}return u(t,[{key:"parse",value:function(){return c.__awaiter(this,void 0,void 0,e.mark(function t(){var n,r,o,u,s,c,l,f;return e.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.ad,r={x:11,y:1},o=this.vast,u=function(e,t){return e.chain(function(e){var n=a(e,2),r=n[0],o=n[1];return m(v.XmlParser.xml2dom(t)).map(function(e){return b.SeedtagVast.isSeedtagVast(e)?[e,[].concat(i(o),[e])]:[r,[].concat(i(o),[e])]})})},e.t0=d.default,e.next=7,this.followVast(o);case 7:return e.t1=e.sent,e.t2=u,e.t3=m([null,[]]),e.t4=function(e){throw e},e.t5=function(e){return e},s=e.t0.foldl.call(e.t0,e.t1,e.t2,e.t3).fold(e.t4,e.t5),c=a(s,2),l=c[0],f=c[1],l?(this.adModel.content=this.getSeedtagContent(l),this.adModel.trackers.impression=this.getVideoTrackers(l)):(this.adModel.content=b.SeedtagVast.getVideoContent(this.vast),this.adModel.size={x:1,y:1}),e.abrupt("return",this.adModel);case 18:case"end":return e.stop()}},t,this)}))}},{key:"followVast",value:function(t){return c.__awaiter(this,void 0,void 0,e.mark(function n(){var r,i;return e.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.getVastAdUrl(t)){e.next=3;break}return e.abrupt("return",this.vastList);case 3:return e.next=5,(0,y.Ajax)({url:r});case 5:return i=e.sent,this.vastList.push(i),e.abrupt("return",this.followVast(v.XmlParser.xml2dom(i)));case 8:case"end":return e.stop()}},n,this)}))}},{key:"getVastAdUrl",value:function(e){var t=v.XmlParser.findByTagName(e,"VASTAdTagURI")[0];return!!t&&t.textContent.trim()}},{key:"getVideoTrackers",value:function(e){var t=[],n=v.XmlParser.findByTagName(this.vast,"Impression");return f.forEach(n,function(e){t.push(e.childNodes[0].wholeText.replace(/[ \n]/g,""))}),f.map(t,function(e){return{type:"pixel",value:e}})}},{key:"getSeedtagContent",value:function(e){var t=new b.SeedtagVast(e),n=v.XmlParser.xml2dom(this.vastList[0]);return t.getCreative()+b.SeedtagVast.getVideoContent(t.merge(n))}}]),t}()}).call(t,n(118))},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.SeedtagVast=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(236),a=n(27),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(a),s=function(e){var t=o.XmlParser.findByTagName(e,"VASTAdTagURI")[0];return!!t&&t.textContent.trim()},c=function(e,t){var n=o.XmlParser.xml2dom(o.XmlParser.dom2xml(e.documentElement));return n.documentElement.getElementsByTagName("VASTAdTagURI")[0].textContent=s(t),n},l=function(e,t){var n=o.XmlParser.xml2dom(o.XmlParser.dom2xml(e).replace("<Wrapper","<InLine").replace("</Wrapper","</InLine")),r=o.XmlParser.findByTagName(n,"Linear")[0],i=o.XmlParser.findByTagName(t,"VideoClicks")[0];if(i){var a=o.XmlParser.findByTagName(n,"VideoClicks")[0];a?u.forEach(i.children,function(e){a.appendChild(e)}):r.appendChild(i)}var s=o.XmlParser.findByTagName(t,"MediaFiles"),c=o.XmlParser.findByTagName(t,"Duration")[0];if(s.length){r.appendChild(c),Array.prototype.map.apply(s,[function(e){return r.appendChild(e)}]);var l=o.XmlParser.findByTagName(n,"VideoClicks")[0];r.appendChild(l)}var f=o.XmlParser.findByTagName(n,"VASTAdTagURI")[0];return f&&f.parentElement&&f.parentElement.removeChild(f),n};t.SeedtagVast=function(){function e(t){r(this,e),this.vast=t}return i(e,[{key:"getCreative",value:function(){return o.XmlParser.findByTagName(this.vast,"HTMLResource")[0].childNodes[0].wholeText}},{key:"merge",value:function(e){return o.XmlParser.findByTagName(this.vast,"Wrapper")[0]?c(e,this.vast):l(e,this.vast)}}],[{key:"isSeedtagVast",value:function(e){var t=o.XmlParser.findByTagName(e,"Companion")[0];return!!t&&"11"===t.getAttribute("width")&&"1"===t.getAttribute("height")}},{key:"getVideoContent",value:function(e){return"<script>\n    window._seedtag = window._seedtag || {};\n    window._seedtag.vastXml = "+JSON.stringify(o.XmlParser.dom2xml(e))+"\n    <\/script>"}}]),e}()},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(440);Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})})},function(e,t,n){"use strict";(function(e,r){function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.NetworksAdapter=t.Deferred=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(117),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(s),l=n(27),f=n(116),p=n(235),d=n(173),h=n(441),y=n(166),v=n(110),g=(n(129),n(133)),b=n(192),m=n(111),_=n(119),A=n(165),w=n(120),k=n(442),O=n(122),j=["article"],T=function(e){var t=e.placement,n=e.size,r=e.priceBucket;return("https:"===document.location.protocol?"https://secure":"http://ib")+".adnxs.com/tt?id="+t+"&size="+n+"&price_bucket="+r+"&prevent_rtb=1&prevent_deals=1"},x=function(e){var t={empty:function(){return""},mappend:function(e,t){return e+t}},n=function(e){return function(t){return t.reduce(function(t,n){return e.mappend(t,n)},e.empty())}}(t),r=[n(["<script>","window._seedtag = window._seedtag || {};","window._seedtag.appnexus_data = {CP_ID: '"+e.network.name+"'};","<\/script>"])];return e instanceof _.VideoAd?r.push(n(["<script>",'\n          window._seedtag.vastXml = function(c) {\n            c(null, "'+e.vast.get().replace(/\r?\n|\r/g,"").replace(/"/g,'\\"')+'")\n          };\n          ',"<\/script>"])):r.push(e.network.tag),n(r)},E=t.Deferred=function t(){var n=this;a(this,t),this.promise=new e(function(e,t){n.resolve=e,n.reject=t})},P=t.NetworksAdapter=function(t){function n(){a(this,n);var e=i(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments));return e.startPromise=new E,e.APNNotResolvedPromise=new E,e.enabled=!0,e}return o(n,t),u(n,[{key:"setUp",value:function(){}},{key:"start",value:function(){return c.__awaiter(this,void 0,void 0,r.mark(function e(){return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.startPromise.promise;case 2:case"end":return e.stop()}},e,this)}))}},{key:"configSub",value:function(e){var t=e.config;return c.__awaiter(this,void 0,void 0,r.mark(function e(){return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.networks=t.an,this.startPromise.resolve();case 2:case"end":return e.stop()}},e,this)}))}},{key:"onTemplateSelected",value:function(e){var t=e.template;this.enabled=null!=t&&-1!==j.indexOf(t.type)}},{key:"onAPNResolve",value:function(){this.APNNotResolvedPromise.resolve()}},{key:"publishBidRequest",value:function(e,t,n,r){return{source:n,network:e,step:r,adunit:t.model}}},{key:"publishBidResponse",value:function(e,t,n,r,i,o,a){return{status:e,time:t,network:n,videoKind:r,source:o,adunit:i.model,step:a}}},{key:"notifyWinner",value:function(e){var t=this,n=e[0];return n?(n._1.isCsmVideo()&&function(){c.__awaiter(t,void 0,void 0,r.mark(function e(){var t,i,o,a,u,s;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.context.waitForEvent("ad","ready");case 2:return e.prev=2,e.next=5,this.context.waitForEvent("ad","view",5e3);case 5:e.next=23;break;case 7:e.prev=7,e.t0=e.catch(2),t=n._1.getVast().get(),i=n._1.network,o=n._1.getVideoKind(),a=new FormData,a.append("vast",new Blob([t],{type:"text/plain"})),a.append("videoKind",o),a.append("network",i),u=(0,w.detectOS)(),a.append("osName",u.name),a.append("osVersion",u.version.toString()),s=(0,w.detectBrowser)(window.navigator.userAgent),s&&(a.append("browserName",s.name),a.append("browserVersion",s.majorVersion.toString())),a.append("handheld",v.DeviceDetector.isHandheldDevice().toString()),a.append("supportsAutoplay",v.DeviceDetector.autoplaySupport().toString());case 23:case"end":return e.stop()}},e,this,[[2,7]])}))}(),{winner:n._1.network,winners:e.length,videoKind:n._1.getVideoKind(),waterfallStep:n._2}):{winner:"-",winners:0,videoKind:"-",waterfallStep:0}}},{key:"tryToGetTestVAST",value:function(e){var t=this,n={name:"SEEDTAG_VAST",format:"11x2",tag:"http://HAHAHAHAHAHAH.com",pb:"pb20"},i=localStorage.getItem("_seedtag_vast_")||"";if(i.match("<VAST")){var o=m.Maybe.Just(function(){return c.__awaiter(t,void 0,void 0,r.mark(function t(){var o;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.APNNotResolvedPromise.promise;case 2:return o=new _.VideoAd(n,m.Maybe.Just(i),!0),this.publishBidRequest("SEEDTAG_VAST",e,y.AdSources.ST_NETWORKS_VIDEO,0),this.publishBidResponse(this.vastHasAd(i)?"ad":"noad",0,"SEEDTAG_VAST",_.VideoAd.getVideoKind(o),e,y.AdSources.ST_NETWORKS_VIDEO,0),t.abrupt("return",o);case 6:case"end":return t.stop()}},t,this)}))}());return new k.Tuple2(o,n)}return new k.Tuple2(m.Maybe.Nothing(),n)}},{key:"vastHasAd",value:function(e){return/<InLine|<Wrapper/.test(e)}},{key:"getAdFuture",value:function(e,t,n,i){return c.__awaiter(this,void 0,void 0,r.mark(function o(){var a,u,s,c,l,f,p,d,g,w;return r.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if("11x2"!==e.format){r.next=44;break}return r.next=3,this.APNNotResolvedPromise.promise;case 3:return a=v.DeviceDetector.isHandheldDevice(),u=!0,r.prev=5,r.next=8,O.GenServer.call(this,"autoplay.support",750);case 8:u=r.sent,r.next=13;break;case 11:r.prev=11,r.t0=r.catch(5);case 13:if(u){r.next=15;break}return r.abrupt("return",new _.VideoAd(e,m.Maybe.Nothing(),!1));case 15:return s=Date.now(),this.publishBidRequest(e.name,t,y.AdSources.ST_NETWORKS_VIDEO,i),r.prev=17,c=A.Util.wait(12e3*(v.DeviceDetector.isMobile()?2:1)),l=(0,b.Ajax)({method:"GET",url:h.Macros.processTagMacros(e.tag,n)},{withCredentials:!0}),r.next=22,A.Util.race({timeout:c,vast:l});case 22:if("vast"!==(f=r.sent)){r.next=33;break}return r.next=26,l;case 26:return p=r.sent,d=this.vastHasAd(p),g=new _.VideoAd(e,d?m.Maybe.Just(p):m.Maybe.Nothing(),d),this.publishBidResponse(d?"ad":"noad",Date.now()-s,e.name,_.VideoAd.getVideoKind(g),t,y.AdSources.ST_NETWORKS_VIDEO,0),r.abrupt("return",g);case 33:return w=Date.now()-s,this.publishBidResponse("timeout",w,e.name,_.VideoAd.getVideoKind(),t,y.AdSources.ST_NETWORKS_VIDEO,i),r.abrupt("return",new _.VideoAd(e,m.Maybe.Nothing(),!1));case 36:r.next=42;break;case 38:return r.prev=38,r.t1=r.catch(17),this.publishBidResponse("noad",Date.now()-s,e.name,_.VideoAd.getVideoKind(),t,y.AdSources.ST_NETWORKS_VIDEO,i),r.abrupt("return",new _.VideoAd(e,m.Maybe.Nothing(),!1));case 42:r.next=45;break;case 44:return r.abrupt("return",new _.DisplayAd(e));case 45:case"end":return r.stop()}},o,this,[[5,11],[17,38]])}))}},{key:"resolve",value:function(t){var n=this;if(!this.enabled)return[];var r=this.getTargeting(t),i=this.tryToGetTestVAST(t),o=function(){return(0,l.map)(n.networks.filter(function(e){return new _.NotDefinedNetworkAd(e).getTargeted(r).isJust}),function(e,i){return new k.Tuple2(n.getAdFuture(e,t,r,i),e)})},a=function(e){return function(t,n){return e.isJust?n(e.get()):t()}}(i._1)(o,function(e){return[i.flatMap(function(e,t){return new k.Tuple2(e.get(),t)})]}),u=(0,l.map)(a,function(e,t){return e.flatMap(function(e,n){var r=e.then(function(e){return s(e,t)});return new k.Tuple2(r,n)})}),s=function(e,i){return e instanceof _.VideoAd&&!e.vastAuction?m.Maybe.Nothing():m.Maybe.Just(new _.NetworkTargeting(e,r)).map(function(e){return n.getAdModel(e,t,i)})},c=function(e){return e._1},f=function(e){return"11x2"===e._2.format},p=u.filter(f).map(c);return e.all(p).then(function(e){e.length&&n.notifyWinner(e.map(function(e,t){return k.Tuple2.of(e,t)}).filter(function(e){return e._1.isJust}).map(function(e){return k.Tuple2.of(e._1.get(),e._2)}).filter(function(e){return e._1.isCsmVideo()}))}),u.map(c)}},{key:"getAdModel",value:function(e,t,n){var r=e.networkAd,i=e.targeting,o=new y.AdModel,a=(0,g.getFormat)(r.network.format);return o.hydrate({source:"11x2"==r.network.format?y.AdSources.ST_NETWORKS_VIDEO:y.AdSources.ST_NETWORKS_DISPLAY,network:e.getName(),content:h.Macros.processTagMacros(x(r),i),size:{x:a[0],y:a[1]},csm:{networkTargeting:e,name:e.getName(),timeout:12e3*(v.DeviceDetector.isMobile()?2:1),step:n},trackers:{impression:[{type:"iframe",value:this.getTracker(t,e.networkAd)}]}}),o}},{key:"getTracker",value:function(e,t){return T({placement:e.model.adserverId,size:t.network.format,priceBucket:t.network.pb})}},{key:"getTargeting",value:function(e){var t={},n=this.context.subscribe({channel:"adunit",topic:"targeting.response",callback:function(e){return t=e.targeting}});return this.context.publish({channel:"adunit",topic:"targeting.request",data:{adunit:e}}),n.unsubscribe(),t}}]),n}(p.Adapter);c.__decorate([(0,f.Subscribe)("config","received"),c.__metadata("design:type",Function),c.__metadata("design:paramtypes",[Object]),c.__metadata("design:returntype",e)],P.prototype,"configSub",null),c.__decorate([(0,f.Subscribe)("template","selected"),c.__metadata("design:type",Function),c.__metadata("design:paramtypes",[Object]),c.__metadata("design:returntype",void 0)],P.prototype,"onTemplateSelected",null),c.__decorate([(0,f.Subscribe)("adapter.apn","apn.not-resolved"),c.__metadata("design:type",Function),c.__metadata("design:paramtypes",[]),c.__metadata("design:returntype",void 0)],P.prototype,"onAPNResolve",null),c.__decorate([(0,f.Publish)("bidder","request"),c.__metadata("design:type",Function),c.__metadata("design:paramtypes",[String,d.AdUnit,String,Number]),c.__metadata("design:returntype",Object)],P.prototype,"publishBidRequest",null),c.__decorate([(0,f.Publish)("bidder","response"),c.__metadata("design:type",Function),c.__metadata("design:paramtypes",[String,Number,String,String,d.AdUnit,String,Number]),c.__metadata("design:returntype",Object)],P.prototype,"publishBidResponse",null),c.__decorate([(0,f.Publish)("adapter.networks","winner"),c.__metadata("design:type",Function),c.__metadata("design:paramtypes",[Array]),c.__metadata("design:returntype",Object)],P.prototype,"notifyWinner",null)}).call(t,n(83),n(118))},function(e,t,n){"use strict";function r(e,t){var n=o.extend({},f,d(p,t)),r=e;return o.forEach(n,function(e,t,n){r=r.split("${"+t+"}").join(e)}),r}Object.defineProperty(t,"__esModule",{value:!0}),t.Macros=void 0,t.processTagMacros=r;var i=n(27),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(i),a="\n(function() {\n  var curr = window;\n  do {\n    curr.postMessage('bid', '*');\n    curr = curr.parent;\n  } while(curr !== curr.parent);\n}());\n".replace(/[\n\r\t]/g,""),u="\n(function() {\n  var curr = window;\n  do {\n    curr.postMessage('noad', '*');\n    curr = curr.parent;\n  } while(curr !== curr.parent);\n}());\n".replace(/[\n\r\t]/g,""),s=""+u,c="<script>"+s+"<\/script>",l="<script>"+s+"<\/script>",f={passback_url:"https://creative-cdn.seedtag.com/passback/noad.html",passback_html:c,passback_js:s,ref_url:document.location.href,ref_url_encoded:encodeURIComponent(document.location.href),cache_buster:(new Date).getTime(),user_agent_enc:encodeURIComponent(window.navigator.userAgent),positive_confirmation_js:a,positive_confirmation_html:l},p={template_type:"page.keywords.template_type",image_width:"tag.keywords.image_width",image_height:"tag.keywords.image_height",publisher_token:"page.keywords.publisher_token",publisher_category:"page.keywords.publisher_category",publisher_country:"page.keywords.publisher_country",context_custom_categories:"page.keywords.context_custom_categories",context_safe:"page.keywords.context_safe",context_category:"page.keywords.context_category",context_subcategory:"page.keywords.context_subcategory"},d=function(e,t){var n={};return o.forEach(e,function(e,r,i){var a=o.get(t,e,"");n[r]=o.isArray(a)?a.join(","):a}),n};t.Macros={processTagMacros:r}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.Tuple2=function(){function e(t,n){r(this,e),this._1=t,this._2=n}return i(e,[{key:"flatMap",value:function(e){return e(this._1,this._2)}}],[{key:"of",value:function(t,n){return new e(t,n)}}]),e}(),t.Tuple3=function(){function e(t,n,i){r(this,e),this._1=t,this._2=n,this._3=i}return i(e,[{key:"flatMap",value:function(e){return e(this._1,this._2,this._3)}}],[{key:"of",value:function(t,n,r){return new e(t,n,r)}}]),e}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.InspectService=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(116);t.InspectService=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),a(t,[{key:"setUp",value:function(){var e=this.context;window._seedtagInspect={},e.subscribe({channel:"config",topic:"received",callback:function(e){console.log("**** CONFIG RECEIVED ****"),window._seedtagInspect.config=e.config}}),e.subscribe({channel:"template",topic:"selected",callback:function(e){window._seedtagInspect.template=e.template}}),console.log("**** INSPECT SERVICE READY ****")}}]),t}(u.GohanComponent)},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Admin=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(117),c=r(s),l=n(116),f=n(27),p=r(f),d=t.Admin=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),u(t,[{key:"publishAdminRun",value:function(){}},{key:"setUp",value:function(){var e=this;this._isAdmin=!1,this.bleeper=null,this.adunits=[],this.images=[],this.template=null,this.config=null,this.domLoaded=!1;var t=this.context;"loading"===document.readyState?document.addEventListener("DOMContentLoaded",function(){e.domLoaded=!0,e._isAdmin&&e._loadBleeper()}):this.domLoaded=!0,t.subscribe({channel:"user",topic:"detected",callback:function(t){var n=t.user;e._isAdmin=-1!==n.permissions.indexOf("admin"),e.context.set("isAdmin",e._isAdmin),e._isAdmin&&(e.publishAdminRun(),e.domLoaded&&e._loadBleeper())}}),t.subscribe({channel:"adunit",topic:"found",callback:function(t){e.bleeper?e.bleeper.processAdUnit(t.adunit):e.adunits.push(t.adunit)}}),t.subscribe({channel:"template",topic:"selected",callback:function(t){e.template=t.template}}),t.subscribe({channel:"adunit",topic:"image.resolved",callback:function(n){e.bleeper?t.publish({channel:"admin.adunit",topic:"image.resolved",data:n}):e.images.push(n)}}),t.subscribe({channel:"config",topic:"received",callback:function(t){e.bleeper?e.bleeper.setConfig(e.config):e.config=t.config}})}},{key:"_loadBleeper",value:function(){var e=this;n.e(3).then(function(t){var r=n(445).Bleeper;e.bleeper=new r(e.context,{template:e.template}),e.config&&e.bleeper.setConfig(e.config),p.forEach(e.adunits,function(t){e.bleeper.processAdUnit(t)}),p.forEach(e.images,function(t){e.context.publish({channel:"admin.adunit",topic:"image.resolved",data:t})})}.bind(null,n)).catch(n.oe)}}]),t}(l.GohanComponent);c.__decorate([(0,l.Publish)("admin","run"),c.__metadata("design:type",Function),c.__metadata("design:paramtypes",[]),c.__metadata("design:returntype",void 0)],d.prototype,"publishAdminRun",null)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.AutoplayService=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(117),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(u),c=n(121),l=n(122),f=n(564),p={getCache:function(){try{return JSON.parse(localStorage.getItem("_seedtag_autoplay_support_")||"null")}catch(e){}},setEnabled:function(e){var t=Date.now()+36e5,n={expires:t,isEnabled:e};return localStorage.setItem("_seedtag_autoplay_support_",JSON.stringify(n)),e}},d=t.AutoplayService=function(e){function t(){r(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.waitTime=200,e.retries=5,e.currentTry=0,e.elem=document.createElement("video"),e.elemStyle=e.elem.style,e.isAutoplaySupported=new f.Deferred,e.testAutoplay=function(t){e.currentTry++,clearTimeout(e.timeout);var n=t&&"playing"===t.type||0!==e.elem.currentTime;if(!n&&e.currentTry<e.retries)return void(e.timeout=setTimeout(e.testAutoplay,e.waitTime));e.isAutoplaySupported.resolve(n),e.elem.removeEventListener("playing",e.testAutoplay,!1),e.elem.parentNode&&e.elem.parentNode.removeChild(e.elem)},e}return o(t,e),a(t,[{key:"setUp",value:function(){}},{key:"handleAutoplaySupportCall",value:function(){return this.isAutoplaySupported}},{key:"notifyAutoplaySupport",value:function(e){return e}},{key:"start",value:function(){var e=p.getCache();if(e&&Date.now()<e.expires)return void this.isAutoplaySupported.resolve(e.isEnabled);if(this.isAutoplaySupported.then(p.setEnabled).then(this.notifyAutoplaySupport.bind(this)),!("autoplay"in this.elem))return this.isAutoplaySupported.reject(new Error("Autoplay: video.autoplay doesn't exist"));this.elemStyle.position="absolute",this.elemStyle.height="0px",this.elemStyle.width="0px";try{this.elem.src="data:video/mp4;base64,AAAAIGZ0eXBpc29tAAACAGlzb21pc28yYXZjMW1wNDEAAAAIZnJlZQAAAs1tZGF0AAACrgYF//+q3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDE0OCByMjYwMSBhMGNkN2QzIC0gSC4yNjQvTVBFRy00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAxNSAtIGh0dHA6Ly93d3cudmlkZW9sYW4ub3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTMgZGVibG9jaz0xOjA6MCBhbmFseXNlPTB4MzoweDExMyBtZT1oZXggc3VibWU9NyBwc3k9MSBwc3lfcmQ9MS4wMDowLjAwIG1peGVkX3JlZj0xIG1lX3JhbmdlPTE2IGNocm9tYV9tZT0xIHRyZWxsaXM9MSA4eDhkY3Q9MSBjcW09MCBkZWFkem9uZT0yMSwxMSBmYXN0X3Bza2lwPTEgY2hyb21hX3FwX29mZnNldD0tMiB0aHJlYWRzPTEgbG9va2FoZWFkX3RocmVhZHM9MSBzbGljZWRfdGhyZWFkcz0wIG5yPTAgZGVjaW1hdGU9MSBpbnRlcmxhY2VkPTAgYmx1cmF5X2NvbXBhdD0wIGNvbnN0cmFpbmVkX2ludHJhPTAgYmZyYW1lcz0zIGJfcHlyYW1pZD0yIGJfYWRhcHQ9MSBiX2JpYXM9MCBkaXJlY3Q9MSB3ZWlnaHRiPTEgb3Blbl9nb3A9MCB3ZWlnaHRwPTIga2V5aW50PTI1MCBrZXlpbnRfbWluPTEwIHNjZW5lY3V0PTQwIGludHJhX3JlZnJlc2g9MCByY19sb29rYWhlYWQ9NDAgcmM9Y3JmIG1idHJlZT0xIGNyZj0yMy4wIHFjb21wPTAuNjAgcXBtaW49MCBxcG1heD02OSBxcHN0ZXA9NCBpcF9yYXRpbz0xLjQwIGFxPTE6MS4wMACAAAAAD2WIhAA3//728P4FNjuZQQAAAu5tb292AAAAbG12aGQAAAAAAAAAAAAAAAAAAAPoAAAAZAABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAACGHRyYWsAAABcdGtoZAAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAZAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAgAAAAIAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAAGQAAAAAAAEAAAAAAZBtZGlhAAAAIG1kaGQAAAAAAAAAAAAAAAAAACgAAAAEAFXEAAAAAAAtaGRscgAAAAAAAAAAdmlkZQAAAAAAAAAAAAAAAFZpZGVvSGFuZGxlcgAAAAE7bWluZgAAABR2bWhkAAAAAQAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAAA+3N0YmwAAACXc3RzZAAAAAAAAAABAAAAh2F2YzEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAgACAEgAAABIAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAY//8AAAAxYXZjQwFkAAr/4QAYZ2QACqzZX4iIhAAAAwAEAAADAFA8SJZYAQAGaOvjyyLAAAAAGHN0dHMAAAAAAAAAAQAAAAEAAAQAAAAAHHN0c2MAAAAAAAAAAQAAAAEAAAABAAAAAQAAABRzdHN6AAAAAAAAAsUAAAABAAAAFHN0Y28AAAAAAAAAAQAAADAAAABidWR0YQAAAFptZXRhAAAAAAAAACFoZGxyAAAAAAAAAABtZGlyYXBwbAAAAAAAAAAAAAAAAC1pbHN0AAAAJal0b28AAAAdZGF0YQAAAAEAAAAATGF2ZjU2LjQwLjEwMQ=="}catch(e){return this.isAutoplaySupported.reject(new Error("Autoplay: Cannot set video.src"))}this.addVideo(this.elem)}},{key:"addVideo",value:function(e){var t=this;e.setAttribute("autoplay",""),e.style.cssText="display:none",document.body||setTimeout(function(){return t.addVideo(e)},100),document.body.appendChild(e),setTimeout(function(){e.addEventListener("playing",t.testAutoplay,!1),t.timeout=setTimeout(t.testAutoplay,t.waitTime)})}}]),t}(c.GohanComponent);s.__decorate([l.GenServer.handleCall("autoplay.support"),s.__metadata("design:type",Function),s.__metadata("design:paramtypes",[]),s.__metadata("design:returntype",void 0)],d.prototype,"handleAutoplaySupportCall",null),s.__decorate([(0,l.Publish)("features","autoplay-support"),s.__metadata("design:type",Function),s.__metadata("design:paramtypes",[Object]),s.__metadata("design:returntype",void 0)],d.prototype,"notifyAutoplaySupport",null),s.__decorate([(0,l.Subscribe)("engine","run"),s.__metadata("design:type",Function),s.__metadata("design:paramtypes",[]),s.__metadata("design:returntype",void 0)],d.prototype,"start",null)},function(e,t,n){"use strict";(function(e){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Deferred=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n(this,t);var i=void 0,o=void 0,a=void 0;e.timeout&&(a=setTimeout(function(){o(new Error("Deferred did timeout"))},e.timeout));var u=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,function(e,t){i=e,o=t}));return u.resolve=function(e){clearTimeout(a),i(e)},u.reject=function(e){clearTimeout(a),o(e)},u}return i(t,e),t}(e)}).call(t,n(83))}]));