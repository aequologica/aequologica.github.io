<!DOCTYPE HTML>
<html lang="fr">
<head>
  <meta charset="UTF-8"/>

  <meta name="viewport"             content="width=device-width, initial-scale=1"/>
  <meta name="google"               content="notranslate"/>
  <meta name="title"                content=""/>
  <meta name="description"          content=""/>
  <meta name="author"               content="Christophe Thiebaud"/>

  <meta http-equiv="Content-Language" content="fr" />
  <meta http-equiv="X-UA-Compatible"  content="IE=edge,chrome=1"/>

  <title>Outil</title>

  <link rel="stylesheet" type="text/css" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

  <link href="animate.css" rel="stylesheet">
  <link href="sticky-footer-navbar.css" rel="stylesheet">

  <link rel="shortcut icon" href="/favicon2.ico">  

  <link rel="stylesheet" href="style.css">
  
</head>

<body>

<div id="main" class="container">

<h1 id="title">Outil</h1>

<iframe id="sc-widget" width="100%" height="128px" scrolling="no" frameborder="no" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/200594478&auto_play=false&buying=false&liking=false&download=false&sharing=false&show_artwork=false&show_comments=false&show_playcount=false&show_user=false&hide_related=false&visual=true&start_track=0&callback=true"></iframe>  

<button id="post" type="button" class="btn btn-default">post to soundcloud</button>   
<button id="clear" type="button" class="btn btn-default">clear</button>    
 
<div class="row">   
<ul class="col-md-6" id="result"></ul>   
<textarea class="col-md-6"></textarea>    
</div>   
   
<button id="post" type="button" class="btn btn-default">post to soundcloud</button>    
<button id="clear" type="button" class="btn btn-default">clear</button-->    

</div>

</body>

</html>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js" ></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"            ></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"      ></script>
<script type="text/javascript" src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"          ></script>    
<script type="text/javascript" src="//cdn.jsdelivr.net/jquery.scrollto/2.1.0/jquery.scrollTo.min.js"        ></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/numeral.js/1.4.5/numeral.min.js"       ></script>

<script type="text/javascript" src="https://w.soundcloud.com/player/api.js"                                 ></script>
<script type="text/javascript" src="//connect.soundcloud.com/sdk.js"></script>

<script type="text/javascript" src="jquery.lettering-0.6.1.min.js"></script>
<script type="text/javascript" src="jquery.textillate.js"></script>
<script type="text/javascript" src="jquery.fittext.js"></script>

<script type="text/javascript" src="app.js"></script>

<script type="text/javascript">
$( document ).ready(function() {

  var mySouncCloudModule = MySouncCloudModule("200594478", 4);

  var qwe = [];

  $.get( "200594478.txt", function( data ) {

    var lines = data.split('\n');

    $('textarea').css({'height':(lines.length*24)+'px'});
    
    for(var i = 0;i < lines.length;i++){
      var ligne = lines[i].trim();
      ligne = ligne.length == 0 ? '&nbsp;' : ligne;
      $( "#result" ).append( $('<li>').html(ligne) );
    }

    $( "ul#result>li" ).click(function() {
      console.log();
      var text = $(this).text();
      mySouncCloudModule.getPosition(function(position) {
        $('textarea').append("[" +  position + "] '" + text + "'\n");
        qwe.push({'text': text, 'timestamp': position});
      }); 
    });

  });

  // initialize client with app credentials
  SC.initialize({
    client_id: '506d2e8c1cd057aa783906b0b1c8fe0d',
    redirect_uri: 'http://localhost/callback.html'
  });

  // initiate auth popup
  SC.connect(function() {
    SC.get('/me', function(me) { 
      alert('Hello, ' + me.username); 
    });
  });

  $('button#post').click(function(event) {

    qwe.sort(function(a, b) {
        return +a.timestamp - +b.timestamp;
    });

    qwe.reverse();

    for (var i = 0; i < qwe.length; i++) {
      var ligne = qwe[i];
      console.log();
      SC.post(
        "https://api.soundcloud.com/tracks/200594478/comments/?client_id=506d2e8c1cd057aa783906b0b1c8fe0d", 
        { 'comment[body]': ligne.text,
          'comment[timestamp]': ligne.timestamp}, 
        function(response, error) {
         if (error) console.log(error); else console.log(response); 
        });
      alert('next');
    }


  });

  $('button#clear').click(function(event) {
    qwe = [];
    $('textarea').empty();
  });

});
</script>

