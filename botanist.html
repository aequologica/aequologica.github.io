<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="google" content="notranslate" />

    <title>botanist</title>

    <link rel="canonical" href="https://aequologica.net/sto.html" />

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@latest/dist/css/bootstrap.min.css" rel="stylesheet" />
    <style>
      #bo table thead tr th {
        font-size: smaller;
      }
      #bo table tr :last-child {
        /* display: none; */
      }
      #bo table tr td:nth-child(3),
      #bo table tr td:nth-child(4),
      #bo table tr td:nth-child(5) {
        text-align: right;
        font-family: "Courier New", monospace;
      }
      #bo table img {
        display: block;
        max-width: 216px;
        height: auto;
      }
    </style>

    <script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@latest/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/lodash@latest/lodash.min.js"></script>

    <script>
      
      // http://stackoverflow.com/questions/20789373/shuffle-array-in-ng-repeat-angular
      // -> Fisher–Yates shuffle algorithm
      function shuffleArray(array) {
        let m = array.length, t, i;
        // while there remain elements to shuffle
        while (m) {
          // pick a remaining element
          i = Math.floor(Math.random() * m--);
          // swap it with the current element
          t = array[m];
          array[m] = array[i];
          array[i] = t;
        }
        return array;
      }

 
      $(document).ready( () => {
        const bo = {
          'prolégomènes': {arm: "", mea: 2, beg: "00:00", dur: 11, tex: "blanc"},
          'A': {arm: "###", mea: 12, beg: "00:11", dur: 33, tex: "souvenirs"},
          'B': {arm: "♭♭♭", mea: 12, beg: "00:44", dur: 33, tex: "souvenirs plus forts"},
          'A²': {arm: "###", mea: 12, beg: "01:17", dur: 33, tex: "action"},
          'B²': {arm: "♭♭♭", mea: 13, beg: "01:50", dur: 36, tex: "action plus forte"},
          'A³': {arm: "###", mea: 11, beg: "02:26", dur: 30, tex: "abandon"},
          'développement': {arm: "", mea: 16, beg: "02:56", dur: 44, tex: "attente/suspense, puis agacement/énervement/conflit qui monte"},
          'B³': {arm: "♭♭♭", mea: 13, beg: "03:40", dur: 36, tex: "putain, il faut faire quelque chose !"},
          'A⁴': {arm: "###", mea: 9, beg: "04:16", dur: 25, tex: "agréable mélancolie, saudade"},     
          'péroraison': {arm: "####", mea: 6, beg: "04:41", dur: 17, tex: "tentative, dernier soubresaut"},
          'coda': {arm: "##", mea: 2, beg: "04:58", dur: 11, tex: "tout est bien qui finit bien, vraiment ? (sol ♮)"}
        }
        
        const imgs = [
          "black",
          "bottom",
          "close",
          "closeright",
          "diagonal",
          "front",
          "inside",
          "into",
          "left",
          "normal",
          "over",
          "right",
          "top",
          "upright"
        ]
        const shuffled = shuffleArray(imgs)
        
        const final = {
          'prolégomènes': ["kittyBack"],
          'A': ["megaCloseup"                 , "cordes"                  ],
          'B': ["kittyFrontTightShotFromRight", "roues"                   ],
          'A²': ["kittySideMediumShotFromLeft", "cordesBassesHorizontales"],
          'B²': ["fullPianoFromSouthEast"     , "pedales2"                ],
          'A³': ["counterDiveFromWestSouth"   , "marteauxInside"          ],
          'développement': [
             "leggio",
             "scoreMozart2",
             "verticalDiveOnKeyboard",
             "verticalDiveOnKeyboard2",
             "verticalDiveOnKeyboard3",  
             "verticalDiveOnKeyboard4",
             "verticalDiveOnKeyboard5",
           ],
          'B³': [
            "longShotCircleRightToLeft1",
            "longShotCircleRightToLeft2",
            "longShotCircleRightToLeft3",
            "longShotCircleRightToLeft4",
            "longShotCircleRightToLeft5FullBehind",
            "longShotCircleRightToLeft6",
            "longShotCircleRightToLeft7",
            "longShotCircleRightToLeft8",
            "longShotCircleRightToLeft9",
            "longShotCircleRightToLeft10",
          ],
          'A⁴': ["horizontalFromWestSouth", "diveOnSeatFromWestNorth"],
          'péroraison': ["kittyAndPianoAmericanPlanSideFromRight", "mediumEast"],
          'coda': ["kittyEnd"],
        }

        $("#bo thead")
            .append($("<tr>")
              .append($("<th>").text("part"))
              .append($("<th>").text("armature"))
              .append($("<th>").text("mesures"))
              .append($("<th>").text("début"))
              .append($("<th>").text("durée"))
              .append($("<th>").html("indications"))
              .append($("<th>").html("plan"))
            )
        
        let sum = 0
        let secs = 0
        let i = 0
        
        /* CAROUSEL
        let $carousel = $('#qwe')
        let ci = 0;
        */
        
        _.forOwn(bo, (value, key) => {
          sum = sum + parseFloat(value.mea)
          secs = secs + parseInt(value.dur)
          
          const $div = $('<div>')
          
          if (final[key]) {
            final[key].forEach((ima) => {
              const $img = $('<img>')
                      .addClass('img-fluid img-thumbnail')
                      .attr('src', 'pianos/' + ima + '.jpg')
              $div.append($img)
              /* CAROUSEL
              $carousel.append(
                $('<div>').addClass("carousel-item" + (ci === 0 ? " active" : "")).append(
                  $('<img>').attr('src', 'pianos/' + ima + '.jpg').addClass("d-block w-100")
                )
              )
              ci = ci + 1
              */
            })
          }

          $("#bo tbody")
            .append($("<tr>")
              .append($("<td>").text(key))
              .append($("<td>").text(value.arm))
              .append($("<td>").text(value.mea))
              .append($("<td>").text(value.beg))
              .append($("<td>").text(value.dur))
              .append($("<td>").html(value.tex))
              .append($("<td>").html($div))
            )
          i = i + 1
        })
        
        const date = new Date(0);
        date.setSeconds(secs);
        const tot = date.toISOString().substr(14, 5);
        
        $("#bo tbody").append(
          $("<tr>")
            .append($("<td>"))
            .append($("<td>"))
            .append($("<td>").html($("<b>").text(sum.toFixed(0))))
            .append($("<td>").html($("<b>").text(tot)))
            .append($("<td>").html($("<b>").text(secs.toFixed(0))))
            .append($("<td>"))
            .append($("<td>"))
          )
      })
    </script>
  </head>
  <body>
    <main id="bo" class="container-fluid">
      <!--
      <div id="carouselExampleInterval" class="carousel slide carousel-fade" data-bs-ride="carousel" data-bs-wrap="false" data-bs-interval="false">
        <div id="qwe" class="carousel-inner">
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleInterval" data-bs-slide="prev">
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleInterval" data-bs-slide="next">
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Next</span>
        </button>
      </div>
      <iframe width="100%" height="300" scrolling="no" frameborder="no" allow="autoplay" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/1114444888&color=%23594d3f&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true"></iframe><div style="font-size: 10px; color: #cccccc;line-break: anywhere;word-break: normal;overflow: hidden;white-space: nowrap;text-overflow: ellipsis; font-family: Interstate,Lucida Grande,Lucida Sans Unicode,Lucida Sans,Garuda,Verdana,Tahoma,sans-serif;font-weight: 100;"><a href="https://soundcloud.com/christophe-thiebaud" title="Christophe Thiebaud" target="_blank" style="color: #cccccc; text-decoration: none;">Christophe Thiebaud</a> · <a href="https://soundcloud.com/christophe-thiebaud/apres-les-filles-du-botaniste" title="Après &quot;Les Filles Du Botaniste&quot;" target="_blank" style="color: #cccccc; text-decoration: none;">Après &quot;Les Filles Du Botaniste&quot;</a></div>
      -->
      <table class="table table-responsive">
        <thead></thead>
        <tbody></tbody>
      </table>
    </main>
  </body>
</html>

